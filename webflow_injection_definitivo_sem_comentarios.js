(function(){"use strict";const cssStyles=`\n        /* IDENTIDADE VISUAL IMEDIATO SEGUROS V6.2.2 */\n        \n        /* Importar fonte Titillium Web */\n        @import url('https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300;400;600;700&display=swap');\n        \n        /* Vari√°veis CSS com cores da Imediato */\n        :root {\n            --imediato-dark-blue: #003366;\n            --imediato-light-blue: #0099CC;\n            --imediato-white: #FFFFFF;\n            --imediato-gray: #F8F9FA;\n            --imediato-text: #333333;\n            --imediato-text-light: #666666;\n            --imediato-border: #E0E0E0;\n            --imediato-shadow: rgba(0, 51, 102, 0.1);\n            --imediato-shadow-hover: rgba(0, 51, 102, 0.2);\n            \n            /* Font sizes */\n            --font-size-xs: 0.75rem;\n            --font-size-sm: 0.875rem;\n            --font-size-base: 1rem;\n            --font-size-lg: 1.125rem;\n            --font-size-xl: 1.25rem;\n            --font-size-2xl: 1.5rem;\n            --font-size-3xl: 1.875rem;\n            --font-size-4xl: 2.25rem;\n        }\n        \n        /* MODAL DE PROGRESSO V6.2.2 - IMEDIATO SEGUROS */\n        \n        /* Aplicar fonte Titillium Web em todos os elementos do modal */\n        #rpaModal * {\n            font-family: 'Titillium Web', sans-serif !important;\n            font-size: var(--font-size-base) !important;\n        }\n        \n        /* Tamanhos espec√≠ficos para elementos do modal */\n        #rpaModal h1 {\n            font-size: var(--font-size-2xl);\n            font-weight: 600;\n        }\n        \n        #rpaModal h3 {\n            font-size: var(--font-size-lg) !important;\n            font-weight: 600 !important;\n        }\n        \n        #rpaModal .progress-text {\n            font-size: var(--font-size-xl) !important;\n            font-weight: 700 !important;\n        }\n        \n        #rpaModal .current-phase {\n            font-size: var(--font-size-lg) !important;\n            font-weight: 500 !important;\n        }\n        \n        #rpaModal .sub-phase {\n            font-size: var(--font-size-sm) !important;\n            font-weight: 400 !important;\n        }\n        \n        #rpaModal .stage-info {\n            font-size: var(--font-size-sm) !important;\n            font-weight: 500 !important;\n        }\n        \n        #rpaModal .value {\n            font-size: var(--font-size-2xl) !important;\n            font-weight: 700 !important;\n        }\n        \n        #rpaModal .card-subtitle {\n            font-size: var(--font-size-sm) !important;\n            font-weight: 400 !important;\n        }\n        \n        #rpaModal .card-features li {\n            font-size: var(--font-size-sm) !important;\n            font-weight: 400 !important;\n            padding: 0.3rem 0 !important;\n        }\n        \n        #rpaModal .btn {\n            font-size: var(--font-size-base) !important;\n            font-weight: 500 !important;\n        }\n        \n        /* Reset espec√≠fico para modal din√¢mico - SEM remover todos os estilos */\n        #rpaModal {\n            position: fixed !important;\n            top: 10vh !important;\n            left: 10vw !important;\n            width: 80vw !important;\n            height: 80vh !important;\n            background: rgba(255, 255, 255, 0.02) !important;\n            z-index: 999999 !important;\n            display: flex !important;\n            flex-direction: column !important;\n            margin: 0 !important;\n            padding: 0 !important;\n            border: none !important;\n            box-shadow: \n                0 30px 60px rgba(0, 0, 0, 0.2),\n                0 0 0 1px rgba(255, 255, 255, 0.05) !important;\n            backdrop-filter: blur(20px) !important;\n            overflow: hidden !important;\n            box-sizing: border-box !important;\n            isolation: isolate !important;\n            font-family: 'Titillium Web', sans-serif !important;\n        }\n        \n        /* Estilos espec√≠ficos para elementos do modal */\n        #rpaModal * {\n            box-sizing: border-box !important;\n        }\n        \n        /* Garantir que o conte√∫do do modal tenha estilos corretos */\n        #rpaModal .modal-content {\n            background: var(--imediato-white) !important;\n            border-radius: 15px !important;\n            padding: 1rem !important;\n            margin: 1rem !important;\n            box-shadow: 0 10px 30px var(--imediato-shadow) !important;\n            flex: 1 !important;\n            overflow-y: auto !important;\n            font-family: 'Titillium Web', sans-serif !important;\n        }\n        \n        /* Garantir que os cards tenham estilos corretos */\n        #rpaModal .result-card {\n            background: var(--imediato-white) !important;\n            border-radius: 12px !important;\n            padding: 1rem !important;\n            box-shadow: 0 4px 15px var(--imediato-shadow) !important;\n            border: 2px solid var(--imediato-border) !important;\n            font-family: 'Titillium Web', sans-serif !important;\n        }\n        \n        /* Garantir que os headers dos cards tenham estilos corretos */\n        #rpaModal .card-header {\n            display: flex !important;\n            align-items: center !important;\n            gap: 1rem !important;\n            justify-content: space-between !important;\n            margin-bottom: 0.75rem !important;\n        }\n        \n        /* Garantir que os t√≠tulos tenham estilos corretos */\n        #rpaModal .card-title h3 {\n            font-size: var(--font-size-2xl) !important;\n            font-weight: 600 !important;\n            color: var(--imediato-dark-blue) !important;\n            margin: 0 !important;\n            font-family: 'Titillium Web', sans-serif !important;\n        }\n        \n        /* Garantir que o t√≠tulo ocupe espa√ßo dispon√≠vel */\n        #rpaModal .card-title {\n            flex: 1 !important;\n        }\n        \n        /* Estilos para o valor inline no header */\n        #rpaModal .card-value-inline {\n            text-align: right !important;\n            margin-left: auto !important;\n        }\n        \n        #rpaModal .card-value-inline .value {\n            font-size: var(--font-size-2xl) !important;\n            font-weight: 700 !important;\n            color: var(--imediato-dark-blue) !important;\n            margin: 0 !important;\n        }\n        \n        #rpaModal .card-subtitle {\n            font-size: var(--font-size-sm) !important;\n            color: var(--imediato-text-light) !important;\n            margin: 0.25rem 0 0 0 !important;\n            font-family: 'Titillium Web', sans-serif !important;\n        }\n        \n        /* Garantir que os valores tenham estilos corretos */\n        #rpaModal .value {\n            font-size: var(--font-size-2xl) !important;\n            font-weight: 700 !important;\n            color: var(--imediato-dark-blue) !important;\n            text-align: center !important;\n            font-family: 'Titillium Web', sans-serif !important;\n        }\n        \n        /* Garantir que o container de resultados tenha layout correto */\n        #rpaModal .results-container {\n            display: grid !important;\n            grid-template-columns: 1fr 1fr !important;\n            gap: 1.5rem !important;\n        }\n        \n        @media (max-width: 768px) {\n            #rpaModal .results-container {\n                grid-template-columns: 1fr !important;\n                gap: 1rem !important;\n            }\n            \n            /* Layout vertical para mobile */\n            #rpaModal .card-header {\n                flex-direction: column !important;\n                align-items: flex-start !important;\n                gap: 0.5rem !important;\n            }\n            \n            #rpaModal .card-value-inline {\n                text-align: left !important;\n                margin-left: 0 !important;\n                margin-top: 0.5rem !important;\n            }\n        }\n        \n        /* Garantir que os bot√µes tenham estilos corretos */\n        #rpaModal .btn {\n            background: linear-gradient(135deg, var(--imediato-dark-blue) 0%, var(--imediato-light-blue) 100%) !important;\n            color: var(--imediato-white) !important;\n            border: none !important;\n            padding: 0.75rem 1.5rem !important;\n            border-radius: 8px !important;\n            font-size: var(--font-size-base) !important;\n            font-weight: 500 !important;\n            font-family: 'Titillium Web', sans-serif !important;\n            cursor: pointer !important;\n            transition: all 0.3s ease !important;\n            text-decoration: none !important;\n            display: inline-flex !important;\n            align-items: center !important;\n            justify-content: center !important;\n            gap: 0.5rem !important;\n        }\n        \n        #rpaModal .btn:hover {\n            transform: translateY(-2px) !important;\n            box-shadow: 0 4px 15px var(--imediato-shadow-hover) !important;\n        }\n        \n        /* Responsividade do modal */\n        @media (max-width: 768px) {\n            #rpaModal {\n                top: 5vh !important;\n                left: 5vw !important;\n                width: 90vw !important;\n                height: 90vh !important;\n            }\n        }\n        \n        @media (max-width: 480px) {\n            #rpaModal {\n                top: 2vh !important;\n                left: 2vw !important;\n                width: 96vw !important;\n                height: 96vh !important;\n            }\n            \n            #rpaModal .progress-header .company-logo {\n                height: 40px;\n                width: auto;\n            }\n        }\n        \n        /* Garantir que os √≠cones Font Awesome funcionem */\n        #rpaModal i.fas,\n        #rpaModal i.far,\n        #rpaModal i.fab {\n            font-family: "Font Awesome 6 Free" !important;\n            font-weight: 900 !important;\n            font-style: normal !important;\n            font-variant: normal !important;\n            text-rendering: auto !important;\n            -webkit-font-smoothing: antialiased !important;\n            -moz-osx-font-smoothing: grayscale !important;\n            display: inline-block !important;\n        }\n        \n        /* Garantir que o modal seja sempre vis√≠vel */\n        #rpaModal.show {\n            opacity: 1 !important;\n            visibility: visible !important;\n        }\n        \n        /* Restaurar estilos espec√≠ficos ap√≥s reset */\n        #rpaModal .modal-progress-bar {\n            background: var(--imediato-white);\n            position: sticky;\n            top: 0;\n            z-index: 10001;\n        }\n        \n        #rpaModal .progress-header {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            padding: 1.2rem 2rem;\n            background-color: #f2f5f8;\n            background-image: url(https://cdn.prod.website-files.com/59eb807f9d16950001e202af/68ad0b4d507fa7c358ff42e2_header-grid-nodes-12-standard.svg);\n            background-position: 0 0;\n            background-size: auto;\n            background-repeat: no-repeat;\n            color: var(--imediato-dark-blue);\n            text-align: center;\n        }\n        \n        #rpaModal .modal-content {\n            flex: 1;\n            background: linear-gradient(135deg, var(--imediato-gray), var(--imediato-white));\n            overflow-y: auto;\n            padding: 1rem;\n        }\n        \n        #rpaModal .progress-header .logo-container {\n            margin-bottom: 1.5rem;\n        }\n        \n        #rpaModal .progress-header h1 {\n            color: var(--imediato-dark-blue);\n            font-size: 1.8rem;\n            font-weight: 600;\n            margin: 0 0 1rem 0;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 0.5rem;\n        }\n        \n        #rpaModal .progress-header h1 i {\n            color: var(--imediato-dark-blue);\n        }\n        \n        #rpaModal .progress-header .company-logo {\n            height: 60px;\n            width: auto;\n            filter: none;\n            object-fit: contain;\n        }\n        \n        #rpaModal .progress-info {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 1.5rem;\n            margin-top: 0.5rem;\n        }\n        \n        .progress-text {\n            font-size: 1.8rem;\n            font-weight: 700;\n            color: var(--imediato-dark-blue);\n            min-width: 70px;\n            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n        }\n        \n        .current-phase {\n            color: var(--imediato-dark-blue);\n            font-size: 1.1rem;\n            font-weight: 500;\n        }\n        \n        .sub-phase {\n            color: var(--imediato-dark-blue);\n            font-size: 0.95rem;\n            font-weight: 400;\n            margin-top: 0.25rem;\n            font-style: italic;\n            opacity: 0.8;\n        }\n        \n        .progress-stages {\n            color: var(--imediato-dark-blue);\n            font-size: 1rem;\n            font-weight: 400;\n            text-align: center;\n            margin-top: 0.5rem;\n            opacity: 0.9;\n        }\n        \n        .progress-bar-wrapper {\n            padding: 0 2rem 0;\n            background: var(--imediato-white);\n        }\n        \n        .progress-bar-container {\n            width: 100%;\n            height: 8px;\n            background: var(--imediato-border);\n            border-radius: 4px;\n            overflow: hidden;\n            position: relative;\n        }\n        \n        .progress-bar-fill {\n            height: 100%;\n            background: linear-gradient(90deg, var(--imediato-light-blue), var(--imediato-dark-blue));\n            border-radius: 4px;\n            transition: width 0.3s ease;\n            position: relative;\n        }\n        \n        .progress-bar-fill::after {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);\n            animation: shimmer 2s infinite;\n        }\n        \n        @keyframes shimmer {\n            0% { transform: translateX(-100%); }\n            100% { transform: translateX(100%); }\n        }\n        \n        /* Container dos 2 Divs */\n        #rpaModal .results-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 2rem;\n        }\n        \n        #rpaModal .result-card {\n            background: var(--imediato-white);\n            border-radius: 15px;\n            padding: 1rem;\n            box-shadow: 0 8px 25px var(--imediato-shadow);\n            border: 2px solid var(--imediato-border);\n            transition: all 0.3s ease;\n            position: relative;\n            overflow: hidden;\n        }\n        \n        #rpaModal .result-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 15px 35px var(--imediato-shadow-hover);\n        }\n        \n        #rpaModal .result-card.recommended {\n            border-color: var(--imediato-light-blue);\n            background: linear-gradient(135deg, var(--imediato-white), #f0f8ff);\n        }\n        \n        #rpaModal .result-card.alternative {\n            border-color: var(--imediato-border);\n            background: linear-gradient(135deg, var(--imediato-white), var(--imediato-gray));\n        }\n        \n        .card-header {\n            display: flex;\n            align-items: center;\n            gap: 1rem;\n            margin-bottom: 1.5rem;\n        }\n        \n        .card-icon {\n            width: 60px;\n            height: 60px;\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 1.5rem !important;\n            background: var(--imediato-gray);\n            flex-shrink: 0;\n            min-width: 60px;\n            min-height: 60px;\n        }\n        \n        .card-icon i {\n            font-size: 1.5rem !important;\n            color: inherit !important;\n            display: inline-block !important;\n            font-family: "Font Awesome 6 Free" !important;\n            font-weight: 900 !important;\n        }\n        \n        /* For√ßar estilos dos √≠cones Font Awesome */\n        #rpaModal .card-icon i.fas {\n            font-family: "Font Awesome 6 Free" !important;\n            font-weight: 900 !important;\n            font-style: normal !important;\n            font-variant: normal !important;\n            text-rendering: auto !important;\n            -webkit-font-smoothing: antialiased !important;\n            -moz-osx-font-smoothing: grayscale !important;\n        }\n        \n        .result-card.recommended .card-icon {\n            background: var(--imediato-light-blue);\n            color: var(--imediato-white) !important;\n        }\n        \n        .result-card.recommended .card-icon i {\n            color: var(--imediato-white) !important;\n        }\n        \n        .result-card.alternative .card-icon {\n            background: var(--imediato-gray);\n            color: var(--imediato-dark-blue) !important;\n        }\n        \n        .result-card.alternative .card-icon i {\n            color: var(--imediato-dark-blue) !important;\n        }\n        \n        /* √çcones no header */\n        #rpaModal h1 i {\n            font-size: 1.5rem !important;\n            margin-right: 0.5rem !important;\n            color: var(--imediato-light-blue) !important;\n            display: inline-block !important;\n        }\n        \n        /* √çcones nos bot√µes */\n        #rpaModal .btn i {\n            font-size: 1rem !important;\n            margin-right: 0.5rem !important;\n            display: inline-block !important;\n        }\n        \n        /* Bot√£o X no canto superior direito do modal */\n        #rpaModal .modal-close-btn {\n            position: absolute !important;\n            top: 0.5rem !important;\n            right: 0.5rem !important;\n            width: 40px !important;\n            height: 40px !important;\n            background: var(--imediato-dark-blue) !important;\n            border: none !important;\n            border-radius: 8px !important;\n            color: var(--imediato-white) !important;\n            font-size: 16px !important;\n            cursor: pointer !important;\n            display: flex !important;\n            align-items: center !important;\n            justify-content: center !important;\n            z-index: 10002 !important;\n            transition: all 0.3s ease !important;\n            box-shadow: 0 2px 8px rgba(0, 51, 102, 0.3) !important;\n        }\n        \n        #rpaModal .modal-close-btn:hover {\n            background: var(--imediato-light-blue) !important;\n            transform: scale(1.1) !important;\n            box-shadow: 0 4px 12px rgba(0, 51, 102, 0.4) !important;\n        }\n        \n        #rpaModal .modal-close-btn:active {\n            transform: scale(0.95) !important;\n        }\n        \n        /* √çcones nas features */\n        #rpaModal .card-features i {\n            font-size: 0.875rem !important;\n            margin-right: 0.5rem !important;\n            color: var(--imediato-light-blue) !important;\n            display: inline-block !important;\n        }\n        \n        .card-title h3 {\n            color: var(--imediato-dark-blue);\n            font-size: 1.3rem;\n            font-weight: 600;\n            margin: 0 0 0.5rem 0;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            max-width: 100%;\n        }\n        \n        .card-subtitle {\n            color: var(--imediato-text-light);\n            font-size: 0.9rem;\n            font-weight: 400;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            max-width: 100%;\n        }\n        \n        .card-value {\n            text-align: center;\n            margin: 1.5rem 0;\n        }\n        \n        .value {\n            font-size: 2.5rem;\n            font-weight: 700;\n            color: var(--imediato-dark-blue);\n            margin: 0;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            max-width: 100%;\n        }\n        \n        .card-features {\n            list-style: none;\n            padding: 0;\n            margin: 1.2rem 0 0 0;\n        }\n        \n        .card-features li {\n            padding: 0.3rem 0;\n            color: var(--imediato-text);\n            font-size: 0.9rem;\n            border-bottom: 1px solid var(--imediato-border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .card-features li:last-child {\n            border-bottom: none;\n        }\n        \n        .card-features li i {\n            color: var(--imediato-light-blue);\n            margin-right: 0.5rem;\n            width: 16px;\n        }\n        \n        .feature-value {\n            font-weight: 600;\n            color: var(--imediato-dark-blue);\n            text-align: right;\n            flex-shrink: 0;\n        }\n        \n        .text-success {\n            color: #28a745 !important;\n        }\n        \n        .text-danger {\n            color: #dc3545 !important;\n        }\n        \n        .action-buttons {\n            display: flex;\n            gap: 1rem;\n            justify-content: center;\n            margin-top: 2rem;\n            padding: 0 2rem 2rem;\n        }\n        \n        .btn {\n            padding: 1rem 2rem;\n            border: none;\n            border-radius: 8px;\n            font-size: 1rem;\n            font-weight: 600;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            text-decoration: none;\n            display: inline-flex;\n            align-items: center;\n            gap: 0.5rem;\n        }\n        \n        .btn-primary {\n            background: linear-gradient(135deg, var(--imediato-light-blue), var(--imediato-dark-blue));\n            color: var(--imediato-white);\n        }\n        \n        .btn-primary:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 8px 20px var(--imediato-shadow-hover);\n        }\n        \n        .btn-secondary {\n            background: var(--imediato-gray);\n            color: var(--imediato-dark-blue);\n            border: 2px solid var(--imediato-border);\n        }\n        \n        .btn-secondary:hover {\n            background: var(--imediato-border);\n            transform: translateY(-2px);\n        }\n        \n        /* SPINNER TIMER CONTAINER */\n        .spinner-timer-container {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            padding: 2rem;\n            background: transparent;\n            border: none;\n            /* ‚úÖ CORRE√á√ÉO: Posicionamento centralizado no modal */\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            z-index: 1000;\n        }\n        \n        .spinner-container {\n            position: relative;\n            width: 240px;\n            height: 240px;\n            margin-bottom: 1rem;\n        }\n        \n        /* SpinKit Modelo 8 - Circle */\n        .sk-circle {\n            width: 240px;\n            height: 240px;\n            position: relative;\n        }\n        \n        .sk-circle .sk-child {\n            width: 100%;\n            height: 100%;\n            position: absolute;\n            left: 0;\n            top: 0;\n        }\n        \n        .sk-circle .sk-child:before {\n            content: '';\n            display: block;\n            margin: 0 auto;\n            width: 15%;\n            height: 15%;\n            background-color: #dc3545; /* ‚Üê VERMELHO */\n            border-radius: 100%;\n            animation: sk-circle-bounce-delay 1.2s infinite ease-in-out both;\n        }\n        \n        .sk-circle .sk-child:nth-child(1) { transform: rotate(30deg); }\n        .sk-circle .sk-child:nth-child(2) { transform: rotate(60deg); }\n        .sk-circle .sk-child:nth-child(3) { transform: rotate(90deg); }\n        .sk-circle .sk-child:nth-child(4) { transform: rotate(120deg); }\n        .sk-circle .sk-child:nth-child(5) { transform: rotate(150deg); }\n        .sk-circle .sk-child:nth-child(6) { transform: rotate(180deg); }\n        .sk-circle .sk-child:nth-child(7) { transform: rotate(210deg); }\n        .sk-circle .sk-child:nth-child(8) { transform: rotate(240deg); }\n        .sk-circle .sk-child:nth-child(9) { transform: rotate(270deg); }\n        .sk-circle .sk-child:nth-child(10) { transform: rotate(300deg); }\n        .sk-circle .sk-child:nth-child(11) { transform: rotate(330deg); }\n        .sk-circle .sk-child:nth-child(12) { transform: rotate(360deg); }\n        \n        .sk-circle .sk-child:nth-child(1):before { animation-delay: -1.1s; }\n        .sk-circle .sk-child:nth-child(2):before { animation-delay: -1s; }\n        .sk-circle .sk-child:nth-child(3):before { animation-delay: -0.9s; }\n        .sk-circle .sk-child:nth-child(4):before { animation-delay: -0.8s; }\n        .sk-circle .sk-child:nth-child(5):before { animation-delay: -0.7s; }\n        .sk-circle .sk-child:nth-child(6):before { animation-delay: -0.6s; }\n        .sk-circle .sk-child:nth-child(7):before { animation-delay: -0.5s; }\n        .sk-circle .sk-child:nth-child(8):before { animation-delay: -0.4s; }\n        .sk-circle .sk-child:nth-child(9):before { animation-delay: -0.3s; }\n        .sk-circle .sk-child:nth-child(10):before { animation-delay: -0.2s; }\n        .sk-circle .sk-child:nth-child(11):before { animation-delay: -0.1s; }\n        .sk-circle .sk-child:nth-child(12):before { animation-delay: 0s; }\n        \n        @keyframes sk-circle-bounce-delay {\n            0%, 80%, 100% {\n                transform: scale(0);\n            }\n            40% {\n                transform: scale(1);\n            }\n        }\n        \n        .spinner-center {\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            font-size: 48px; /* ‚úÖ DOBROU: 24px ‚Üí 48px */\n            font-weight: bold;\n            color: #dc3545; /* ‚Üê VERMELHO */\n            z-index: 10;\n        }\n        \n        .timer-message {\n            text-align: center;\n            padding: 12px 20px;\n            background: #fff3cd;\n            color: #856404;\n            border: 1px solid #ffeaa7;\n            border-radius: 8px;\n            font-size: 0.9em;\n            font-weight: 500;\n            animation: slideIn 0.5s ease-out;\n        }\n        \n        @keyframes slideIn {\n            from {\n                opacity: 0;\n                transform: translateY(-10px);\n            }\n            to {\n                opacity: 1;\n                transform: translateY(0);\n            }\n        }\n        \n        .contact-message {\n            background: linear-gradient(135deg, var(--imediato-light-blue), var(--imediato-dark-blue));\n            color: var(--imediato-white);\n            padding: 1rem 2rem;\n            border-radius: 10px;\n            margin: 1rem 0;\n            text-align: center;\n            font-weight: 500;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 0.5rem;\n        }\n        \n        .contact-message i {\n            font-size: 1.2rem;\n        }\n        \n        /* Responsividade */\n        @media (max-width: 768px) {\n            #rpaModal {\n                top: 70px !important;\n                height: calc(100vh - 70px) !important;\n            }\n            \n            #rpaModal .progress-header {\n                padding: 1rem;\n                flex-direction: column;\n                gap: 0.75rem;\n            }\n            \n            #rpaModal .progress-header h1 {\n                font-size: 1.5rem;\n                margin: 0 0 0.5rem 0;\n            }\n            \n            #rpaModal .progress-header .company-logo {\n                height: 50px;\n                width: auto;\n            }\n            \n            #rpaModal .progress-info {\n                flex-direction: column;\n                gap: 0.5rem;\n            }\n            \n            .progress-text {\n                font-size: 1.5rem;\n            }\n            \n            .current-phase {\n                font-size: 1rem;\n            }\n            \n            .sub-phase {\n                font-size: 0.85rem;\n            }\n            \n            #rpaModal .results-container {\n                grid-template-columns: 1fr;\n                gap: 1.5rem;\n            }\n            \n            #rpaModal .result-card {\n                padding: 1.5rem;\n            }\n            \n            .card-header {\n                min-height: 60px;\n                gap: 1rem;\n            }\n            \n            .card-icon {\n                width: 50px;\n                height: 50px;\n                font-size: 1.2rem;\n            }\n            \n            .card-title h3 {\n                font-size: 1.1rem;\n            }\n            \n            .value {\n                font-size: 2rem;\n            }\n            \n            .action-buttons {\n                flex-direction: column;\n                padding: 0 1rem 1rem;\n            }\n            \n            .btn {\n                padding: 0.875rem 1.5rem;\n                font-size: 0.95rem;\n            }\n        }\n        \n        @media (max-width: 480px) {\n            #rpaModal .progress-header {\n                padding: 0.75rem;\n            }\n            \n            .current-phase {\n                font-size: 0.9rem;\n            }\n            \n            .sub-phase {\n                font-size: 0.8rem;\n            }\n            \n            .modal-content {\n                padding: 0.75rem;\n            }\n            \n            #rpaModal .result-card {\n                padding: 1rem;\n            }\n            \n            .card-icon {\n                width: 45px;\n                height: 45px;\n                font-size: 1rem;\n            }\n            \n            .value {\n                font-size: 1.8rem;\n            }\n        }\n    `;class SpinnerTimer{constructor(){this.initialDuration=180;this.extendedDuration=120;this.totalDuration=this.initialDuration;this.remainingSeconds=this.initialDuration;this.isRunning=false;this.isExtended=false;this.interval=null;this.elements={spinnerCenter:null,timerMessage:null}}init(){this.elements.spinnerCenter=document.getElementById("spinnerCenter");this.elements.timerMessage=document.getElementById("timerMessage");console.log("üîÑ Inicializando SpinnerTimer...");console.log("üìç spinnerCenter encontrado:",!!this.elements.spinnerCenter);console.log("üìç timerMessage encontrado:",!!this.elements.timerMessage);if(!this.elements.spinnerCenter){console.warn("‚ö†Ô∏è Elementos do spinner timer n√£o encontrados");return}console.log("‚úÖ Iniciando timer...");this.start()}start(){this.isRunning=true;this.isExtended=false;this.totalDuration=this.initialDuration;this.remainingSeconds=this.initialDuration;console.log("‚è∞ Timer iniciado:",this.remainingSeconds,"segundos");this.interval=setInterval(()=>{this.tick()},100)}tick(){this.remainingSeconds-=.1;if(this.remainingSeconds<=0){if(!this.isExtended){this.extendTimer();return}else{this.finish();return}}this.updateDisplay()}extendTimer(){this.isExtended=true;this.totalDuration+=this.extendedDuration;this.remainingSeconds=this.extendedDuration;if(this.elements.timerMessage){this.elements.timerMessage.style.display="block"}}finish(){this.isRunning=false;this.remainingSeconds=0;this.updateDisplay();clearInterval(this.interval)}updateDisplay(){const minutes=Math.floor(this.remainingSeconds/60);const seconds=Math.floor(this.remainingSeconds%60);const centiseconds=Math.floor(this.remainingSeconds%1*10);const timerText=`${minutes.toString().padStart(2,"0")}:${seconds.toString().padStart(2,"0")}.${centiseconds}`;if(this.elements.spinnerCenter){this.elements.spinnerCenter.textContent=timerText;console.log("üîÑ Timer atualizado:",timerText)}else{console.warn("‚ö†Ô∏è spinnerCenter n√£o encontrado para atualizar")}}stop(){this.isRunning=false;clearInterval(this.interval)}reset(){this.stop();this.isExtended=false;this.totalDuration=this.initialDuration;this.remainingSeconds=this.initialDuration;if(this.elements.timerMessage){this.elements.timerMessage.style.display="none"}this.updateDisplay()}}class ProgressModalRPA{constructor(sessionId){this.apiBaseUrl="https://rpaimediatoseguros.com.br";this.sessionId=sessionId;this.progressInterval=null;this.isProcessing=true;this.spinnerTimer=null;this.setSessionId(sessionId);this.spinnerTimerInitialized=false;this.initialEstimateUpdated=false;this.phaseMessages={1:"üîÑ Iniciando sistema...",2:"üîê Fazendo login no sistema",3:"üåê Acessando p√°gina de cota√ß√£o",4:"üìù Validando dados pessoais",5:"üöó Validando informa√ß√µes do ve√≠culo",6:"üìç Validando Endere√ßo",7:"üÖøÔ∏è Identificando perfil de endere√ßo",8:"üìä Analisando perfil de risco",9:"üîç Buscando melhores seguradoras",10:"üìã Coletando cota√ß√µes dispon√≠veis",11:"‚öñÔ∏è Comparando propostas",12:"üéØ Selecionando melhor op√ß√£o",13:"üìÑ Gerando proposta final",14:"‚úÖ Validando dados finais",15:"‚öôÔ∏è Finalizando processamento...",16:"üéâ Multi-c√°lculo completo"};this.phaseSubMessages={1:"Preparando ambiente de c√°lculo",2:"Conectando com sistema seguro",3:"Carregando formul√°rio de cota√ß√£o",4:"Verificando informa√ß√µes pessoais",5:"Validando dados do ve√≠culo",6:"Confirmando endere√ßo de risco",7:"Analisando localiza√ß√£o",8:"Calculando perfil de risco",9:"Consultando seguradoras",10:"Coletando cota√ß√µes",11:"Comparando propostas",12:"Selecionando melhor op√ß√£o",13:"Gerando proposta",14:"Validando dados",15:"",16:"Seu seguro foi calculado com sucesso!"};this.phasePercentages={0:0,1:6.25,2:12.5,3:18.75,4:25,5:31.25,6:37.5,7:43.75,8:50,9:56.25,10:62.5,11:68.75,12:75,13:81.25,14:87.5,15:93.75,16:100};console.log("üöÄ ProgressModalRPA inicializado com sessionId:",this.sessionId)}setSessionId(sessionId){this.sessionId=sessionId;console.log("üîÑ SessionId atualizado:",this.sessionId);if(this.setSessionIdTimeout){clearTimeout(this.setSessionIdTimeout)}if(!this.spinnerTimerInitialized){this.initSpinnerTimer();this.spinnerTimerInitialized=true}}initSpinnerTimer(){if(!this.spinnerTimer){this.spinnerTimer=new SpinnerTimer;this.spinnerTimer.init();this.spinnerTimer.start();console.log("‚úÖ SpinnerTimer inicializado e iniciado")}}stopSpinnerTimer(){try{if(this.spinnerTimer){this.spinnerTimer.finish();this.spinnerTimer=null;console.log("‚èπÔ∏è SpinnerTimer parado")}const spinnerContainer=document.getElementById("spinnerTimerContainer");if(spinnerContainer){spinnerContainer.style.display="none";console.log("‚úÖ Spinner timer escondido")}}catch(error){console.error("Erro ao parar spinner timer:",error);const container=document.getElementById("spinnerTimerContainer");if(container){container.style.display="none";console.log("‚úÖ Spinner escondido via fallback")}}}startProgressPolling(){if(!this.sessionId){console.error("‚ùå Session ID n√£o encontrado");return}console.log("üîÑ Iniciando polling do progresso...");this.pollCount=0;this.maxPolls=300;this.progressInterval=setInterval(()=>{this.pollCount++;console.log(`üîÑ Polling ${this.pollCount}/${this.maxPolls}`);if(this.pollCount>this.maxPolls){console.error("‚ùå Timeout: Processamento demorou mais de 10 minutos");this.stopProgressPolling();this.stopSpinnerTimer();this.showErrorAlert("O processamento est√° demorando mais que o esperado (10 minutos). Tente novamente ou entre em contato conosco.");return}this.updateProgress()},2e3)}stopProgressPolling(){if(this.progressInterval){clearInterval(this.progressInterval);this.progressInterval=null;console.log("‚èπÔ∏è Polling interrompido")}}async updateProgress(){if(!this.sessionId)return;try{const response=await fetch(`${this.apiBaseUrl}/api/rpa/progress/${this.sessionId}`);const data=await response.json();console.log("üìä Dados do progresso:",data);console.log("üìä Objeto progress:",data.progress);console.log("üìä Etapa atual:",data.progress?.etapa_atual);console.log("üìä Fase atual:",data.progress?.fase_atual);console.log("üìä Status:",data.progress?.status);console.log("üìä Mensagem:",data.progress?.mensagem);console.log("üìä C√≥digo de erro:",data.progress?.error_code);console.log("üìä C√≥digo de status:",data.progress?.status_code);if(data.success){const progressData=data.progress;const currentStatus=progressData.status||"processing";const mensagem=progressData.mensagem||"";this.lastProgressData=progressData;console.log("üîç DEBUG - Dados completos do progresso:",{fase_atual:progressData.fase_atual,etapa_atual:progressData.etapa_atual,total_etapas:progressData.total_etapas,status:progressData.status,mensagem:progressData.mensagem,percentual:progressData.percentual,estimativas:progressData.estimativas,dados_extra:progressData.dados_extra,plano_recomendado:progressData.dados_extra?.plano_recomendado,plano_alternativo:progressData.dados_extra?.plano_alternativo});const errorCode=progressData.error_code||progressData.status_code||progressData.dados_extra?.error_code||progressData.dados_extra?.status_code;if(this.isErrorStatus(currentStatus,mensagem,errorCode)){console.error("‚ùå Erro detectado no RPA:",{status:currentStatus,mensagem:mensagem,errorCode:errorCode});this.handleRPAError(mensagem||`Status: ${currentStatus}`,errorCode);return}let currentPhase=progressData.fase_atual||progressData.etapa_atual||1;if(currentStatus==="success"){currentPhase=16;console.log("üéâ Status success detectado ‚Üí for√ßando fase 16 (finaliza√ß√£o completa)")}let percentual=this.phasePercentages[currentPhase]||0;console.log(`üìà Fase ${currentPhase}: ${percentual}% (Status: ${currentStatus})`);console.log(`üìä Percentual calculado pela fase: ${percentual}`);const totalEtapas=16;this.updateProgressElements(percentual,currentPhase,currentStatus,progressData,totalEtapas);if(progressData.estimativas?.dados||progressData.dados_extra?.estimativas_tela_5){this.updateInitialEstimate(progressData)}if(progressData.dados_extra||currentStatus==="success"){this.updateResults(progressData);this.updateSuccessHeader();if(currentStatus==="success"){console.log("üéâ RPA conclu√≠do com sucesso!");this.stopProgressPolling();this.isProcessing=false;this.stopSpinnerTimer()}}}}catch(error){console.error("‚ùå Erro ao atualizar progresso:",error)}}getErrorTable(){return{1e3:{category:"VALIDATION_ERROR",description:"Par√¢metros obrigat√≥rios ausentes ou inv√°lidos",message:"Um ou mais par√¢metros obrigat√≥rios n√£o foram fornecidos ou s√£o inv√°lidos",action:"Verificar se todos os par√¢metros obrigat√≥rios est√£o presentes e com formato correto"},1001:{category:"VALIDATION_ERROR",description:"Formato de CPF inv√°lido",message:"O CPF fornecido n√£o possui formato v√°lido (deve ter 11 d√≠gitos num√©ricos)",action:"Verificar se o CPF possui exatamente 11 d√≠gitos num√©ricos"},1002:{category:"VALIDATION_ERROR",description:"Formato de email inv√°lido",message:"O email fornecido n√£o possui formato v√°lido",action:"Verificar se o email possui formato v√°lido (ex: usuario@dominio.com)"},1003:{category:"VALIDATION_ERROR",description:"Formato de CEP inv√°lido",message:"O CEP fornecido n√£o possui formato v√°lido (deve ter 8 d√≠gitos num√©ricos)",action:"Verificar se o CEP possui exatamente 8 d√≠gitos num√©ricos"},1004:{category:"VALIDATION_ERROR",description:"JSON malformado ou inv√°lido",message:"O JSON fornecido n√£o pode ser interpretado corretamente",action:"Verificar se o JSON est√° formatado corretamente e √© v√°lido"},2e3:{category:"CHROME_ERROR",description:"ChromeDriver n√£o encontrado ou inacess√≠vel",message:"N√£o foi poss√≠vel encontrar ou acessar o ChromeDriver necess√°rio para execu√ß√£o",action:"Verificar se o ChromeDriver est√° presente em ./chromedriver/chromedriver-win64/chromedriver.exe"},2001:{category:"CHROME_ERROR",description:"Falha ao criar inst√¢ncia do Chrome",message:"O Chrome n√£o p√¥de ser iniciado ou configurado corretamente",action:"Verificar se o Chrome est√° instalado e se h√° mem√≥ria dispon√≠vel suficiente"},2002:{category:"CHROME_ERROR",description:"Sess√£o do Chrome n√£o p√¥de ser criada",message:"Falha ao estabelecer sess√£o com o navegador Chrome",action:"Fechar outras inst√¢ncias do Chrome e verificar configura√ß√µes de firewall/antiv√≠rus"},2003:{category:"CHROME_ERROR",description:"Chrome fechou inesperadamente",message:"O navegador Chrome foi fechado durante a execu√ß√£o",action:"Verificar logs do Chrome e disponibilidade de mem√≥ria do sistema"},3e3:{category:"NAVIGATION_ERROR",description:"Falha ao navegar para URL",message:"N√£o foi poss√≠vel acessar a URL especificada",action:"Verificar se a URL est√° correta e se h√° conectividade com a internet"},3001:{category:"ELEMENT_ERROR",description:"Elemento n√£o encontrado na p√°gina",message:"O elemento especificado n√£o foi encontrado na p√°gina atual",action:"Verificar se o seletor est√° correto e se a p√°gina carregou completamente"},3002:{category:"ELEMENT_ERROR",description:"Elemento n√£o est√° clic√°vel",message:"O elemento foi encontrado mas n√£o pode ser clicado",action:"Aguardar carregamento completo e verificar se o elemento est√° vis√≠vel e habilitado"},3003:{category:"ELEMENT_ERROR",description:"Elemento obsoleto (Stale Element Reference)",message:"O elemento foi encontrado mas tornou-se obsoleto durante a opera√ß√£o",action:"Recarregar a refer√™ncia do elemento e tentar novamente"},3004:{category:"ELEMENT_ERROR",description:"Elemento interceptado por outro",message:"O elemento n√£o pode ser clicado pois est√° sendo interceptado por outro elemento",action:"Fechar modais/overlays ou rolar para o elemento antes de clicar"},3005:{category:"ELEMENT_ERROR",description:"Elemento n√£o interativo",message:"O elemento encontrado n√£o √© interativo (n√£o pode ser clicado ou preenchido)",action:"Verificar se o elemento correto foi selecionado e se est√° habilitado"},4e3:{category:"TIMEOUT_ERROR",description:"Timeout ao aguardar carregamento da p√°gina",message:"A p√°gina n√£o carregou completamente dentro do tempo limite especificado",action:"Aumentar timeout ou verificar conectividade com a internet"},4001:{category:"TIMEOUT_ERROR",description:"Timeout ao aguardar elemento aparecer",message:"O elemento esperado n√£o apareceu na p√°gina dentro do tempo limite",action:"Verificar se o seletor est√° correto e se a p√°gina √© a esperada"},4002:{category:"TIMEOUT_ERROR",description:"Timeout ao aguardar estabiliza√ß√£o do DOM",message:"O DOM da p√°gina n√£o estabilizou dentro do tempo limite especificado",action:"Aumentar timeout de estabiliza√ß√£o ou usar fallback tradicional"},4003:{category:"TIMEOUT_ERROR",description:"Timeout ao aguardar elemento ficar clic√°vel",message:"O elemento n√£o ficou clic√°vel dentro do tempo limite",action:"Verificar se o elemento est√° realmente habilitado e se as condi√ß√µes foram satisfeitas"},6e3:{category:"SCREEN_ERROR",description:"Falha na Tela 1 - Sele√ß√£o do tipo de seguro",message:"N√£o foi poss√≠vel selecionar o tipo de seguro 'Carro' na primeira tela",action:"Verificar se o site ainda possui a mesma estrutura e se o bot√£o Carro est√° presente"},6001:{category:"SCREEN_ERROR",description:"Falha na Tela 2 - Inser√ß√£o da placa",message:"N√£o foi poss√≠vel inserir a placa do ve√≠culo na segunda tela",action:"Verificar se o campo de placa est√° presente e edit√°vel"},6002:{category:"SCREEN_ERROR",description:"Falha na Tela 3 - Confirma√ß√£o do ve√≠culo",message:"N√£o foi poss√≠vel confirmar o ve√≠culo na terceira tela",action:"Verificar se a confirma√ß√£o do ve√≠culo est√° aparecendo e se os elementos est√£o presentes"},6003:{category:"SCREEN_ERROR",description:"Falha na Tela 4 - Ve√≠culo segurado",message:"N√£o foi poss√≠vel responder sobre ve√≠culo j√° segurado na quarta tela",action:"Verificar se a pergunta sobre ve√≠culo segurado est√° aparecendo"},6004:{category:"SCREEN_ERROR",description:"Falha na Tela 5 - Estimativa inicial",message:"N√£o foi poss√≠vel navegar pela tela de estimativa inicial",action:"Verificar se a tela de estimativa est√° carregando corretamente"},6005:{category:"SCREEN_ERROR",description:"Falha na Tela 6 - Tipo de combust√≠vel",message:"N√£o foi poss√≠vel selecionar o tipo de combust√≠vel na sexta tela",action:"Verificar se a tela de combust√≠vel est√° carregando e se os elementos est√£o presentes"},6006:{category:"SCREEN_ERROR",description:"Falha na Tela 7 - Endere√ßo de pernoite",message:"N√£o foi poss√≠vel inserir o endere√ßo de pernoite na s√©tima tela",action:"Verificar se o campo CEP est√° presente e se o CEP √© v√°lido"},6007:{category:"SCREEN_ERROR",description:"Falha na Tela 8 - Finalidade do ve√≠culo",message:"N√£o foi poss√≠vel selecionar a finalidade do ve√≠culo na oitava tela",action:"Verificar se a tela de finalidade est√° carregando e se o bot√£o com ID espec√≠fico est√° presente"},6008:{category:"SCREEN_ERROR",description:"Falha na Tela 9 - Dados pessoais",message:"N√£o foi poss√≠vel preencher os dados pessoais na nona tela",action:"Verificar se todos os campos est√£o presentes e edit√°veis"},7e3:{category:"SYSTEM_ERROR",description:"Mem√≥ria insuficiente",message:"O sistema n√£o possui mem√≥ria suficiente para executar o RPA",action:"Fechar outros programas, reiniciar o sistema ou aumentar mem√≥ria dispon√≠vel"},7001:{category:"SYSTEM_ERROR",description:"Disco cheio",message:"N√£o h√° espa√ßo suficiente em disco para salvar arquivos tempor√°rios",action:"Liberar espa√ßo em disco e verificar se h√° espa√ßo suficiente"},7002:{category:"SYSTEM_ERROR",description:"Permiss√µes insuficientes",message:"O usu√°rio n√£o possui permiss√µes suficientes para executar opera√ß√µes necess√°rias",action:"Executar como administrador ou verificar permiss√µes da pasta de trabalho"},7003:{category:"SYSTEM_ERROR",description:"Arquivo n√£o encontrado",message:"Um arquivo necess√°rio para execu√ß√£o n√£o foi encontrado",action:"Verificar se o arquivo est√° no local correto e se h√° permiss√µes de acesso"},9003:{category:"MANUAL_QUOTATION_ERROR",description:"Cota√ß√£o manual necess√°ria",message:"N√£o foi poss√≠vel efetuar o c√°lculo nesse momento. O corretor de seguros j√° foi notificado e logo entrar√° em contato para te auxiliar a encontrar as melhores op√ß√µes.",action:"O corretor de seguros entrar√° em contato em breve para auxiliar com a cota√ß√£o manual."},9004:{category:"FINAL_SCREEN_ERROR",description:"Tela final n√£o detectada",message:"Infelizmente n√£o foi poss√≠vel, devido a problemas t√©cnicos, efetuar o c√°lculo agora. Mas a Imediato Seguros far√° o c√°lculo manualmente em instantes e entrar√° em contato",action:"A Imediato Seguros far√° o c√°lculo manualmente e entrar√° em contato em breve"}}}isErrorStatus(status,mensagem,errorCode=null){const statusLower=status.toLowerCase();const mensagemLower=mensagem.toLowerCase();const errorStatuses=["error","failed","failure","exception","timeout","denied","invalid","blocked","cancelled","aborted"];const errorKeywords=["falhou","erro","failed","error","exception","timeout","denied","invalid","blocked","cancelled"];const errorCodes=["400","401","403","404","405","408","409","410","422","429","500","501","502","503","504","9003","9004"];if(errorCode){const errorTable=this.getErrorTable();if(errorTable[errorCode]){return true}}if(errorCode){const codeStr=String(errorCode);for(const code of errorCodes){if(codeStr.includes(code)){return true}}}for(const errorStatus of errorStatuses){if(statusLower.includes(errorStatus)){return true}}for(const keyword of errorKeywords){if(mensagemLower.includes(keyword)){return true}}for(const code of errorCodes){if(mensagemLower.includes(`erro ${code}`)||mensagemLower.includes(`error ${code}`)||mensagemLower.includes(`code ${code}`)||mensagemLower.includes(`${code} error`)){return true}}return false}handleRPAError(mensagem,errorCode=null){console.error("üö® Tratando erro do RPA:",{mensagem:mensagem,errorCode:errorCode});this.stopProgressPolling();this.isProcessing=false;this.stopSpinnerTimer();const modal=document.getElementById("rpaModal");if(modal){modal.remove()}if(typeof Swal!=="undefined"){Swal.fire({title:"üìû Cota√ß√£o Manual Necess√°ria",text:"N√£o foi poss√≠vel efetuar o c√°lculo nesse momento. Um especialista da Imediato Seguros far√° o c√°lculo manualmente e entrar√° em contato para envia-lo √† voc√™ em seguida.",icon:"info",confirmButtonText:"Entendi",confirmButtonColor:"#3085d6"})}}showErrorAlert(mensagem,acao=null,errorCode=null){if(typeof Swal!=="undefined"){Swal.fire({title:"üìû Cota√ß√£o Manual Necess√°ria",text:"N√£o foi poss√≠vel efetuar o c√°lculo nesse momento. Um especialista da Imediato Seguros far√° o c√°lculo manualmente e entrar√° em contato para envia-lo √† voc√™ em seguida.",icon:"info",confirmButtonText:"Entendi",confirmButtonColor:"#3085d6"})}else{alert("üìû Cota√ß√£o Manual Necess√°ria\n\nN√£o foi poss√≠vel efetuar o c√°lculo nesse momento. Um especialista da Imediato Seguros far√° o c√°lculo manualmente e entrar√° em contato para envia-lo √† voc√™ em seguida.")}}updateProgressElements(percentual,currentPhase,currentStatus,progressData,totalEtapas=16){console.log(`üîÑ Atualizando elementos: ${percentual}%, Fase ${currentPhase}, Status: ${currentStatus}`);const progressText=document.querySelector("#rpaModal .progress-text");const currentPhaseElement=document.querySelector("#rpaModal .current-phase");const subPhaseElement=document.querySelector("#rpaModal .sub-phase");const stageInfo=document.querySelector("#rpaModal .stage-info");const progressFill=document.querySelector("#rpaModal .progress-bar-fill");if(progressText){progressText.textContent=`${Math.round(percentual)}%`;console.log("‚úÖ Progress text atualizado:",progressText.textContent)}if(currentPhaseElement){const message=this.getPhaseMessage(currentPhase);currentPhaseElement.textContent=message;console.log("‚úÖ Current phase atualizado:",message)}if(subPhaseElement){const subMessage=this.getPhaseSubMessage(currentPhase);subPhaseElement.textContent=subMessage;console.log("‚úÖ Sub phase atualizado:",subMessage)}if(stageInfo){stageInfo.textContent=`Fase ${currentPhase} de ${totalEtapas}`;console.log("‚úÖ Stage info atualizado:",stageInfo.textContent)}if(progressFill){progressFill.style.width=`${percentual}%`;console.log("‚úÖ Progress fill atualizado:",progressFill.style.width)}}getPhaseMessage(phaseNumber){return this.phaseMessages[phaseNumber]||`Fase ${phaseNumber}`}getPhaseSubMessage(phaseNumber){return this.phaseSubMessages[phaseNumber]||""}updateInitialEstimate(data){if(this.initialEstimateUpdated)return;console.log("üí∞ Atualizando estimativa inicial:",data);const estimativas=data.estimativas?.dados||data.dados_extra?.estimativas_tela_5||data.historico?.estimativas||data.progress?.estimativas;console.log("üí∞ Estimativas encontradas:",estimativas);if(estimativas){let valorInicial=null;if(estimativas.coberturas_detalhadas?.valor_total){valorInicial=estimativas.coberturas_detalhadas.valor_total}else if(estimativas.valor_total){valorInicial=estimativas.valor_total}else if(estimativas.valor){valorInicial=estimativas.valor}else if(typeof estimativas==="number"){valorInicial=estimativas}if(valorInicial){const valorFormatado=this.formatCurrency(valorInicial);console.log("üí∞ Valor inicial formatado:",valorFormatado);const initialEstimateElement=document.getElementById("initialEstimate");if(initialEstimateElement){initialEstimateElement.textContent=valorFormatado;this.highlightInitialEstimate()}this.initialEstimateUpdated=true}else{console.log("‚ö†Ô∏è Valor inicial n√£o encontrado nas estimativas")}}else{console.log("‚ö†Ô∏è Nenhuma estimativa encontrada nos dados")}}highlightInitialEstimate(){const estimateCard=document.querySelector("#rpaModal .result-card.recommended");if(estimateCard){estimateCard.style.animation="pulse 2s infinite"}}updateResults(data){console.log("üìä Atualizando resultados finais:",data);console.log("üìä Estrutura completa dos dados:",JSON.stringify(data,null,2));let resultados=null;let planoRecomendado=null;let planoAlternativo=null;if(data.resultados_finais?.dados?.dados_finais){resultados=data.resultados_finais.dados.dados_finais;planoRecomendado=resultados.plano_recomendado;planoAlternativo=resultados.plano_alternativo;console.log("‚úÖ Dados encontrados em resultados_finais.dados.dados_finais")}if(!planoRecomendado&&data.timeline){const finalEntry=data.timeline.find(entry=>entry.etapa==="final");if(finalEntry?.dados_extra){planoRecomendado=finalEntry.dados_extra.plano_recomendado;planoAlternativo=finalEntry.dados_extra.plano_alternativo;console.log("‚úÖ Dados encontrados em timeline[final].dados_extra")}}if(!planoRecomendado&&data.dados_extra){planoRecomendado=data.dados_extra.plano_recomendado;planoAlternativo=data.dados_extra.plano_alternativo;console.log("‚úÖ Dados encontrados em dados_extra direto")}console.log("üîç DEBUG - Estrutura completa:",{resultados_finais:data.resultados_finais,timeline_final:data.timeline?.find(entry=>entry.etapa==="final"),dados_extra_direto:data.dados_extra,plano_recomendado_encontrado:planoRecomendado,plano_alternativo_encontrado:planoAlternativo});if(planoRecomendado&&planoAlternativo){console.log("üìä Resultados encontrados:",{planoRecomendado:planoRecomendado,planoAlternativo:planoAlternativo});this.updateCardValue("recommendedValue",planoRecomendado.valor);this.updateCardValue("alternativeValue",planoAlternativo.valor);this.updateCardDetails("recommended",planoRecomendado);this.updateCardDetails("alternative",planoAlternativo)}else{console.log("‚ö†Ô∏è Nenhum resultado final encontrado em nenhuma estrutura")}}updateCardValue(elementId,valor){console.log(`üîç DEBUG - updateCardValue chamado:`,{elementId:elementId,valor:valor,tipo:typeof valor});if(valor){const element=document.querySelector(`#rpaModal #${elementId}`);console.log(`üîç DEBUG - Elemento encontrado:`,element);if(element){const valorFormatado=this.formatCurrency(valor);element.textContent=valorFormatado;console.log(`‚úÖ Valor ${elementId} atualizado:`,valorFormatado)}else{console.error(`‚ùå Elemento #${elementId} n√£o encontrado no DOM`)}}else{console.warn(`‚ö†Ô∏è Valor vazio para ${elementId}:`,valor)}}updateCardDetails(prefix,plano){if(!plano)return;console.log(`üîç DEBUG - Atualizando detalhes do plano ${prefix}:`,plano);const formatCheck=value=>value?'<i class="fas fa-check text-success"></i>':'<i class="fas fa-times text-danger"></i>';const formatMoney=value=>{if(!value||value==="-")return"-";if(typeof value==="string"&&value.includes("R$")){return value}if(typeof value==="number"){return this.formatCurrency(value)}const numValue=parseFloat(value.toString().replace(/[^\d,.-]/g,"").replace(",","."));if(!isNaN(numValue)){return this.formatCurrency(numValue)}return`R$ ${value}`};this.updateField(`${prefix}FormaPagamento`,plano.forma_pagamento||"-");this.updateField(`${prefix}Parcelamento`,plano.parcelamento||"-");this.updateField(`${prefix}ValorMercado`,plano.valor_mercado||"-");this.updateField(`${prefix}ValorFranquia`,formatMoney(plano.valor_franquia||"-"));this.updateField(`${prefix}TipoFranquia`,plano.tipo_franquia||"-");this.updateField(`${prefix}Assistencia`,formatCheck(plano.assistencia));this.updateField(`${prefix}Vidros`,formatCheck(plano.vidros));this.updateField(`${prefix}CarroReserva`,formatCheck(plano.carro_reserva));this.updateField(`${prefix}DanosMateriais`,formatMoney(plano.danos_materiais||"-"));this.updateField(`${prefix}DanosCorporais`,formatMoney(plano.danos_corporais||"-"));this.updateField(`${prefix}DanosMorais`,formatMoney(plano.danos_morais||"-"));this.updateField(`${prefix}MorteInvalidez`,formatMoney(plano.morte_invalidez||"-"))}updateField(elementId,value){const element=document.querySelector(`#rpaModal #${elementId}`);if(element){element.innerHTML=value;console.log(`‚úÖ Campo ${elementId} atualizado:`,value)}}updateSuccessHeader(){const progressHeader=document.querySelector("#rpaModal .progress-header");if(progressHeader){const contactMessage=document.createElement("p");contactMessage.className="contact-message";contactMessage.innerHTML='<i class="fas fa-phone"></i> Um especialista da Imediato Seguros entrar√° em contato em instantes para passar os detalhes!';progressHeader.appendChild(contactMessage)}}formatCurrency(value){if(!value)return"R$ 0,00";if(typeof value==="string"&&value.includes("R$")){console.log("üí∞ Valor j√° formatado:",value);return value}let numericValue;if(typeof value==="string"){const cleanValue=value.replace(/[R$\s]/g,"").replace(",",".");numericValue=parseFloat(cleanValue)}else{numericValue=parseFloat(value)}if(isNaN(numericValue)){console.warn("‚ö†Ô∏è Valor inv√°lido para formata√ß√£o:",value);return"R$ 0,00"}const formatted=numericValue.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});console.log("üí∞ Valor formatado:",value,"‚Üí",formatted);return formatted}}class FormValidator{constructor(){this.config={USE_PHONE_API:true,APILAYER_KEY:"dce92fa84152098a3b5b7b8db24debbc",SAFETY_BASE:"https://optin.safetymails.com/main/safetyoptin/20a7a1c297e39180bd80428ac13c363e882a531f/9bab7f0c2711c5accfb83588c859dc1103844a94/",VALIDAR_PH3A:false}}onlyDigits(s){return(s||"").replace(/\D+/g,"")}toUpperNospace(s){return(s||"").toUpperCase().trim()}validarCPFFormato(cpf){const cpfLimpo=this.onlyDigits(cpf);return cpfLimpo.length===11&&!/^(\d)\1{10}$/.test(cpfLimpo)}validarCPFAlgoritmo(cpf){cpf=this.onlyDigits(cpf);if(cpf.length!==11||/^(\d)\1{10}$/.test(cpf))return false;let soma=0,resto=0;for(let i=1;i<=9;i++){soma+=parseInt(cpf[i-1],10)*(11-i)}resto=soma*10%11;if(resto===10||resto===11)resto=0;if(resto!==parseInt(cpf[9],10))return false;soma=0;for(let i=1;i<=10;i++){soma+=parseInt(cpf[i-1],10)*(12-i)}resto=soma*10%11;if(resto===10||resto===11)resto=0;return resto===parseInt(cpf[10],10)}async validateCPF(cpf){if(!cpf)return{ok:false,reason:"vazio"};const formatoOk=this.validarCPFFormato(cpf);const algoritmoOk=this.validarCPFAlgoritmo(cpf);return{ok:formatoOk&&algoritmoOk,reason:!formatoOk?"formato":!algoritmoOk?"algoritmo":"ok"}}async validateCEP(cep){const cepLimpo=this.onlyDigits(cep);if(cepLimpo.length!==8){return{ok:false,reason:"formato"}}try{const response=await fetch(`https://viacep.com.br/ws/${cepLimpo}/json/`);const data=await response.json();return{ok:!data.erro,reason:data.erro?"nao_encontrado":"ok",viacep:data}}catch(error){return{ok:false,reason:"erro_api"}}}validarPlacaFormato(p){const placaLimpa=p.toUpperCase().replace(/[^A-Z0-9]/g,"");const antigo=/^[A-Z]{3}[0-9]{4}$/;const mercosul=/^[A-Z]{3}[0-9][A-Z][0-9]{2}$/;return antigo.test(placaLimpa)||mercosul.test(placaLimpa)}extractVehicleFromPlacaFipe(apiJson){const r=apiJson&&(apiJson.informacoes_veiculo||apiJson);if(!r||typeof r!=="object")return{marcaTxt:"",anoModelo:"",tipoVeiculo:""};const fabricante=r.marca||"";const modelo=r.modelo||"";const anoMod=r.ano||r.ano_modelo||"";let tipoVeiculo="";if(r.segmento){const segmento=r.segmento.toLowerCase();if(segmento.includes("moto")){tipoVeiculo="moto"}else if(segmento.includes("auto")){tipoVeiculo="carro"}else{const modeloLower=modelo.toLowerCase();const marcaLower=fabricante.toLowerCase();if(marcaLower.includes("honda")||marcaLower.includes("yamaha")||marcaLower.includes("suzuki")||marcaLower.includes("kawasaki")||modeloLower.includes("cg")||modeloLower.includes("cb")||modeloLower.includes("fazer")||modeloLower.includes("ninja")){tipoVeiculo="moto"}else{tipoVeiculo="carro"}}}else{const modeloLower=modelo.toLowerCase();const marcaLower=fabricante.toLowerCase();if(marcaLower.includes("honda")||marcaLower.includes("yamaha")||marcaLower.includes("suzuki")||marcaLower.includes("kawasaki")||modeloLower.includes("cg")||modeloLower.includes("cb")||modeloLower.includes("fazer")||modeloLower.includes("ninja")){tipoVeiculo="moto"}else{tipoVeiculo="carro"}}return{marcaTxt:[fabricante,modelo].filter(Boolean).join(" / "),anoModelo:this.onlyDigits(String(anoMod)).slice(0,4),tipoVeiculo:tipoVeiculo}}async validatePlaca(placa){const raw=placa.toUpperCase().replace(/[^A-Z0-9]/g,"");if(!this.validarPlacaFormato(raw)){return{ok:false,reason:"formato"}}try{const response=await fetch("https://mdmidia.com.br/placa-validate.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({placa:raw})});const data=await response.json();const ok=!!data&&(data.codigo===1||data.success===true);return{ok:ok,reason:ok?"ok":"nao_encontrada",parsed:ok?this.extractVehicleFromPlacaFipe(data):{marcaTxt:"",anoModelo:"",tipoVeiculo:""}}}catch(error){return{ok:false,reason:"erro_api"}}}validarCelularLocal(ddd,numero){console.log("üîç [VALIDACAO] validarCelularLocal - DDD:",ddd,"Numero:",numero);const d=this.onlyDigits(ddd),n=this.onlyDigits(numero);console.log("üîç [VALIDACAO] DDD limpo:",d,"Numero limpo:",n);console.log("üîç [VALIDACAO] DDD length:",d.length,"Numero length:",n.length);if(d.length!==2){console.log("‚ùå [VALIDACAO] DDD inv√°lido - length:",d.length);return{ok:false,reason:"ddd"}}if(n.length!==9){console.log("‚ùå [VALIDACAO] Numero inv√°lido - length:",n.length,"esperado: 9");return{ok:false,reason:"len"}}if(n[0]!=="9"){console.log("‚ùå [VALIDACAO] Numero n√£o come√ßa com 9 - primeiro d√≠gito:",n[0]);return{ok:false,reason:"pattern"}}console.log("‚úÖ [VALIDACAO] Celular v√°lido - national:",d+n);return{ok:true,national:d+n}}async validarCelularApi(nat){if(!this.config.USE_PHONE_API)return{ok:true};try{const response=await fetch(`https://apilayer.net/api/validate?access_key=${this.config.APILAYER_KEY}&country_code=BR&number=${nat}`);const data=await response.json();return{ok:!!data?.valid}}catch(error){return{ok:true}}}async validateCelular(ddd,celular){console.log("üîç [VALIDACAO] validateCelular iniciado - DDD:",ddd,"Celular:",celular);const local=this.validarCelularLocal(ddd,celular);console.log("üîç [VALIDACAO] Resultado valida√ß√£o local:",local);if(!local.ok){console.log("‚ùå [VALIDACAO] Valida√ß√£o local falhou - reason:",local.reason);return{ok:false,reason:local.reason}}console.log("üîç [VALIDACAO] Validando via API...");const api=await this.validarCelularApi(local.national);console.log("üîç [VALIDACAO] Resultado valida√ß√£o API:",api);const result={ok:api.ok};console.log("üîç [VALIDACAO] Resultado final validateCelular:",result);return result}validarEmailLocal(v){return/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test((v||"").trim())}async validateEmail(email){if(!email)return{ok:false,reason:"vazio"};const localOk=this.validarEmailLocal(email);if(!localOk)return{ok:false,reason:"formato"};try{const response=await fetch(this.config.SAFETY_BASE+btoa(email));const data=await response.json();if(data&&data.StatusEmail&&data.StatusEmail!=="VALIDO"){return{ok:false,reason:"safety_mails"}}}catch(error){}return{ok:true}}}class MainPage{constructor(){this.sessionId=null;this.modalProgress=null;this.fixedData={telefone:"11999999999",email:"cliente@exemplo.com",profissao:"Empres√°rio",renda_mensal:"10000",modelo:"Civic",ano:"2020",cor:"Prata",combustivel:"Flex",zero_km:"false",uso:"Particular",garagem:"true",tipo_seguro:"Comprehensive",franquia:"500",cobertura_terceiros:"true",cobertura_vidros:"true",cobertura_carro_reserva:"true",cobertura_assistencia:"true"};this.init()}init(){console.log("üöÄ MainPage inicializada");this.setupEventListeners()}setupEventListeners(){if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",()=>{this.setupFormSubmission()})}else{this.setupFormSubmission()}}setupFormSubmission(){const forms=document.querySelectorAll("form");console.log("üìã Formul√°rios encontrados:",forms.length);const submitButton=document.getElementById("submit_button_auto");if(submitButton){console.log("üéØ Bot√£o submit_button_auto encontrado");submitButton.addEventListener("click",e=>{e.preventDefault();e.stopPropagation();console.log("üéØ Bot√£o CALCULE AGORA! clicado");const form=submitButton.closest("form");if(form){console.log("üìã Formul√°rio encontrado via bot√£o");this.handleFormSubmit(form)}else{console.error("‚ùå Formul√°rio n√£o encontrado")}})}forms.forEach((form,index)=>{console.log(`üìã Configurando formul√°rio ${index+1}`);form.addEventListener("submit",e=>{e.preventDefault();console.log("üìã Formul√°rio submetido:",form);this.handleFormSubmit(form)})})}collectFormData(form){const formData=new FormData(form);const data={};for(let[key,value]of formData.entries()){data[key]=value}const gclidField=document.getElementById("GCLID_FLD");if(gclidField){data.GCLID_FLD=gclidField.value||"TesteRPA123";console.log("‚úÖ Campo GCLID_FLD capturado:",data.GCLID_FLD)}else{data.GCLID_FLD="TesteRPA123";console.log("‚ö†Ô∏è Campo GCLID_FLD n√£o encontrado, usando valor padr√£o")}this.applyFieldConversions(data);const cleanedData=this.removeDuplicateFields(data);const completeData={...this.fixedData,...cleanedData};console.log("üìä Dados coletados:",completeData);return completeData}removeDuplicateFields(data){const cleanedData={...data};const fieldsToRemove=["DATA-DE-NASCIMENTO","SEXO","ESTADO-CIVIL","DDD-CELULAR","CELULAR","PLACA","MARCA","ANO","TIPO-DE-VEICULO","CEP","CPF"];fieldsToRemove.forEach(field=>{if(cleanedData[field]){console.log(`üóëÔ∏è Removendo campo duplicado incorreto: ${field}`);delete cleanedData[field]}});console.log("üßπ Campos duplicados removidos. Campos restantes:",Object.keys(cleanedData));return cleanedData}applyFieldConversions(data){if(data["ESTADO-CIVIL"]){data.estado_civil=this.convertEstadoCivil(data["ESTADO-CIVIL"]);console.log(`üîÑ Estado civil convertido: "${data["ESTADO-CIVIL"]}" ‚Üí "${data.estado_civil}"`)}if(data.SEXO){data.sexo=this.convertSexo(data.SEXO);console.log(`üîÑ Sexo convertido: "${data.SEXO}" ‚Üí "${data.sexo}"`)}if(data["TIPO-DE-VEICULO"]){data.tipo_veiculo=this.convertTipoVeiculo(data["TIPO-DE-VEICULO"]);console.log(`üîÑ Tipo de ve√≠culo convertido: "${data["TIPO-DE-VEICULO"]}" ‚Üí "${data.tipo_veiculo}"`)}if(data["DDD-CELULAR"]&&data.CELULAR&&!data.telefone){data.telefone=data["DDD-CELULAR"]+data.CELULAR;console.log(`üîÑ Telefone concatenado: "${data["DDD-CELULAR"]}" + "${data.CELULAR}" = "${data.telefone}"`)}const fieldMapping={CPF:"cpf",PLACA:"placa",MARCA:"marca",CEP:"cep","DATA-DE-NASCIMENTO":"data_nascimento"};Object.keys(fieldMapping).forEach(webflowField=>{if(data[webflowField]){data[fieldMapping[webflowField]]=data[webflowField]}});if(data["TIPO-DE-VEICULO"]){data.tipo_veiculo=this.convertTipoVeiculo(data["TIPO-DE-VEICULO"]);console.log(`üîÑ Tipo de ve√≠culo convertido: "${data["TIPO-DE-VEICULO"]}" ‚Üí "${data.tipo_veiculo}"`)}}convertEstadoCivil(webflowValue){if(!webflowValue)return"";const normalized=webflowValue.toLowerCase().trim().replace(/[√†√°√¢√£√§√•]/g,"a").replace(/[√®√©√™√´]/g,"e").replace(/[√¨√≠√Æ√Ø]/g,"i").replace(/[√≤√≥√¥√µ√∂]/g,"o").replace(/[√π√∫√ª√º]/g,"u").replace(/[√ß]/g,"c").replace(/[√±]/g,"n").replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ");console.log(`üîç Estado civil normalizado: "${webflowValue}" ‚Üí "${normalized}"`);const estadoCivilMapping={solteiro:"Solteiro",sol:"Solteiro",single:"Solteiro",solteira:"Solteiro",casado:"Casado",cas:"Casado",married:"Casado",casada:"Casado","casado ou uniao estavel":"Casado ou Uniao Estavel","casado ou uniao":"Casado ou Uniao Estavel","casado uniao estavel":"Casado ou Uniao Estavel","casado uniao":"Casado ou Uniao Estavel","uniao estavel":"Casado ou Uniao Estavel",uniao:"Casado ou Uniao Estavel","casado ou uni√£o est√°vel":"Casado ou Uniao Estavel","casado ou uni√£o":"Casado ou Uniao Estavel","casado uni√£o est√°vel":"Casado ou Uniao Estavel","casado uni√£o":"Casado ou Uniao Estavel","uni√£o est√°vel":"Casado ou Uniao Estavel","uni√£o":"Casado ou Uniao Estavel",divorciado:"Divorciado",div:"Divorciado",divorced:"Divorciado",divorciada:"Divorciado",separado:"Separado",sep:"Separado",separated:"Separado",separada:"Separado",viuvo:"Viuvo",viuva:"Viuvo",widowed:"Viuvo","vi√∫vo":"Viuvo","vi√∫va":"Viuvo"};if(estadoCivilMapping[normalized]){return estadoCivilMapping[normalized]}for(const[key,value]of Object.entries(estadoCivilMapping)){if(normalized.includes(key)||key.includes(normalized)){console.log(`üîç Correspond√™ncia parcial encontrada: "${normalized}" ‚Üí "${value}"`);return value}}console.warn(`‚ö†Ô∏è Estado civil n√£o mapeado: "${webflowValue}". Usando fallback.`);return webflowValue.charAt(0).toUpperCase()+webflowValue.slice(1).toLowerCase()}convertSexo(webflowValue){if(!webflowValue)return"";const normalized=webflowValue.toLowerCase().trim();console.log(`üîç Sexo normalizado: "${webflowValue}" ‚Üí "${normalized}"`);const sexoMapping={m:"Masculino",masculino:"Masculino",male:"Masculino",masculina:"Masculino",masculino:"Masculino",mas:"Masculino",mascul:"Masculino",f:"Feminino",feminino:"Feminino",female:"Feminino",feminina:"Feminino",feminino:"Feminino",fem:"Feminino",femin:"Feminino"};if(sexoMapping[normalized]){return sexoMapping[normalized]}for(const[key,value]of Object.entries(sexoMapping)){if(normalized.includes(key)||key.includes(normalized)){console.log(`üîç Correspond√™ncia parcial encontrada: "${normalized}" ‚Üí "${value}"`);return value}}console.warn(`‚ö†Ô∏è Sexo n√£o mapeado: "${webflowValue}". Usando fallback.`);return webflowValue.charAt(0).toUpperCase()+webflowValue.slice(1).toLowerCase()}convertTipoVeiculo(webflowValue){if(!webflowValue)return"carro";const tipo=webflowValue.toLowerCase().trim();console.log(`üîç Tipo de ve√≠culo normalizado: "${webflowValue}" ‚Üí "${tipo}"`);const tiposCarro=["sedan","hatch","hatchback","suv","pickup","crossover","wagon","coupe","convertible","carro","automovel"];const tiposMoto=["moto","motocicleta","scooter","bike","motoneta"];for(const tipoCarro of tiposCarro){if(tipo.includes(tipoCarro)||tipoCarro.includes(tipo)){console.log(`üîç Tipo de ve√≠culo reconhecido como carro: "${tipo}" ‚Üí "carro"`);return"carro"}}for(const tipoMoto of tiposMoto){if(tipo.includes(tipoMoto)||tipoMoto.includes(tipo)){console.log(`üîç Tipo de ve√≠culo reconhecido como moto: "${tipo}" ‚Üí "moto"`);return"moto"}}console.warn(`‚ö†Ô∏è Tipo de ve√≠culo n√£o reconhecido: "${webflowValue}" - usando "carro" como padr√£o`);return"carro"}async handleFormSubmit(form){try{console.log("üöÄ Iniciando processo RPA...");this.updateButtonLoading(true);const formData=this.collectFormData(form);console.log("üîç [MAIN] Iniciando valida√ß√£o de formul√°rio...");console.log("üîç [MAIN] Dados coletados:",formData);console.log("üîç [MAIN] Campos espec√≠ficos - Telefone:",formData.telefone);const validationResult=await this.validateFormData(formData);console.log("üîç [MAIN] Resultado da valida√ß√£o:",validationResult);if(!validationResult.isValid){console.log("‚ùå [MAIN] Valida√ß√£o falhou - bloqueando RPA");console.log("‚ùå [MAIN] Erros encontrados:",validationResult.errors);await this.showValidationAlert(validationResult.errors);this.updateButtonLoading(false);console.log("‚ùå [MAIN] RPA BLOQUEADO - retornando sem executar");return}console.log("‚úÖ [MAIN] Valida√ß√£o passou - prosseguindo com RPA");window.rpaData={telefone:formData.telefone};this.openProgressModal();console.log("üì§ JSON sendo enviado para API:",JSON.stringify(formData,null,2));console.log("üì§ Campos do formul√°rio:",Object.keys(formData));console.log("üì§ Valores dos campos:",formData);const response=await fetch("https://rpaimediatoseguros.com.br/api/rpa/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(formData)});const result=await response.json();console.log("üìä Resposta da API:",result);console.log("üìä Status da resposta:",response.status);console.log("üìä Headers da resposta:",response.headers);if(result.success&&result.session_id){this.sessionId=result.session_id;console.log("‚úÖ Session ID recebido:",this.sessionId);this.initializeProgressModal()}else{console.error("‚ùå Erro na API:",result);this.updateButtonLoading(false);this.showError("Erro ao iniciar o c√°lculo. Tente novamente.")}}catch(error){console.error("‚ùå Erro no processo:",error);this.updateButtonLoading(false);this.showError("Erro de conex√£o. Verifique sua internet e tente novamente.")}}initializeProgressModal(){console.log("üîÑ Inicializando modal de progresso...");setTimeout(()=>{if(window.ProgressModalRPA){this.modalProgress=new window.ProgressModalRPA(this.sessionId);window.progressModal=this.modalProgress;this.modalProgress.startProgressPolling();console.log("‚úÖ Modal de progresso inicializado")}else{console.error("‚ùå ProgressModalRPA n√£o encontrado");console.log("üîç Classes dispon√≠veis:",Object.keys(window).filter(key=>key.includes("Modal")))}},200)}async validateFormData(formData){console.log("üîç [VALIDACAO] validateFormData iniciado com dados:",formData);const validator=new FormValidator;console.log("üîç Validando dados:",formData);console.log("üîç [VALIDACAO] Iniciando valida√ß√µes paralelas...");const telefoneCompleto=formData.telefone||"";const ddd=telefoneCompleto.substring(0,2);const celular=telefoneCompleto.substring(2);console.log("üîç [VALIDACAO] Telefone extra√≠do - DDD:",ddd,"Celular:",celular);const[cpfResult,cepResult,placaResult,celularResult,emailResult]=await Promise.all([validator.validateCPF(formData.cpf),validator.validateCEP(formData.cep),validator.validatePlaca(formData.placa),validator.validateCelular(ddd,celular),validator.validateEmail(formData.email)]);console.log("üìä [VALIDACAO] Resultados das valida√ß√µes:",{cpf:cpfResult,cep:cepResult,placa:placaResult,celular:celularResult,email:emailResult});console.log("üîç [VALIDACAO] Verificando CPF:",cpfResult.ok?"‚úÖ":"‚ùå",cpfResult);console.log("üîç [VALIDACAO] Verificando CEP:",cepResult.ok?"‚úÖ":"‚ùå",cepResult);console.log("üîç [VALIDACAO] Verificando Placa:",placaResult.ok?"‚úÖ":"‚ùå",placaResult);console.log("üîç [VALIDACAO] Verificando Celular:",celularResult.ok?"‚úÖ":"‚ùå",celularResult);console.log("üîç [VALIDACAO] Verificando Email:",emailResult.ok?"‚úÖ":"‚ùå",emailResult);const isValid=cpfResult.ok&&cepResult.ok&&placaResult.ok&&celularResult.ok&&emailResult.ok;console.log("üîç [VALIDACAO] Resultado final isValid:",isValid);if(placaResult.ok&&placaResult.parsed){console.log("üöó Auto-preenchendo dados da placa:",placaResult.parsed);this.setFieldValue("MARCA",placaResult.parsed.marcaTxt);this.setFieldValue("ANO",placaResult.parsed.anoModelo);this.setFieldValue("TIPO-DE-VEICULO",placaResult.parsed.tipoVeiculo)}if(cpfResult.ok&&cpfResult.parsed&&validator.config.VALIDAR_PH3A){console.log("üë§ Auto-preenchendo dados do CPF:",cpfResult.parsed);this.setFieldValue("SEXO",cpfResult.parsed.sexo);this.setFieldValue("DATA-DE-NASCIMENTO",cpfResult.parsed.dataNascimento);this.setFieldValue("ESTADO-CIVIL",cpfResult.parsed.estadoCivil)}const result={isValid:isValid,errors:{cpf:cpfResult,cep:cepResult,placa:placaResult,celular:celularResult,email:emailResult}};console.log("üîç [VALIDACAO] Retornando resultado final:",result);return result}async showValidationAlert(errors){console.log("üö® [ALERT] showValidationAlert chamado com erros:",errors);let errorLines="";if(!errors.cpf.ok){errorLines+="‚Ä¢ CPF inv√°lido\n";console.log("üö® [ALERT] CPF inv√°lido:",errors.cpf)}if(!errors.cep.ok){errorLines+="‚Ä¢ CEP inv√°lido\n";console.log("üö® [ALERT] CEP inv√°lido:",errors.cep)}if(!errors.placa.ok){errorLines+="‚Ä¢ Placa inv√°lida\n";console.log("üö® [ALERT] Placa inv√°lida:",errors.placa)}if(!errors.celular.ok){errorLines+="‚Ä¢ Celular inv√°lido\n";console.log("üö® [ALERT] Celular inv√°lido:",errors.celular)}if(!errors.email.ok){errorLines+="‚Ä¢ E-mail inv√°lido\n";console.log("üö® [ALERT] Email inv√°lido:",errors.email)}console.log("üö® [ALERT] Linhas de erro constru√≠das:",errorLines);console.log("üö® Mostrando SweetAlert de valida√ß√£o:",errorLines);const result=await Swal.fire({icon:"info",title:"Aten√ß√£o!",html:"‚ö†Ô∏è Os campos CPF, CEP, PLACA, CELULAR e E-MAIL corretamente preenchidos s√£o necess√°rios para efetuar o c√°lculo do seguro.\n\n"+"Campos com problema:\n\n"+errorLines+"\n"+"Caso decida prosseguir assim mesmo, um especialista entrar√° em contato para coletar esses dados.",showCancelButton:true,confirmButtonText:"Prosseguir assim mesmo",cancelButtonText:"Corrigir",reverseButtons:true,allowOutsideClick:false,allowEscapeKey:true});console.log("üö® [ALERT] Resultado do SweetAlert:",result);if(result.isConfirmed){console.log("‚úÖ Usu√°rio escolheu prosseguir, redirecionando...");window.location.href="https://www.segurosimediato.com.br/sucesso"}else{console.log("üîß Usu√°rio escolheu corrigir, focando campo com erro...");this.focusFirstErrorField(errors)}}focusFirstErrorField(errors){if(!errors.cpf.ok){const cpfField=document.getElementById("CPF")||document.querySelector('[name="CPF"]');if(cpfField){cpfField.focus();return}}if(!errors.cep.ok){const cepField=document.getElementById("CEP")||document.querySelector('[name="CEP"]');if(cepField){cepField.focus();return}}if(!errors.placa.ok){const placaField=document.getElementById("PLACA")||document.querySelector('[name="PLACA"]');if(placaField){placaField.focus();return}}if(!errors.celular.ok){const celularField=document.getElementById("CELULAR")||document.querySelector('[name="CELULAR"]');if(celularField){celularField.focus();return}}if(!errors.email.ok){const emailField=document.getElementById("email")||document.querySelector('[name="email"]');if(emailField){emailField.focus();return}}}setFieldValue(id,val){const field=document.getElementById(id)||document.querySelector(`[name="${id}"]`);if(field){field.value=val;field.dispatchEvent(new Event("input",{bubbles:true}));field.dispatchEvent(new Event("change",{bubbles:true}));console.log(`‚úÖ Campo ${id} preenchido com: ${val}`)}else{console.warn(`‚ö†Ô∏è Campo ${id} n√£o encontrado`)}}showError(message){const existingModal=document.getElementById("rpaModal");if(existingModal){existingModal.remove()}alert(message);this.updateButtonLoading(false)}updateButtonLoading(isLoading){const submitButton=document.getElementById("submit_button_auto");if(submitButton){if(isLoading){submitButton.textContent="Aguarde...";submitButton.disabled=true}else{submitButton.textContent="CALCULE AGORA!";submitButton.disabled=false}}}ensureFontAwesomeLoaded(){return new Promise(resolve=>{const existingFA=document.querySelector('link[href*="font-awesome"]')||document.querySelector('link[href*="fontawesome"]')||document.querySelector('link[href*="font-awesome"]');if(existingFA){console.log("üé® Font Awesome j√° carregado");setTimeout(()=>{console.log("üé® Font Awesome verificado e pronto");resolve()},100);return}console.log("üé® Carregando Font Awesome...");const fontAwesome=document.createElement("link");fontAwesome.rel="stylesheet";fontAwesome.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css";fontAwesome.crossOrigin="anonymous";fontAwesome.onload=()=>{console.log("üé® Font Awesome carregado com sucesso");setTimeout(()=>{console.log("üé® Font Awesome aplicado e pronto");resolve()},200)};fontAwesome.onerror=()=>{console.warn("‚ö†Ô∏è Erro ao carregar Font Awesome");resolve()};document.head.appendChild(fontAwesome)})}openProgressModal(){console.log("üé≠ Criando modal de progresso...");this.ensureFontAwesomeLoaded();const existingModal=document.getElementById("rpaModal");if(existingModal){existingModal.remove()}const modalHTML=`\n                <div id="rpaModal" class="show">\n                    <button class="modal-close-btn" onclick="document.getElementById('rpaModal').remove()">\n                        <i class="fas fa-times"></i>\n                    </button>\n                    <div class="modal-progress-bar">\n                        <div class="progress-header">\n                            <div class="logo-container">\n                                <img src="https://cdn.prod.website-files.com/59eb807f9d16950001e202af/5f845624fe08f9f0d0573fee_logotipo-imediato-seguros.svg" alt="Imediato Seguros" class="company-logo">\n                            </div>\n                            <h1><i class="fas fa-calculator"></i> Calculadora de Seguro da Imediato Seguros</h1>\n                            <div class="progress-info">\n                                <span class="progress-text" id="progressText">0%</span>\n                                <span class="current-phase" id="currentPhase">Iniciando Multi-C√°lculo...</span>\n                                <span class="sub-phase" id="subPhase"></span>\n                            </div>\n                            <div class="progress-stages">\n                                <span class="stage-info" id="stageInfo">Fase 0 de 16</span>\n                            </div>\n                        </div>\n                        \n                        <div class="progress-bar-wrapper">\n                            <div class="progress-bar-container">\n                                <div class="progress-bar-fill" id="progressBarFill" style="width: 0%"></div>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class="modal-content">\n                        <div class="results-container">\n                            \x3c!-- Div 1: Recomendado --\x3e\n                            <div class="result-card recommended">\n                                <div class="card-header">\n                                    <div class="card-icon">\n                                        <i class="fas fa-star"></i>\n                                    </div>\n                                    <div class="card-title">\n                                        <h3>Recomendado</h3>\n                                    </div>\n                                    <div class="card-value-inline">\n                                        <div class="value" id="recommendedValue">R$ 0,00</div>\n                                    </div>\n                                </div>\n                                <ul class="card-features">\n                                    <li>Forma de Pagamento: <span class="feature-value" id="recommendedFormaPagamento">-</span></li>\n                                    <li>Parcelamento: <span class="feature-value" id="recommendedParcelamento">-</span></li>\n                                    <li>Valor de Mercado: <span class="feature-value" id="recommendedValorMercado">-</span></li>\n                                    <li>Valor da Franquia: <span class="feature-value" id="recommendedValorFranquia">-</span></li>\n                                    <li>Tipo de Franquia: <span class="feature-value" id="recommendedTipoFranquia">-</span></li>\n                                    <li>Cobertura de Assist√™ncia: <span class="feature-value" id="recommendedAssistencia">-</span></li>\n                                    <li>Cobertura de Vidros: <span class="feature-value" id="recommendedVidros">-</span></li>\n                                    <li>Cobertura de Carro Reserva: <span class="feature-value" id="recommendedCarroReserva">-</span></li>\n                                    <li>Cobertura de Danos Materiais: <span class="feature-value" id="recommendedDanosMateriais">-</span></li>\n                                    <li>Cobertura de Danos Corporais: <span class="feature-value" id="recommendedDanosCorporais">-</span></li>\n                                    <li>Cobertura de Danos Morais: <span class="feature-value" id="recommendedDanosMorais">-</span></li>\n                                    <li>Cobertura de Morte e Invalidez Permanente: <span class="feature-value" id="recommendedMorteInvalidez">-</span></li>\n                                </ul>\n                            </div>\n                            \n                            \x3c!-- Div 2: Alternativo --\x3e\n                            <div class="result-card alternative">\n                                <div class="card-header">\n                                    <div class="card-icon">\n                                        <i class="fas fa-shield-alt"></i>\n                                    </div>\n                                    <div class="card-title">\n                                        <h3>Alternativo</h3>\n                                    </div>\n                                    <div class="card-value-inline">\n                                        <div class="value" id="alternativeValue">R$ 0,00</div>\n                                    </div>\n                                </div>\n                                <ul class="card-features">\n                                    <li>Forma de Pagamento: <span class="feature-value" id="alternativeFormaPagamento">-</span></li>\n                                    <li>Parcelamento: <span class="feature-value" id="alternativeParcelamento">-</span></li>\n                                    <li>Valor de Mercado: <span class="feature-value" id="alternativeValorMercado">-</span></li>\n                                    <li>Valor da Franquia: <span class="feature-value" id="alternativeValorFranquia">-</span></li>\n                                    <li>Tipo de Franquia: <span class="feature-value" id="alternativeTipoFranquia">-</span></li>\n                                    <li>Cobertura de Assist√™ncia: <span class="feature-value" id="alternativeAssistencia">-</span></li>\n                                    <li>Cobertura de Vidros: <span class="feature-value" id="alternativeVidros">-</span></li>\n                                    <li>Cobertura de Carro Reserva: <span class="feature-value" id="alternativeCarroReserva">-</span></li>\n                                    <li>Cobertura de Danos Materiais: <span class="feature-value" id="alternativeDanosMateriais">-</span></li>\n                                    <li>Cobertura de Danos Corporais: <span class="feature-value" id="alternativeDanosCorporais">-</span></li>\n                                    <li>Cobertura de Danos Morais: <span class="feature-value" id="alternativeDanosMorais">-</span></li>\n                                    <li>Cobertura de Morte e Invalidez Permanente: <span class="feature-value" id="alternativeMorteInvalidez">-</span></li>\n                                </ul>\n                            </div>\n                        </div>\n                        \n                        \x3c!-- Spinner com Timer Regressivo --\x3e\n                        <div class="spinner-timer-container" id="spinnerTimerContainer" style="display: none;">\n                            <div class="spinner-container">\n                                <div class="sk-circle" id="skCircle">\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                    <div class="sk-child"></div>\n                                </div>\n                                <div class="spinner-center" id="spinnerCenter">03:00</div>\n                            </div>\n                            <div class="timer-message" id="timerMessage" style="display: none;">\n                                ‚è∞ Est√° demorando mais que o normal. Aguardando mais 2 minutos...\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `;document.body.insertAdjacentHTML("beforeend",modalHTML);setTimeout(()=>{const spinnerContainer=document.getElementById("spinnerTimerContainer");if(spinnerContainer){spinnerContainer.style.display="flex";console.log("‚úÖ Spinner timer container exibido")}else{console.warn("‚ö†Ô∏è spinnerTimerContainer n√£o encontrado")}},2e3);console.log("üé≠ Modal HTML criado - aguardando Session ID...")}}window.SpinnerTimer=SpinnerTimer;window.ProgressModalRPA=ProgressModalRPA;window.MainPage=MainPage;const styleSheet=document.createElement("style");styleSheet.textContent=cssStyles;document.head.appendChild(styleSheet);if(!document.querySelector('link[href*="font-awesome"]')&&!document.querySelector('link[href*="fontawesome"]')){const fontAwesome=document.createElement("link");fontAwesome.rel="stylesheet";fontAwesome.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css";fontAwesome.crossOrigin="anonymous";document.head.appendChild(fontAwesome);console.log("üé® Font Awesome carregado")}if(!document.querySelector('script[src*="sweetalert2"]')){const sweetAlertScript=document.createElement("script");sweetAlertScript.src="https://cdn.jsdelivr.net/npm/sweetalert2@11.14.0/dist/sweetalert2.all.min.js";sweetAlertScript.defer=true;document.head.appendChild(sweetAlertScript);const sweetAlertCSS=document.createElement("link");sweetAlertCSS.rel="stylesheet";sweetAlertCSS.href="https://cdn.jsdelivr.net/npm/sweetalert2@11.14.0/dist/sweetalert2.min.css";document.head.appendChild(sweetAlertCSS);console.log("üé® SweetAlert2 v11.14.0 carregado")}const mainPage=new MainPage;console.log("üöÄ Webflow Injection Complete V6.13.0 carregado com sucesso!");console.log("üìã SpinnerTimer integrado com ciclo de vida do RPA");console.log("üìã Valida√ß√£o completa de formul√°rio implementada");console.log('üìã SweetAlert com op√ß√£o "Prosseguir assim mesmo"');console.log("üìã Auto-preenchimento de campos (MARCA/ANO/TIPO)");console.log("üìã Redirecionamento para p√°gina de sucesso em caso de dados inv√°lidos")})();