# Diretivas do Projeto - Imediato Seguros RPA

## üö® REGRAS CR√çTICAS - SEMPRE RESPEITAR

### üö® REGRA CR√çTICA #0: Investiga√ß√£o vs Implementa√ß√£o (VIOLA√á√ÉO MAIS COMUM)
- ‚ö†Ô∏è **VIOLA√á√ÉO MAIS COMUM:** Modificar c√≥digo ap√≥s comandos de investiga√ß√£o
- ‚úÖ **COMANDOS DE INVESTIGA√á√ÉO** ("verifique", "analise", "investigue", "explique", "como funciona") ‚Üí **APENAS investigar e documentar**
- ‚ùå **NUNCA modificar c√≥digo** ap√≥s comandos de investiga√ß√£o sem autoriza√ß√£o expl√≠cita
- ‚úÖ **COMANDOS DE IMPLEMENTA√á√ÉO** ("corrija", "implemente", "fa√ßa", "adicione") ‚Üí Investigar + implementar
- ‚ö†Ô∏è **ANTES DE MODIFICAR QUALQUER ARQUIVO:** Verificar se comando √© de investiga√ß√£o ou implementa√ß√£o
- üö® **CHECKLIST OBRIGAT√ìRIO ANTES DE QUALQUER MODIFICA√á√ÉO:**
  1. [ ] O comando cont√©m palavra de investiga√ß√£o ("verifique", "analise", "investigue")?
  2. [ ] Se SIM ‚Üí **PARAR** - apenas investigar e documentar, N√ÉO modificar c√≥digo
  3. [ ] O comando cont√©m palavra de implementa√ß√£o ("corrija", "implemente", "adicione")?
  4. [ ] Se SIM ‚Üí Continuar com implementa√ß√£o
  5. [ ] Se houver d√∫vida ‚Üí **PERGUNTAR** antes de modificar
- üö® **SE HOUVER D√öVIDA:** Sempre perguntar antes de modificar

### 1. Autoriza√ß√£o Pr√©via para Modifica√ß√µes
- ‚ùå **NUNCA modificar** c√≥digo fora da implementa√ß√£o autorizada de um projeto
- ‚úÖ **SEMPRE perguntar** antes de iniciar um projeto: "Posso iniciar o projeto X agora?"
- ‚úÖ Aguardar autoriza√ß√£o expl√≠cita antes de iniciar o projeto
- ‚úÖ **Dentro de um projeto autorizado:** N√£o √© necess√°rio pedir autoriza√ß√£o para cada arquivo individual
- ‚ö†Ô∏è **Projetos isolados:** Sempre perguntar antes de modificar arquivos fora de projetos autorizados
- üö® **COMPROMISSO ATIVO (14/12/2025):** N√ÉO ALTERAR ambientes Hetzner (DEV e PROD) e Firebase DEV - BLOQUEIO TOTAL (ver `COMPROMISSO_NAO_ALTERAR_AMBIENTES_20251214.md`)
- üö® **CR√çTICO - INTERPRETA√á√ÉO DE COMANDOS:**
  - ‚ö†Ô∏è **"Fa√ßa um projeto"** ou **"Crie um projeto"** = Criar documento do projeto, apresentar ao usu√°rio, e AGUARDAR autoriza√ß√£o para executar
  - ‚ùå **N√ÉO significa:** Criar E executar imediatamente
  - ‚úÖ **Significa:** Criar documento ‚Üí Apresentar ‚Üí Perguntar "Posso iniciar o projeto X agora?" ‚Üí Aguardar autoriza√ß√£o ‚Üí Executar
  - üö® **PROCESSO OBRIGAT√ìRIO para "fa√ßa um projeto":**
    1. Criar documento do projeto em `05-DOCUMENTATION/`
    2. Apresentar projeto ao usu√°rio (resumo das fases, objetivos, arquivos envolvidos)
    3. Perguntar explicitamente: "Posso iniciar o projeto X agora?"
    4. Aguardar autoriza√ß√£o expl√≠cita do usu√°rio
    5. Somente ent√£o executar o projeto
  - ‚ö†Ô∏è **EXCE√á√ÉO:** Se o comando for explicitamente "execute o projeto X" ou "implemente o projeto X", pode executar imediatamente (mas ainda deve apresentar o projeto primeiro se n√£o foi apresentado antes)

### 2. Modifica√ß√£o de Arquivos JavaScript
- ‚ùå **NUNCA modificar** arquivos `.js` diretamente no servidor
- ‚úÖ **SEMPRE modificar** arquivos `.js` localmente em `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/`
- ‚úÖ Fazer deploy via scripts ou comandos autorizados ap√≥s modifica√ß√£o local
- ‚úÖ **OBRIGAT√ìRIO:** Ap√≥s copiar arquivo para servidor, sempre verificar integridade comparando hash (MD5/SHA256)
- ‚úÖ **OBRIGAT√ìRIO:** Comparar hashes ignorando diferen√ßas de mai√∫sculas/min√∫sculas (case-insensitive)
- ‚úÖ **OBRIGAT√ìRIO:** Sempre usar caminho completo do workspace ao copiar arquivos (n√£o usar caminhos relativos que podem falhar)
- üö® **OBRIGAT√ìRIO - CACHE CLOUDFLARE (APENAS HETZNER):** Ap√≥s atualizar arquivo `.js` no servidor Hetzner (n√£o Google Cloud), **SEMPRE avisar** ao usu√°rio sobre a necessidade de limpar o cache do Cloudflare para que as altera√ß√µes sejam refletidas imediatamente
- ‚úÖ **Google Cloud Run/Storage:** N√£o requer limpeza de cache do Cloudflare - altera√ß√µes s√£o refletidas imediatamente ap√≥s deploy

### 3. Modifica√ß√£o de Arquivos PHP
- ‚ùå **NUNCA modificar** arquivos `.php` diretamente no servidor
- ‚úÖ **SEMPRE modificar** arquivos `.php` localmente em `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/` primeiro
- ‚úÖ **SEMPRE criar backup** do arquivo original antes de modificar
- ‚úÖ Fazer deploy via scripts ou comandos autorizados ap√≥s modifica√ß√£o local e backup
- ‚úÖ **OBRIGAT√ìRIO:** Ap√≥s copiar arquivo para servidor, sempre verificar integridade comparando hash (MD5/SHA256)
- ‚úÖ **OBRIGAT√ìRIO:** Comparar hashes ignorando diferen√ßas de mai√∫sculas/min√∫sculas (case-insensitive)
- ‚úÖ **OBRIGAT√ìRIO:** Sempre usar caminho completo do workspace ao copiar arquivos (n√£o usar caminhos relativos que podem falhar)
- üö® **OBRIGAT√ìRIO - CACHE CLOUDFLARE (APENAS HETZNER):** Ap√≥s atualizar arquivo `.php` no servidor Hetzner (n√£o Google Cloud), **SEMPRE avisar** ao usu√°rio sobre a necessidade de limpar o cache do Cloudflare para que as altera√ß√µes sejam refletidas imediatamente
- ‚úÖ **Google Cloud Run:** N√£o requer limpeza de cache do Cloudflare - altera√ß√µes s√£o refletidas imediatamente ap√≥s deploy
- ‚ùå **NUNCA modificar** configura√ß√µes do Nginx e PHP quando est√£o funcionando
- ‚ö†Ô∏è Sempre confirmar antes de modificar configura√ß√µes de infraestrutura

### 4. Servidores com Acesso SSH
- ‚ùå **NUNCA modificar ou criar** arquivos diretamente em servidores com acesso SSH
- ‚úÖ **SEMPRE criar** arquivos localmente no Windows primeiro
- ‚úÖ **SEMPRE criar backup** antes de qualquer modifica√ß√£o
- ‚úÖ **SEMPRE copiar** arquivos do Windows para o servidor (via scp, scripts de deploy, etc.)
- ‚ùå **SEM EXCE√á√ïES** - Nunca modificar diretamente no servidor, mesmo quando autorizado
- üö® **COMPROMISSO ATIVO (14/12/2025):** BLOQUEIO TOTAL para Hetzner DEV e PROD - N√ÉO copiar, N√ÉO modificar, N√ÉO fazer deploy (ver `COMPROMISSO_NAO_ALTERAR_AMBIENTES_20251214.md`)

### 4.1. Valida√ß√£o de Comandos SSH Antes de Apresentar (OBRIGAT√ìRIA) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **NUNCA apresentar comandos SSH ao usu√°rio sem validar sintaxe antes**
- ‚úÖ **PROCESSO OBRIGAT√ìRIO antes de apresentar QUALQUER comando SSH:**
  1. **FASE 1: Valida√ß√£o Mental de Sintaxe**
     - ‚úÖ Verificar se aspas est√£o balanceadas (simples e duplas)
     - ‚úÖ Verificar se caracteres especiais est√£o escapados corretamente
     - ‚úÖ Verificar se vari√°veis est√£o sendo interpoladas corretamente
     - ‚úÖ Verificar se pipes (`|`), redirecionamentos (`>`, `>>`), e operadores (`&&`, `||`) est√£o corretos
     - ‚úÖ Verificar se caminhos de arquivos est√£o corretos
     - ‚úÖ Verificar se comandos bash est√£o corretos (n√£o misturar sintaxe PowerShell com bash)
     - ‚ùå **N√ÉO apresentar** se houver d√∫vida sobre sintaxe
  2. **FASE 2: Valida√ß√£o de Contexto**
     - ‚úÖ Verificar se o comando √© apropriado para o ambiente (DEV vs PROD)
     - ‚úÖ Verificar se caminhos de arquivos existem no servidor
     - ‚úÖ Verificar se permiss√µes necess√°rias est√£o corretas
     - ‚úÖ Verificar se vari√°veis de servidor est√£o corretas (IP, dom√≠nio, caminho)
     - ‚ùå **N√ÉO apresentar** se contexto estiver incorreto
  3. **FASE 3: Simplifica√ß√£o quando Necess√°rio**
     - ‚úÖ Se comando √© complexo, quebrar em comandos menores e mais simples
     - ‚úÖ Preferir comandos testados e conhecidos
     - ‚úÖ Apresentar um comando por vez quando poss√≠vel
     - ‚úÖ Se necess√°rio, criar script tempor√°rio para testar sintaxe antes de apresentar
     - ‚ùå **N√ÉO apresentar** comandos complexos sem valida√ß√£o
  4. **FASE 4: Valida√ß√£o de Comandos Bash dentro de SSH**
     - ‚úÖ Se comando SSH cont√©m comandos bash, validar sintaxe bash separadamente
     - ‚úÖ Verificar se loops, condicionais e fun√ß√µes bash est√£o corretos
     - ‚úÖ Verificar se vari√°veis bash (`$var`, `${var}`) est√£o corretas
     - ‚úÖ Verificar se comandos bash s√£o compat√≠veis com a vers√£o do bash no servidor
     - ‚ùå **N√ÉO apresentar** se sintaxe bash estiver incorreta
  5. **FASE 5: Teste Mental de Execu√ß√£o**
     - ‚úÖ Simular mentalmente a execu√ß√£o do comando
     - ‚úÖ Verificar se o comando produzir√° o resultado esperado
     - ‚úÖ Verificar se h√° riscos de erro ou efeitos colaterais
     - ‚úÖ Verificar se o comando √© idempotente (pode ser executado m√∫ltiplas vezes sem problemas)
     - ‚ùå **N√ÉO apresentar** se houver risco de erro ou efeito colateral inesperado
- ‚úÖ **Checklist Obrigat√≥rio ANTES de Apresentar Comando SSH:**
  - [ ] Aspas balanceadas e escapadas corretamente?
  - [ ] Caracteres especiais escapados corretamente?
  - [ ] Vari√°veis interpoladas corretamente?
  - [ ] Caminhos de arquivos corretos?
  - [ ] Comandos bash v√°lidos (n√£o misturados com PowerShell)?
  - [ ] Contexto correto (ambiente, servidor, permiss√µes)?
  - [ ] Comando testado mentalmente?
  - [ ] Comando √© seguro para executar?
- ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
  - ‚ùå **NUNCA apresentar comandos SSH** sem validar sintaxe primeiro
  - ‚ùå **NUNCA apresentar comandos** com sintaxe duvidosa
  - ‚ùå **NUNCA apresentar comandos** que misturam sintaxe PowerShell com bash
  - ‚ùå **NUNCA apresentar comandos** complexos sem quebrar em partes menores
  - ‚ùå **NUNCA apresentar comandos** sem testar mentalmente primeiro
- ‚úÖ **OBRIGA√á√ïES:**
  - ‚úÖ **SEMPRE validar sintaxe** antes de apresentar comando SSH
  - ‚úÖ **SEMPRE simplificar** comandos complexos quando poss√≠vel
  - ‚úÖ **SEMPRE testar mentalmente** a execu√ß√£o do comando
  - ‚úÖ **SEMPRE verificar** contexto e ambiente antes de apresentar
  - ‚úÖ **SEMPRE preferir** comandos simples e testados
- üö® **SE HOUVER D√öVIDA SOBRE SINTAXE:**
  - ‚úÖ Criar script tempor√°rio para testar sintaxe
  - ‚úÖ Consultar documenta√ß√£o ou exemplos conhecidos
  - ‚úÖ Quebrar comando em partes menores
  - ‚úÖ **N√ÉO apresentar** at√© ter certeza da sintaxe correta
- üìã **Exemplos de Comandos V√°lidos:**
  - ‚úÖ `ssh root@servidor "comando simples"`
  - ‚úÖ `ssh root@servidor 'comando com aspas simples'`
  - ‚úÖ `ssh root@servidor "comando com \$variavel"`
  - ‚ùå `ssh root@servidor "comando com "aspas n√£o balanceadas""`
  - ‚ùå `ssh root@servidor "comando com $variavel sem escape"`
  - ‚ùå `ssh root@servidor "comando | Select-String"` (mistura bash com PowerShell)

### 5. Arquivos de Configura√ß√£o de Servidor
- ‚ùå **NUNCA criar** arquivos de configura√ß√£o (Nginx, PHP-FPM, systemd, etc.) diretamente no servidor
- ‚úÖ **SEMPRE criar** arquivos de configura√ß√£o localmente primeiro
- ‚úÖ **SEMPRE criar** em diret√≥rio espec√≠fico: `WEBFLOW-SEGUROSIMEDIATO/06-SERVER-CONFIG/`
- ‚úÖ **SEMPRE copiar** para o servidor via SCP ap√≥s cria√ß√£o local
- üìÅ **Diret√≥rio de configura√ß√£o:** `WEBFLOW-SEGUROSIMEDIATO/06-SERVER-CONFIG/`
  - Arquivos Nginx: `nginx_*.conf`
  - Arquivos PHP-FPM: `php-fpm_*.conf`
  - Arquivos systemd: `*.service`
  - Scripts de configura√ß√£o: `*.sh`
- ‚ùå **NUNCA usar** heredoc ou comandos inline complexos para criar arquivos no servidor
- ‚úÖ **SEMPRE usar** arquivo local + SCP para transferir configura√ß√µes
- üö® **OBRIGAT√ìRIO - SINCRONIZA√á√ÉO PHP-FPM (CR√çTICO):**
  - üö® **REGRA CR√çTICA:** **NUNCA confiar nos arquivos PHP-FPM do diret√≥rio Windows** - eles podem estar desatualizados
  - ‚úÖ **PROCESSO OBRIGAT√ìRIO ao modificar arquivo PHP-FPM:**
    1. **FASE 1: Copiar do Servidor para Windows (OBRIGAT√ìRIA)**
       - ‚úÖ **ANTES de qualquer modifica√ß√£o:** Copiar arquivo PHP-FPM do servidor para Windows
       - ‚úÖ **Ambiente DEV:** `scp root@65.108.156.14:/etc/php/8.3/fpm/pool.d/www.conf "WEBFLOW-SEGUROSIMEDIATO\06-SERVER-CONFIG\php-fpm_www_conf_DEV.txt"`
       - ‚úÖ **Ambiente UAT:** `scp root@65.108.156.14:/etc/php/8.3/fpm/pool.d/uat.conf "WEBFLOW-SEGUROSIMEDIATO\06-SERVER-CONFIG\php-fpm_uat_conf.txt"`
       - ‚úÖ **Ambiente PROD:** `scp root@157.180.36.223:/etc/php/8.3/fpm/pool.d/www.conf "WEBFLOW-SEGUROSIMEDIATO\06-SERVER-CONFIG\php-fpm_www_conf_PROD.txt"` (quando procedimento for definido)
       - ‚úÖ **OBJETIVO:** Garantir que arquivo local est√° sincronizado com servidor antes de modificar
       - ‚úÖ **CR√çTICO:** Isso evita perder vari√°veis que existem no servidor mas n√£o est√£o no arquivo local
    2. **FASE 2: Modificar no Windows**
       - ‚úÖ Modificar arquivo local sincronizado
       - ‚úÖ Adicionar/remover vari√°veis conforme necess√°rio
    3. **FASE 3: Copiar de Volta para Servidor**
       - ‚úÖ Copiar arquivo modificado do Windows para servidor
       - ‚úÖ Validar sintaxe antes de recarregar PHP-FPM
       - ‚úÖ Recarregar PHP-FPM ap√≥s valida√ß√£o
  - ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
    - ‚ùå **NUNCA modificar** arquivo PHP-FPM local sem copiar do servidor primeiro
    - ‚ùå **NUNCA assumir** que arquivo local est√° sincronizado com servidor
    - ‚ùå **NUNCA pular** a fase de sincroniza√ß√£o (copiar do servidor para Windows)
  - ‚úÖ **OBRIGA√á√ïES:**
    - ‚úÖ **SEMPRE copiar** arquivo do servidor para Windows no in√≠cio do projeto
    - ‚úÖ **SEMPRE verificar** que arquivo foi copiado corretamente antes de modificar
    - ‚úÖ **SEMPRE documentar** que sincroniza√ß√£o foi realizada
  - üö® **MOTIVO:** Arquivos PHP-FPM no Windows podem estar desatualizados e n√£o conter vari√°veis que existem no servidor, causando perda de configura√ß√µes durante deploy
- üö® **OBRIGAT√ìRIO - VERIFICA√á√ÉO ANTES DE MODIFICAR:**
  - ‚úÖ **ANTES de modificar** qualquer arquivo de configura√ß√£o local que ser√° copiado para o servidor
  - ‚úÖ **SEMPRE verificar** se o arquivo local √© id√™ntico ao arquivo no servidor
  - ‚úÖ **SEMPRE comparar hash** (SHA256, case-insensitive) antes de modificar arquivo local
  - ‚úÖ **Se arquivos forem diferentes:** Baixar arquivo do servidor primeiro, depois modificar
  - ‚úÖ **Se arquivos forem id√™nticos:** Pode modificar arquivo local com seguran√ßa
  - ‚úÖ **Processo obrigat√≥rio:**
    1. Baixar arquivo do servidor para local (se n√£o existir localmente)
    2. Comparar hash do arquivo local com hash do arquivo no servidor
    3. Se diferentes ‚Üí Atualizar arquivo local com vers√£o do servidor primeiro
    4. Se id√™nticos ‚Üí Modificar arquivo local
    5. Copiar arquivo modificado para servidor
    6. Verificar hash ap√≥s c√≥pia

### 6. Organiza√ß√£o de Arquivos no Diret√≥rio DEV
- ‚ùå **NUNCA criar** arquivos novos diretamente no raiz de `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/`
- ‚úÖ **SEMPRE criar** novos arquivos nos diret√≥rios apropriados:
  - üìÅ **Documenta√ß√£o:** `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/`
  - üìÅ **Backups:** `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/backups/` ou `WEBFLOW-SEGUROSIMEDIATO/04-BACKUPS/`
  - üìÅ **Testes:** `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/TMP/` (arquivos tempor√°rios de teste)
  - üìÅ **Configura√ß√£o de Servidor:** `WEBFLOW-SEGUROSIMEDIATO/06-SERVER-CONFIG/`
  - üìÅ **Scripts de Deploy:** `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/` (apenas scripts essenciais de deploy)
- ‚úÖ **Arquivos do projeto** (JavaScript, PHP principais) devem permanecer no raiz de `02-DEVELOPMENT/`
- ‚úÖ **Arquivos auxiliares** (testes, documenta√ß√£o, backups) devem estar em subdiret√≥rios apropriados

### 7. Comandos de Parada
- üõë Quando o usu√°rio disser "Pare", "N√£o pode fazer isso" ou similar, **PARAR IMEDIATAMENTE**
- üõë N√£o continuar com a a√ß√£o que foi rejeitada
- üõë Aguardar novas instru√ß√µes antes de prosseguir

### 8. Consulta de Documenta√ß√£o para Erros de Ambiente (OBRIGAT√ìRIA)
- üö® **REGRA CR√çTICA:** Antes de tentar corrigir QUALQUER erro relacionado a ambiente, servidor, Linux, Nginx, PHP, MySQL/MariaDB, SQL, ou infraestrutura, **SEMPRE consultar a documenta√ß√£o primeiro**
- ‚úÖ **PROCESSO OBRIGAT√ìRIO ao detectar erro de ambiente:**
  1. **PARAR** imediatamente qualquer tentativa de corre√ß√£o
  2. **CONSULTAR documenta√ß√£o oficial:**
     - Documenta√ß√£o do projeto em `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/`
     - Documenta√ß√£o oficial do componente (Nginx, PHP, MySQL/MariaDB, Linux)
     - Blogs e tutoriais relevantes sobre o erro espec√≠fico
     - Hist√≥rico de problemas similares no projeto
  3. **IDENTIFICAR causa raiz** baseado na documenta√ß√£o consultada
  4. **PROPOR solu√ß√£o** fundamentada na documenta√ß√£o antes de implementar
  5. **SOMENTE AP√ìS** consultar documenta√ß√£o, prosseguir com corre√ß√£o

### 9. Busca de Logs em Produ√ß√£o (OBRIGAT√ìRIA)
- üö® **REGRA CR√çTICA:** **SEMPRE usar o guia completo de busca de logs** antes de criar novos scripts ou comandos de busca
- ‚úÖ **PROCESSO OBRIGAT√ìRIO ao buscar logs:**
  1. **CONSULTAR guia de refer√™ncia primeiro:**
     - üìÅ **Guia Principal:** `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/GUIA_COMPLETO_BUSCA_LOGS_PRODUCAO.md`
     - ‚úÖ **SEMPRE usar scripts prontos** do guia (n√£o criar novos)
     - ‚úÖ **SEMPRE limitar resultados** com `tail -N` (ex: `tail -20`)
     - ‚úÖ **SEMPRE usar padr√µes espec√≠ficos** no `grep` (n√£o buscar tudo)
  2. **Se script n√£o existir no guia:**
     - ‚úÖ Verificar se h√° script similar que pode ser adaptado
     - ‚úÖ Se necess√°rio criar novo, **SEMPRE adicionar ao guia** ap√≥s testar
     - ‚úÖ **NUNCA criar scripts tempor√°rios** sem documentar
  3. **Verificar m√∫ltiplos locais:**
     - ‚úÖ Nginx error_log: `/var/log/nginx/dev_error.log`
     - ‚úÖ PHP-FPM log: `/var/log/php8.3-fpm.log`
     - ‚úÖ Banco de dados: `rpa_logs_prod.application_logs`
     - ‚úÖ Arquivos da aplica√ß√£o: `/var/log/webflow-segurosimediato/*.txt`
  4. **Seguir checklist do guia:**
     - [ ] Identificar tipo de log necess√°rio
     - [ ] Escolher script apropriado do guia
     - [ ] Limitar resultados com `tail -N`
     - [ ] Usar padr√µes espec√≠ficos no `grep`
- ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
  - ‚ùå **NUNCA buscar** em todos os arquivos sem filtro (`grep -r`)
  - ‚ùå **NUNCA buscar** sem limitar resultados (`tail -N`)
  - ‚ùå **NUNCA criar** scripts novos sem consultar guia primeiro
  - ‚ùå **NUNCA usar** padr√µes muito amplos no `grep`
- ‚úÖ **OBRIGA√á√ïES:**
  - ‚úÖ **SEMPRE consultar** `GUIA_COMPLETO_BUSCA_LOGS_PRODUCAO.md` antes de buscar logs
  - ‚úÖ **SEMPRE usar** scripts prontos do guia quando dispon√≠veis
  - ‚úÖ **SEMPRE limitar** resultados para evitar retrabalho
  - ‚úÖ **SEMPRE documentar** novos scripts no guia ap√≥s criar
- üìã **Documenta√ß√£o relacionada:**
  - üìÅ **Guia de Busca de Logs:** `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/GUIA_COMPLETO_BUSCA_LOGS_PRODUCAO.md`
  - üìÅ **An√°lise Logs cURL:** `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/ANALISE_LOGS_CURL_NGINX_PHP_20251125.md`
  - üìÅ **An√°lise Graylog:** `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/ANALISE_GRAYLOG_PARA_LOGS_20251125.md`

### 10. Valida√ß√£o Obrigat√≥ria de Componentes Google Cloud/Firebase (OBRIGAT√ìRIA) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **SEMPRE verificar se componentes foram criados ou atualizados corretamente** ap√≥s qualquer opera√ß√£o no Google Cloud ou Firebase
- ‚úÖ **PROCESSO OBRIGAT√ìRIO ap√≥s criar ou atualizar componentes:**
  1. **FASE 1: Valida√ß√£o Imediata Ap√≥s Cria√ß√£o/Atualiza√ß√£o**
     - ‚úÖ **AP√ìS criar banco de dados:** Verificar se banco existe usando `gcloud sql databases list`
     - ‚úÖ **AP√ìS criar tabela:** Verificar se tabela existe usando `gcloud sql connect` ou query SQL
     - ‚úÖ **AP√ìS criar usu√°rio SQL:** Verificar se usu√°rio existe usando `gcloud sql users list`
     - ‚úÖ **AP√ìS fazer deploy Cloud Run:** Verificar se servi√ßo foi atualizado usando `gcloud run services describe`
     - ‚úÖ **AP√ìS atualizar vari√°veis de ambiente:** Verificar se vari√°veis foram aplicadas usando `gcloud run services describe`
     - ‚úÖ **AP√ìS criar/atualizar Secret Manager:** Verificar se secret existe usando `gcloud secrets versions access`
     - ‚úÖ **AP√ìS criar Cloud Storage bucket:** Verificar se bucket existe usando `gsutil ls`
     - ‚úÖ **AP√ìS fazer upload arquivo:** Verificar se arquivo existe usando `gsutil ls` ou `gsutil stat`
     - ‚úÖ **AP√ìS criar Cloud Function:** Verificar se fun√ß√£o existe usando `gcloud functions describe`
     - ‚úÖ **AP√ìS criar Cloud SQL instance:** Verificar se inst√¢ncia existe usando `gcloud sql instances describe`
  2. **FASE 2: Valida√ß√£o Funcional**
     - ‚úÖ **AP√ìS deploy Cloud Run:** Testar endpoint para verificar se est√° funcionando
     - ‚úÖ **AP√ìS criar banco/tabela:** Testar conex√£o e query simples para verificar se est√° acess√≠vel
     - ‚úÖ **AP√ìS atualizar vari√°veis:** Testar funcionalidade que depende das vari√°veis
     - ‚úÖ **AP√ìS criar usu√°rio SQL:** Testar conex√£o com credenciais do usu√°rio
  3. **FASE 3: Valida√ß√£o de Estado**
     - ‚úÖ Verificar status do componente (RUNNABLE, ACTIVE, READY, etc.)
     - ‚úÖ Verificar logs para erros relacionados ao componente
     - ‚úÖ Verificar m√©tricas b√°sicas (se dispon√≠veis)
- ‚úÖ **Checklist Obrigat√≥rio AP√ìS Criar/Atualizar Componente:**
  - [ ] Componente foi criado/atualizado? (verificar exist√™ncia)
  - [ ] Componente est√° no estado esperado? (verificar status)
  - [ ] Componente est√° funcionando? (testar funcionalidade)
  - [ ] Logs mostram erros? (verificar logs)
  - [ ] Vari√°veis/configura√ß√µes foram aplicadas? (verificar configura√ß√£o)
- ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
  - ‚ùå **NUNCA assumir** que componente foi criado/atualizado sem verificar
  - ‚ùå **NUNCA prosseguir** para pr√≥xima etapa sem validar componente anterior
  - ‚ùå **NUNCA ignorar** erros de cria√ß√£o/atualiza√ß√£o sem investigar
- ‚úÖ **OBRIGA√á√ïES:**
  - ‚úÖ **SEMPRE verificar** exist√™ncia do componente ap√≥s criar/atualizar
  - ‚úÖ **SEMPRE testar** funcionalidade ap√≥s criar/atualizar
  - ‚úÖ **SEMPRE verificar** logs para erros relacionados
  - ‚úÖ **SEMPRE documentar** resultado da valida√ß√£o
- üö® **SE VALIDA√á√ÉO FALHAR:**
  - ‚úÖ Investigar causa raiz do problema
  - ‚úÖ Corrigir problema antes de prosseguir
  - ‚úÖ Repetir valida√ß√£o ap√≥s corre√ß√£o
  - ‚úÖ **N√ÉO prosseguir** at√© valida√ß√£o ser bem-sucedida
- üìã **Comandos de Valida√ß√£o Comuns:**
  - **Bancos de dados:** `gcloud sql databases list --instance=INSTANCE_NAME --project=PROJECT_ID`
  - **Tabelas:** `gcloud sql connect INSTANCE_NAME --database=DATABASE_NAME --project=PROJECT_ID` ‚Üí `SHOW TABLES;`
  - **Cloud Run:** `gcloud run services describe SERVICE_NAME --region=REGION --project=PROJECT_ID`
  - **Vari√°veis de ambiente:** `gcloud run services describe SERVICE_NAME --format="value(spec.template.spec.containers[0].env)" --region=REGION --project=PROJECT_ID`
  - **Secrets:** `gcloud secrets versions access latest --secret=SECRET_NAME --project=PROJECT_ID`
  - **Cloud Storage:** `gsutil ls gs://BUCKET_NAME/` ou `gsutil stat gs://BUCKET_NAME/FILE_PATH`
  - **Cloud Functions:** `gcloud functions describe FUNCTION_NAME --region=REGION --project=PROJECT_ID`
  - **Cloud SQL Instances:** `gcloud sql instances describe INSTANCE_NAME --project=PROJECT_ID`
- üìÅ **Aplic√°vel a:** Google Cloud (Cloud Run, Cloud SQL, Cloud Storage, Secret Manager, Cloud Functions), Firebase (Realtime Database, Cloud Functions, Hosting)

### 11. Ambiente Padr√£o de Trabalho
- ‚úÖ **PADR√ÉO:** Sempre trabalhar apenas no ambiente de **DESENVOLVIMENTO** (DEV)
- ‚úÖ **Diret√≥rio padr√£o:** `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/`
- ‚úÖ **Servidor padr√£o:** `dev.bssegurosimediato.com.br` (IP: 65.108.156.14)
- ‚úÖ **Deploy padr√£o:** Apenas para `/var/www/html/dev/root/` no servidor DEV
- üö® **COMPROMISSO ATIVO (14/12/2025):** N√ÉO ALTERAR ambientes Hetzner (DEV e PROD) e Firebase DEV (ver `COMPROMISSO_NAO_ALTERAR_AMBIENTES_20251214.md`)
- üö® **PRODU√á√ÉO - PROCEDIMENTO N√ÉO DEFINIDO:**
  - ‚ö†Ô∏è **STATUS:** O procedimento para atualizar o ambiente de produ√ß√£o **ser√° definido posteriormente**
  - üö® **VALIDA√á√ÉO AUTOM√ÅTICA OBRIGAT√ìRIA:**
    - ‚úÖ **ANTES de executar QUALQUER comando:** Verificar arquivo `.env.production_access`
    - ‚úÖ **Se `PRODUCTION_ACCESS=DISABLED`:** BLOQUEAR automaticamente e emitir alerta
    - ‚úÖ **Se `PRODUCTION_ACCESS=ENABLED`:** Permitir ap√≥s valida√ß√£o adicional (verificar autoriza√ß√£o, backup, etc.)
    - ‚úÖ **Se `PRODUCTION_ACCESS=READ_ONLY`:** Permitir apenas comandos de leitura/investiga√ß√£o
  - üö® **DETEC√á√ÉO AUTOM√ÅTICA OBRIGAT√ìRIA:**
    - ‚úÖ **Padr√µes a detectar:** IP `157.180.36.223`, dom√≠nio `prod.bssegurosimediato.com.br`, caminho `/var/www/html/prod/root`
    - ‚úÖ **Comandos a bloquear:** `ssh root@157.180.36.223`, `scp ... root@157.180.36.223:...`, qualquer comando com `/var/www/html/prod/root/`
    - ‚úÖ **A√ß√£o quando detectado:** BLOQUEAR automaticamente se `PRODUCTION_ACCESS=DISABLED`, emitir alerta obrigat√≥rio
  - üö® **ALERTA OBRIGAT√ìRIO:** Sempre emitir alerta quando detectar tentativa de acesso ao servidor de produ√ß√£o
  - üö® **ALERTA OBRIGAT√ìRIO:** Sempre emitir alerta quando detectar refer√™ncias a IP `157.180.36.223` ou dom√≠nio `prod.bssegurosimediato.com.br`
  - üö® **ALERTA OBRIGAT√ìRIO:** Sempre emitir alerta quando detectar comandos SSH para servidor de produ√ß√£o
  - üö® **ALERTA OBRIGAT√ìRIO:** Sempre emitir alerta quando detectar modifica√ß√µes em `/var/www/html/prod/root/`
  - ‚ùå **BLOQUEIO:** N√£o executar comandos ou modifica√ß√µes em produ√ß√£o at√© que procedimento seja oficialmente definido E arquivo `.env.production_access` tenha `PRODUCTION_ACCESS=ENABLED`
  - ‚ö†Ô∏è **EXCE√á√ÉO FUTURA:** Ap√≥s defini√ß√£o oficial do procedimento, modificar produ√ß√£o apenas quando houver instru√ß√£o **EXPL√çCITA** do usu√°rio E `PRODUCTION_ACCESS=ENABLED`
- ‚úÖ **Documenta√ß√£o:** Projetos devem especificar claramente se s√£o DEV ou PROD
- ‚úÖ **Backups:** Backups devem ser criados localmente em `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/backups/` ou `WEBFLOW-SEGUROSIMEDIATO/04-BACKUPS/`

---

## üìã DIRETIVAS DE IMPLEMENTA√á√ÉO

### Uso de Emojis em Projetos (OBRIGAT√ìRIA) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **NUNCA usar emojis em scripts, c√≥digo ou documenta√ß√£o t√©cnica**, exceto em casos espec√≠ficos de UI/UX
- ‚úÖ **PROIBI√á√ïES ABSOLUTAS:**
  - ‚ùå **NUNCA usar emojis** em scripts PowerShell, Bash, ou qualquer linguagem de programa√ß√£o
  - ‚ùå **NUNCA usar emojis** em arquivos de c√≥digo (`.js`, `.php`, `.py`, etc.)
  - ‚ùå **NUNCA usar emojis** em mensagens de log ou console.log
  - ‚ùå **NUNCA usar emojis** em arquivos de configura√ß√£o
  - ‚ùå **NUNCA usar emojis** em documenta√ß√£o t√©cnica (exceto t√≠tulos de se√ß√µes quando apropriado)
- ‚úÖ **EXCE√á√ïES PERMITIDAS:**
  - ‚úÖ **UI/UX:** Emojis podem ser usados em interfaces de usu√°rio (HTML, componentes React/Vue, etc.)
  - ‚úÖ **Mensagens ao Usu√°rio Final:** Emojis podem ser usados em mensagens exibidas ao usu√°rio final
  - ‚úÖ **Documenta√ß√£o de Alto N√≠vel:** Emojis podem ser usados em t√≠tulos de se√ß√µes de documenta√ß√£o para melhorar legibilidade
- ‚úÖ **SUBSTITUI√á√ïES RECOMENDADAS:**
  - ‚úÖ Use `[OK]`, `[ERRO]`, `[AVISO]`, `[INFO]`, `[SUCESSO]` em vez de emojis
  - ‚úÖ Use `[PROCESSANDO]`, `[PULAR]`, `[VALIDANDO]` para indicar status
  - ‚úÖ Use texto descritivo em vez de s√≠mbolos visuais
- ‚úÖ **PROCESSO OBRIGAT√ìRIO:**
  1. **Ao criar script:** N√£o incluir emojis desde o in√≠cio
  2. **Ao revisar c√≥digo:** Remover qualquer emoji encontrado
  3. **Ao validar sintaxe:** Verificar que n√£o h√° emojis causando problemas de encoding
  4. **Ao fazer deploy:** Garantir que logs n√£o contenham emojis
- ‚úÖ **Benef√≠cios:**
  - Evita problemas de encoding em diferentes sistemas
  - Compatibilidade com todos os terminais e consoles
  - Logs mais f√°ceis de processar e analisar
  - C√≥digo mais profissional e leg√≠vel
  - Evita erros de parsing em scripts
- ‚ùå **NUNCA usar emojis** em scripts que ser√£o executados em servidores
- ‚ùå **NUNCA usar emojis** em mensagens de log ou debug
- ‚úÖ **SEMPRE usar texto simples** para indicar status e mensagens
- üìÅ **Aplic√°vel a:** Scripts PowerShell, Bash, c√≥digo JavaScript/PHP, logs, mensagens de console

### Vari√°veis de Ambiente
- ‚úÖ **SEMPRE usar** vari√°veis de ambiente do Docker (`APP_BASE_DIR`, `APP_BASE_URL`, etc.)
- ‚úÖ **SEMPRE usar** vari√°veis de sistema diretamente via `$_ENV` no PHP
- ‚ùå **N√ÉO criar** sistemas de configura√ß√£o complexos (`window.APP_CONFIG`, objetos de configura√ß√£o)
- ‚úÖ Usar vari√°veis globais simples quando necess√°rio (`window.APP_BASE_URL`, `window.APP_ENVIRONMENT`)

### Nomenclatura de Arquivos entre Ambientes (CR√çTICO) üö®
- üö® **REGRA CR√çTICA:** **Os arquivos em desenvolvimento, UAT e produ√ß√£o t√™m ABSOLUTAMENTE TODOS os mesmos nomes**
- ‚úÖ **NUNCA assumir** que existem vers√µes diferentes de arquivos com sufixos `_dev.php`, `_prod.php`, `_uat.php`
- ‚úÖ **NUNCA criar** arquivos com sufixos de ambiente (ex: `add_webflow_octa_dev.php`, `add_flyingdonkeys_prod.php`)
- ‚úÖ **O que muda entre ambientes:** Apenas as **vari√°veis de ambiente** (dom√≠nio, URLs, credenciais, etc.)
- ‚úÖ **Exemplos corretos:**
  - ‚úÖ `add_webflow_octa.php` (mesmo nome em DEV, UAT e PROD)
  - ‚úÖ `add_flyingdonkeys.php` (mesmo nome em DEV, UAT e PROD)
  - ‚úÖ `config.php` (mesmo nome em DEV, UAT e PROD)
- ‚ùå **Exemplos INCORRETOS (NUNCA criar):**
  - ‚ùå `add_webflow_octa_dev.php` (N√ÉO existe)
  - ‚ùå `add_webflow_octa_prod.php` (N√ÉO existe)
  - ‚ùå `add_flyingdonkeys_dev.php` (N√ÉO existe)
- ‚úÖ **Como diferenciar ambientes:**
  - ‚úÖ Usar vari√°veis de ambiente: `APP_BASE_URL`, `APP_ENVIRONMENT`, etc.
  - ‚úÖ Usar dom√≠nios diferentes: `dev.bssegurosimediato.com.br` vs `prod.bssegurosimediato.com.br`
  - ‚úÖ Usar configura√ß√µes diferentes via vari√°veis de ambiente do Docker/PHP
- üö® **OBRIGAT√ìRIO:** Sempre verificar se est√° usando o nome correto do arquivo (sem sufixos de ambiente) antes de configurar endpoints, URLs ou refer√™ncias
- üö® **OBRIGAT√ìRIO:** Ao configurar Cloud Functions, APIs externas ou qualquer refer√™ncia a arquivos PHP, usar apenas o nome base do arquivo (ex: `add_webflow_octa.php`, n√£o `add_webflow_octa_dev.php`)

### Estrutura de Arquivos
- ‚úÖ Arquivos `.js` e `.php` devem estar no mesmo diret√≥rio raiz
- ‚úÖ Acess√≠veis via `https://dev.bssegurosimediato.com.br/` (dev) ou `https://bssegurosimediato.com.br/` (prod)
- ‚úÖ Modifica√ß√µes sempre come√ßam localmente em `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/`
- ‚úÖ Arquivos de configura√ß√£o de servidor em `WEBFLOW-SEGUROSIMEDIATO/06-SERVER-CONFIG/`

### Fluxo de Trabalho
1. **Criar backup** do arquivo original (se existir)
2. **Modificar localmente** ‚Üí `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/`
3. **Testar localmente** (quando poss√≠vel)
4. **Deploy para servidor DEV** via scripts ou comandos autorizados (`dev.bssegurosimediato.com.br`)
   - ‚úÖ **OBRIGAT√ìRIO:** Usar caminho completo do workspace ao copiar arquivos
   - ‚úÖ **OBRIGAT√ìRIO:** Ap√≥s copiar, sempre comparar hash (MD5/SHA256) do arquivo origem e destino
   - ‚úÖ **OBRIGAT√ìRIO:** Comparar hashes ignorando diferen√ßas de mai√∫sculas/min√∫sculas (case-insensitive)
   - ‚úÖ **OBRIGAT√ìRIO:** Confirmar que hash coincide antes de considerar deploy conclu√≠do
5. **Verificar funcionamento** no servidor DEV
6. üö® **OBRIGAT√ìRIO - CACHE CLOUDFLARE (APENAS HETZNER):** Ap√≥s atualizar arquivos `.js` ou `.php` no servidor Hetzner (n√£o Google Cloud), **SEMPRE avisar** ao usu√°rio sobre a necessidade de limpar o cache do Cloudflare para que as altera√ß√µes sejam refletidas imediatamente
7. ‚úÖ **Google Cloud Run/Storage:** N√£o requer limpeza de cache do Cloudflare - altera√ß√µes s√£o refletidas imediatamente ap√≥s deploy
8. **OBRIGAT√ìRIO: Realizar auditoria p√≥s-implementa√ß√£o** (ver se√ß√£o "Auditoria P√≥s-Implementa√ß√£o")
9. üö® **OBRIGAT√ìRIO: Atualizar documento de tracking** (`ALTERACOES_DESDE_ULTIMA_REPLICACAO_PROD_YYYYMMDD.md`) ap√≥s deploy em DEV (ver se√ß√£o "Tracking de Altera√ß√µes para Replica√ß√£o em Produ√ß√£o")

### Valida√ß√£o Obrigat√≥ria de Modifica√ß√µes Antes de Incluir em Projetos de Deploy (OBRIGAT√ìRIA) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **NUNCA incluir arquivos em projetos de deploy sem verificar se foram realmente modificados pelo projeto atual**
- ‚úÖ **PROCESSO OBRIGAT√ìRIO antes de incluir QUALQUER arquivo em projeto de deploy:**
  1. **FASE 1: Identificar Arquivos Modificados pelo Projeto Atual**
     - ‚úÖ Listar TODOS os arquivos que foram modificados durante a implementa√ß√£o do projeto atual
     - ‚úÖ Verificar hist√≥rico de modifica√ß√µes (git, timestamps, ou documenta√ß√£o do projeto)
     - ‚úÖ Identificar apenas arquivos que foram REALMENTE alterados (n√£o apenas mencionados)
     - ‚ùå **N√ÉO incluir** arquivos que n√£o foram modificados pelo projeto atual
  2. **FASE 2: Comparar Hash SHA256 DEV vs PROD**
     - ‚úÖ Para cada arquivo candidato a deploy, calcular hash SHA256 da vers√£o DEV
     - ‚úÖ Calcular hash SHA256 da vers√£o PROD atual (se existir)
     - ‚úÖ Comparar hashes (case-insensitive)
     - ‚úÖ **Se hashes s√£o id√™nticos:** ‚ùå **N√ÉO incluir** no projeto de deploy
     - ‚úÖ **Se hashes s√£o diferentes:** ‚úÖ Incluir no projeto de deploy (ap√≥s valida√ß√£o adicional)
     - ‚ùå **NUNCA incluir** arquivos id√™nticos (mesmo hash) em projetos de deploy
  3. **FASE 3: Validar Necessidade de Deploy**
     - ‚úÖ Para cada arquivo com hash diferente, verificar:
       - Arquivo foi modificado pelo projeto atual?
       - Modifica√ß√µes s√£o relevantes para produ√ß√£o?
       - Arquivo precisa ser atualizado em produ√ß√£o?
     - ‚úÖ **Se arquivo n√£o foi modificado pelo projeto atual:** ‚ùå **N√ÉO incluir** no deploy
     - ‚úÖ **Se arquivo √© id√™ntico entre DEV e PROD:** ‚ùå **N√ÉO incluir** no deploy
     - ‚úÖ **Se arquivo foi modificado E √© diferente:** ‚úÖ Incluir no deploy
  4. **FASE 4: Documentar Justificativa**
     - ‚úÖ Para cada arquivo inclu√≠do no projeto de deploy, documentar:
       - Por que o arquivo foi modificado?
       - Qual foi a altera√ß√£o realizada?
       - Hash SHA256 DEV vs PROD (se diferentes)
       - Justificativa para incluir no deploy
     - ‚úÖ Para cada arquivo exclu√≠do do projeto de deploy, documentar:
       - Por que o arquivo foi exclu√≠do?
       - Hash SHA256 DEV vs PROD (se id√™nticos)
       - Justificativa para n√£o incluir no deploy
  5. **FASE 5: Questionar Arquivos N√£o Modificados**
     - ‚úÖ Se arquivo foi mencionado em projetos anteriores mas n√£o foi modificado pelo projeto atual:
       - ‚ùå **N√ÉO incluir automaticamente**
       - ‚úÖ **PERGUNTAR ao usu√°rio** se arquivo precisa ser inclu√≠do (mesmo sem modifica√ß√µes)
       - ‚úÖ **Documentar resposta** do usu√°rio
     - ‚úÖ Se arquivo √© id√™ntico entre DEV e PROD:
       - ‚ùå **N√ÉO incluir** sem justificativa expl√≠cita do usu√°rio
       - ‚úÖ **PERGUNTAR ao usu√°rio** se h√° raz√£o espec√≠fica para incluir arquivo id√™ntico
- ‚úÖ **Checklist Obrigat√≥rio ANTES de Incluir Arquivo em Projeto de Deploy:**
  - [ ] Arquivo foi modificado pelo projeto atual?
  - [ ] Hash SHA256 DEV vs PROD foi comparado?
  - [ ] Arquivos s√£o diferentes (hash diferente)?
  - [ ] Justificativa para incluir no deploy foi documentada?
  - [ ] Se arquivo n√£o foi modificado, usu√°rio foi questionado?
- ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
  - ‚ùå **NUNCA incluir** arquivos em projetos de deploy sem verificar modifica√ß√µes reais
  - ‚ùå **NUNCA incluir** arquivos id√™nticos (mesmo hash) sem justificativa expl√≠cita do usu√°rio
  - ‚ùå **NUNCA assumir** que arquivos mencionados em projetos anteriores precisam ser inclu√≠dos
  - ‚ùå **NUNCA incluir** arquivos apenas porque s√£o "relacionados" ao projeto (deve ser "modificados pelo projeto")
- ‚úÖ **OBRIGA√á√ïES:**
  - ‚úÖ **SEMPRE verificar** quais arquivos foram realmente modificados pelo projeto atual
  - ‚úÖ **SEMPRE comparar** hash SHA256 DEV vs PROD antes de incluir no deploy
  - ‚úÖ **SEMPRE questionar** necessidade de incluir arquivos n√£o modificados
  - ‚úÖ **SEMPRE documentar** justificativa para incluir ou excluir cada arquivo
- üö® **SE ARQUIVO N√ÉO FOI MODIFICADO:**
  - ‚úÖ Verificar hash SHA256 DEV vs PROD
  - ‚úÖ Se id√™nticos, **N√ÉO incluir** no projeto de deploy
  - ‚úÖ Se diferentes, questionar usu√°rio sobre necessidade de incluir
  - ‚úÖ Documentar decis√£o (incluir ou excluir) e justificativa
- üìã **Exemplo de Processo Correto:**
  1. Projeto atual modificou: `ProfessionalLogger.php` (adicionou fun√ß√£o cURL)
  2. Verificar hash: DEV = `ABC123...`, PROD = `XYZ789...` (diferentes) ‚úÖ
  3. Arquivo foi modificado pelo projeto atual ‚úÖ
  4. Incluir no projeto de deploy ‚úÖ
  5. Verificar `FooterCodeSiteDefinitivoCompleto.js`: DEV = `DEF456...`, PROD = `DEF456...` (id√™nticos) ‚ùå
  6. Arquivo N√ÉO foi modificado pelo projeto atual ‚ùå
  7. **N√ÉO incluir** no projeto de deploy ‚ùå
  8. Documentar: "Exclu√≠do - arquivo id√™ntico entre DEV e PROD, n√£o foi modificado pelo projeto atual"
- üö® **PRODU√á√ÉO:** 
  - ‚ö†Ô∏è **ALERTA:** Procedimento para produ√ß√£o ser√° definido posteriormente
  - üö® **BLOQUEAR** qualquer deploy ou modifica√ß√£o em produ√ß√£o at√© procedimento oficial
  - ‚ö†Ô∏è **EMITIR ALERTA** se detectar tentativa de acesso ou modifica√ß√£o em produ√ß√£o

### Fluxo de Trabalho para Corre√ß√£o de Erros em Arquivos .js e .php (OBRIGAT√ìRIO)
- üö® **REGRA CR√çTICA:** Quando erros s√£o detectados em arquivos `.js` ou `.php`, **SEMPRE seguir este processo sequencial obrigat√≥rio**
- ‚úÖ **PROCESSO OBRIGAT√ìRIO para corre√ß√£o de erros:**
  1. **FASE 1: Atualizar em Desenvolvimento (Local)**
     - ‚úÖ Modificar arquivo em `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/`
     - ‚úÖ Criar backup do arquivo original antes de modificar
     - ‚úÖ Aplicar corre√ß√£o no arquivo de desenvolvimento
  2. **FASE 2: Copiar de Desenvolvimento para Servidor de Desenvolvimento**
     - ‚úÖ Copiar arquivo de `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/` para servidor DEV
     - ‚úÖ Servidor DEV: `dev.bssegurosimediato.com.br` (IP: 65.108.156.14)
     - ‚úÖ Caminho no servidor: `/var/www/html/dev/root/`
     - ‚úÖ **OBRIGAT√ìRIO:** Verificar hash (SHA256) ap√≥s c√≥pia
     - ‚úÖ **OBRIGAT√ìRIO:** Usar caminho completo do workspace ao copiar
  3. **FASE 3: Testar em Desenvolvimento**
     - ‚úÖ Testar funcionalidade corrigida no ambiente DEV
     - ‚úÖ Verificar logs do servidor DEV
     - ‚úÖ Confirmar que corre√ß√£o resolve o problema
     - ‚úÖ **N√ÉO prosseguir para produ√ß√£o se teste em DEV falhar**
     - ‚ö†Ô∏è **Testes que requerem interven√ß√£o manual:**
       - ‚úÖ Se teste requer envio real de email, submiss√£o de formul√°rio, ou outra a√ß√£o manual
       - ‚úÖ Marcar fase como "PENDENTE TESTE MANUAL" no TODO
       - ‚úÖ Documentar claramente no relat√≥rio que teste requer interven√ß√£o manual
       - ‚úÖ **Pode prosseguir para FASE 4** se integridade do arquivo foi verificada (hash, sintaxe)
       - ‚úÖ **MAS** deve documentar que teste funcional completo ser√° realizado posteriormente
       - ‚ö†Ô∏è **Se teste pode ser automatizado:** Deve ser realizado antes de prosseguir
  4. **FASE 4: Atualizar de Desenvolvimento para Produ√ß√£o (Local)**
     - ‚úÖ **SOMENTE AP√ìS** confirma√ß√£o de sucesso em DEV
     - ‚úÖ Copiar arquivo corrigido de `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/` para `WEBFLOW-SEGUROSIMEDIATO/03-PRODUCTION/`
     - ‚úÖ Verificar que arquivo foi copiado corretamente
     - ‚úÖ Comparar hash dos arquivos DEV e PROD (devem ser id√™nticos ap√≥s c√≥pia)
  5. **FASE 5: Copiar de Produ√ß√£o para Servidor de Produ√ß√£o**
     - ‚úÖ **SOMENTE AP√ìS** arquivo estar em `WEBFLOW-SEGUROSIMEDIATO/03-PRODUCTION/`
     - ‚úÖ Copiar arquivo de `WEBFLOW-SEGUROSIMEDIATO/03-PRODUCTION/` para servidor PROD
     - ‚úÖ Servidor PROD: `prod.bssegurosimediato.com.br` (IP: 157.180.36.223)
     - ‚úÖ Caminho no servidor: `/var/www/html/prod/root/`
     - ‚úÖ **OBRIGAT√ìRIO:** Verificar hash (SHA256) ap√≥s c√≥pia
     - ‚úÖ **OBRIGAT√ìRIO:** Usar caminho completo do workspace ao copiar
  6. **FASE 6: Verifica√ß√£o Final**
     - ‚úÖ Testar funcionalidade corrigida no ambiente PROD
     - ‚úÖ Verificar logs do servidor PROD
     - ‚úÖ Confirmar que corre√ß√£o est√° funcionando em produ√ß√£o
     - üö® **OBRIGAT√ìRIO - CACHE CLOUDFLARE (APENAS HETZNER):** Avisar ao usu√°rio sobre necessidade de limpar cache do Cloudflare apenas para servidores Hetzner (n√£o Google Cloud)
     - ‚úÖ **Google Cloud Run/Storage:** N√£o requer aviso sobre Cloudflare - altera√ß√µes s√£o imediatas ap√≥s deploy
- ‚ùå **NUNCA pular etapas** do processo sequencial
- ‚ùå **NUNCA copiar diretamente** de DEV para servidor PROD sem passar por PROD local
- ‚ùå **NUNCA atualizar produ√ß√£o** sem testar em desenvolvimento primeiro
- ‚úÖ **SEMPRE documentar** cada fase do processo de corre√ß√£o
- ‚úÖ **SEMPRE criar backup** antes de qualquer modifica√ß√£o
- ‚ö†Ô∏è **Se teste em DEV falhar:** Parar processo, corrigir em DEV, e repetir a partir da FASE 1

### Fluxo de Trabalho para Arquivos de Configura√ß√£o de Servidor
1. **üö® CR√çTICO - Para PHP-FPM:** Copiar arquivo do servidor para Windows primeiro (sincroniza√ß√£o obrigat√≥ria)
   - ‚úÖ **DEV:** `scp root@65.108.156.14:/etc/php/8.3/fpm/pool.d/www.conf "WEBFLOW-SEGUROSIMEDIATO\06-SERVER-CONFIG\php-fpm_www_conf_DEV.txt"`
   - ‚úÖ **UAT:** `scp root@65.108.156.14:/etc/php/8.3/fpm/pool.d/uat.conf "WEBFLOW-SEGUROSIMEDIATO\06-SERVER-CONFIG\php-fpm_uat_conf.txt"`
   - ‚úÖ **PROD:** `scp root@157.180.36.223:/etc/php/8.3/fpm/pool.d/www.conf "WEBFLOW-SEGUROSIMEDIATO\06-SERVER-CONFIG\php-fpm_www_conf_PROD.txt"` (quando procedimento for definido)
2. **Modificar arquivo localmente** ‚Üí `WEBFLOW-SEGUROSIMEDIATO/06-SERVER-CONFIG/`
3. **Verificar sintaxe** (quando poss√≠vel: `nginx -t`, `php-fpm -t`, etc.)
4. **Copiar para servidor** via SCP: `scp arquivo.conf root@servidor:/caminho/destino/`
5. **Aplicar configura√ß√£o** no servidor (reload/restart do servi√ßo)
6. **Verificar funcionamento** no servidor

### Valida√ß√£o de Scripts PowerShell Antes de Execu√ß√£o (OBRIGAT√ìRIO) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **NUNCA executar scripts PowerShell no servidor sem valida√ß√£o pr√©via completa**
- ‚úÖ **PROCESSO OBRIGAT√ìRIO antes de executar QUALQUER script PowerShell que acessa servidor:**
  1. **FASE 1: Valida√ß√£o de Sintaxe PowerShell**
     - ‚úÖ Validar sintaxe PowerShell usando `[System.Management.Automation.PSParser]::Tokenize`
     - ‚úÖ Verificar se script carrega sem erros (sem executar)
     - ‚úÖ Verificar se todas as fun√ß√µes est√£o definidas corretamente
     - ‚úÖ Verificar se vari√°veis est√£o definidas corretamente
     - ‚ùå **N√ÉO prosseguir** se houver erros de sintaxe
  2. **FASE 2: Valida√ß√£o em Modo DryRun**
     - ‚úÖ Executar script com par√¢metro `-DryRun` primeiro
     - ‚úÖ Verificar se script suporta modo DryRun
     - ‚úÖ Validar que script n√£o executa a√ß√µes reais em DryRun
     - ‚úÖ Verificar logs gerados em DryRun
     - ‚úÖ Validar que comandos SSH que seriam executados est√£o corretos
     - ‚ùå **N√ÉO prosseguir** se DryRun falhar ou mostrar problemas
  3. **FASE 3: Valida√ß√£o do Script Bash Gerado**
     - ‚úÖ Se script gera script bash para executar no servidor:
       - ‚úÖ Validar sintaxe bash do script gerado (antes de enviar)
       - ‚úÖ Verificar se comandos bash est√£o corretos
       - ‚úÖ Verificar se vari√°veis est√£o sendo interpoladas corretamente
       - ‚úÖ Verificar se caracteres especiais est√£o escapados corretamente
       - ‚úÖ Validar que script bash n√£o cont√©m erros de sintaxe
     - ‚ùå **N√ÉO enviar script bash para servidor** se houver erros de sintaxe
  4. **FASE 4: Valida√ß√£o de Comandos SSH**
     - ‚úÖ Verificar se comandos SSH est√£o corretos
     - ‚úÖ Verificar se caminhos de arquivos est√£o corretos
     - ‚úÖ Verificar se vari√°veis de servidor est√£o corretas (DEV vs PROD)
     - ‚úÖ Verificar se permiss√µes necess√°rias est√£o corretas
     - ‚ùå **N√ÉO executar** se comandos SSH estiverem incorretos
  5. **FASE 5: Valida√ß√£o de Integridade**
     - ‚úÖ Verificar se fun√ß√µes cr√≠ticas est√£o presentes (`Write-Log`, `Invoke-SafeSSHScript`, etc.)
     - ‚úÖ Verificar se tratamento de erros est√° implementado (`try/catch`)
     - ‚úÖ Verificar se valida√ß√µes de hash est√£o implementadas
     - ‚úÖ Verificar se valida√ß√µes de sintaxe est√£o implementadas
     - ‚ùå **N√ÉO executar** se valida√ß√µes cr√≠ticas estiverem faltando
- ‚úÖ **Checklist Obrigat√≥rio ANTES de Executar Script no Servidor:**
  - [ ] Sintaxe PowerShell validada sem erros?
  - [ ] Script executado em modo DryRun com sucesso?
  - [ ] Script bash gerado validado (se aplic√°vel)?
  - [ ] Comandos SSH verificados e corretos?
  - [ ] Fun√ß√µes cr√≠ticas presentes e funcionando?
  - [ ] Tratamento de erros implementado?
  - [ ] Valida√ß√µes de integridade implementadas?
  - [ ] Logs de execu√ß√£o ser√£o gerados?
- ‚ùå **NUNCA executar script no servidor** sem completar TODAS as fases de valida√ß√£o
- ‚ùå **NUNCA executar script** se valida√ß√£o falhar em qualquer fase
- ‚úÖ **SEMPRE executar em DryRun primeiro** antes de execu√ß√£o real
- ‚úÖ **SEMPRE validar script bash gerado** antes de enviar para servidor
- ‚úÖ **SEMPRE documentar** resultados das valida√ß√µes antes de executar
- üö® **SE VALIDA√á√ÉO FALHAR:** Corrigir script, repetir valida√ß√£o completa, e SOMENTE ent√£o executar
- üìÅ **Scripts devem estar em:** `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/scripts/`
- üìã **Documenta√ß√£o de valida√ß√£o:** Registrar resultados em log ou documento de valida√ß√£o

### Auditoria P√≥s-Implementa√ß√£o (OBRIGAT√ìRIA)
- ‚úÖ **SEMPRE realizar auditoria** ao final da implementa√ß√£o de qualquer projeto
- ‚úÖ **Framework de Auditoria:** Seguir metodologia definida em `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/AUDITORIA_PROJETOS_BOAS_PRATICAS.md`
  - üìã **Documento de Refer√™ncia:** `AUDITORIA_PROJETOS_BOAS_PRATICAS.md` (vers√£o 1.1.0)
  - ‚úÖ **Metodologia:** Baseada em PMI, ISO 21500, PRINCE2, Agile/Scrum, CMMI
  - ‚úÖ **Crit√©rios de Avalia√ß√£o:** Seguir todos os crit√©rios definidos no documento
  - üö® **CR√çTICO:** Verificar se existe se√ß√£o espec√≠fica para especifica√ß√µes do usu√°rio no documento do projeto (Se√ß√£o 2.3)
  - ‚úÖ **Checklist:** Seguir checklist completo definido no documento de auditoria
- ‚úÖ **Auditoria de C√≥digo:** Verificar todos os arquivos alterados em busca de:
  - Falhas de sintaxe (erros de digita√ß√£o, par√™nteses n√£o fechados, etc.)
  - Inconsist√™ncias l√≥gicas (vari√°veis n√£o definidas, fun√ß√µes n√£o chamadas, etc.)
  - Problemas de seguran√ßa (exposi√ß√£o de credenciais, valida√ß√£o de entrada, etc.)
  - Viola√ß√µes de padr√µes de c√≥digo (nomenclatura, estrutura, etc.)
  - Depend√™ncias quebradas (includes, requires, imports, etc.)
- ‚úÖ **Auditoria de Funcionalidade:** Comparar c√≥digo alterado com backup original para garantir:
  - Nenhuma funcionalidade n√£o prevista foi removida ou alterada
  - Todas as funcionalidades previstas foram implementadas corretamente
  - Nenhuma regra de neg√≥cio foi quebrada
  - Nenhuma integra√ß√£o foi afetada negativamente
- ‚úÖ **Verifica√ß√£o de Especifica√ß√µes do Usu√°rio (CR√çTICO):**
  - ‚úÖ Verificar se existe se√ß√£o espec√≠fica para especifica√ß√µes do usu√°rio no documento do projeto
  - ‚úÖ Verificar se especifica√ß√µes est√£o claramente documentadas
  - ‚úÖ Verificar se requisitos est√£o expl√≠citos e mensur√°veis
  - ‚úÖ Verificar se expectativas do usu√°rio est√£o alinhadas com escopo do projeto
  - ‚úÖ Verificar se crit√©rios de aceita√ß√£o do usu√°rio est√£o definidos
  - üìã **Refer√™ncia:** Ver se√ß√£o 2.3 de `AUDITORIA_PROJETOS_BOAS_PRATICAS.md` para checklist completo
- ‚úÖ **Documentar auditoria:** Criar relat√≥rio de auditoria formal em `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/`
  - Listar todos os arquivos auditados
  - Documentar problemas encontrados e corre√ß√µes aplicadas
  - Confirmar que nenhuma funcionalidade foi prejudicada
  - Registrar aprova√ß√£o da auditoria
  - üö® **OBRIGAT√ìRIO:** Criar documento espec√≠fico de auditoria (ex: `AUDITORIA_PROJETO_X.md`)
  - ‚ö†Ô∏è **N√ÉO basta** apenas verificar - deve ser documentado formalmente
  - ‚úÖ **Seguir template:** Usar estrutura definida em `AUDITORIA_PROJETOS_BOAS_PRATICAS.md`
- ‚úÖ **Corrigir problemas encontrados** antes de considerar o projeto conclu√≠do
- ‚ö†Ô∏è **N√ÉO considerar projeto conclu√≠do** sem auditoria completa e documentada

### Tracking de Altera√ß√µes para Replica√ß√£o em Produ√ß√£o (OBRIGAT√ìRIO)
- üö® **REGRA CR√çTICA:** Sempre que houver altera√ß√µes no ambiente de desenvolvimento (DEV), **SEMPRE atualizar** o documento de tracking de altera√ß√µes para facilitar a replica√ß√£o em produ√ß√£o
- ‚úÖ **PROCESSO OBRIGAT√ìRIO ao fazer altera√ß√µes em DEV:**
  1. **Identificar tipo de altera√ß√£o:**
     - C√≥digo PHP/JavaScript modificado
     - Configura√ß√µes PHP-FPM alteradas
     - Banco de dados modificado
     - Vari√°veis de ambiente adicionadas/modificadas
     - Projetos implementados
  2. **Atualizar documento de tracking:**
     - üìÅ **Documento Principal:** `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/ALTERACOES_DESDE_ULTIMA_REPLICACAO_PROD_YYYYMMDD.md`
     - ‚úÖ **SEMPRE atualizar** ap√≥s qualquer altera√ß√£o em DEV que precise ser replicada em PROD
     - ‚úÖ Registrar data, hora, tipo de altera√ß√£o, arquivos afetados
     - ‚úÖ Documentar configura√ß√µes alteradas (vari√°veis de ambiente, PHP-FPM, etc.)
     - ‚úÖ Registrar altera√ß√µes no banco de dados (se aplic√°vel)
     - ‚úÖ Atualizar checklist de replica√ß√£o para PROD
  3. **Categorias de altera√ß√µes a registrar:**
     - **C√≥digo PHP:** Listar arquivos modificados e resumo das altera√ß√µes
     - **C√≥digo JavaScript:** Listar arquivos modificados e resumo das altera√ß√µes
     - **Configura√ß√µes PHP-FPM:** Listar vari√°veis adicionadas/modificadas
     - **Banco de Dados:** Registrar scripts SQL executados e tabelas afetadas
     - **Projetos:** Referenciar documentos de projeto relacionados
  4. **Quando atualizar:**
     - ‚úÖ **AP√ìS deploy** de arquivos para servidor DEV
     - ‚úÖ **AP√ìS altera√ß√£o** de configura√ß√µes PHP-FPM em DEV
     - ‚úÖ **AP√ìS execu√ß√£o** de scripts SQL no banco DEV
     - ‚úÖ **AP√ìS conclus√£o** de projetos implementados em DEV
     - ‚úÖ **ANTES de replicar** em PROD (documento deve estar atualizado)
  5. **Estrutura do documento:**
     - Manter se√ß√µes por categoria (C√≥digo PHP, C√≥digo JavaScript, Configura√ß√µes, Banco de Dados, Projetos)
     - Incluir checklist de replica√ß√£o para PROD
     - Manter resumo executivo atualizado
     - Registrar prioridades (Cr√≠tico, Alto, M√©dio)
  6. **Documenta√ß√£o relacionada:**
     - Atualizar `HISTORICO_REPLICACAO_PRODUCAO.md` quando replica√ß√£o for realizada
     - Atualizar `TRACKING_ALTERACOES_BANCO_DADOS.md` para altera√ß√µes no banco
     - Referenciar documentos de projeto quando aplic√°vel
- ‚ùå **NUNCA fazer altera√ß√µes em DEV** sem atualizar o documento de tracking
- ‚úÖ **SEMPRE manter** o documento atualizado para facilitar replica√ß√£o em PROD
- üö® **OBRIGAT√ìRIO:** O documento deve estar sempre atualizado antes de qualquer replica√ß√£o para PROD
- üìã **Template do documento:** Usar estrutura definida em `ALTERACOES_DESDE_ULTIMA_REPLICACAO_PROD_20251121.md`

### Valida√ß√£o de Scripts Antes de Cria√ß√£o/Modifica√ß√£o (OBRIGAT√ìRIO) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **SEMPRE validar scripts PowerShell ANTES de criar ou modificar**
- ‚úÖ **PROCESSO OBRIGAT√ìRIO ao criar/modificar scripts PowerShell:**
  1. **Criar script localmente** em `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/scripts/`
  2. **Validar sintaxe PowerShell** antes de salvar:
     ```powershell
     $null = [System.Management.Automation.PSParser]::Tokenize((Get-Content -Raw $ScriptPath), [ref]$null)
     ```
  3. **Testar carregamento** do script (sem executar):
     ```powershell
     $scriptContent = Get-Content -Raw $ScriptPath
     $null = [System.Management.Automation.PowerShell]::Create().AddScript($scriptContent).Invoke()
     ```
  4. **Verificar fun√ß√µes cr√≠ticas** est√£o presentes
  5. **Verificar tratamento de erros** est√° implementado
  6. **SOMENTE ap√≥s valida√ß√£o completa** considerar script pronto
- ‚ùå **NUNCA criar script** sem validar sintaxe primeiro
- ‚ùå **NUNCA modificar script** sem validar sintaxe ap√≥s modifica√ß√£o
- ‚úÖ **SEMPRE validar** antes de considerar script completo

### Corre√ß√£o e Atualiza√ß√£o de Scripts de Deploy (OBRIGAT√ìRIO) ‚≠ê **CR√çTICO**
- üö® **REGRA CR√çTICA #1:** Se um script de deploy falhar e uma corre√ß√£o for aplicada diretamente no servidor, **OBRIGAT√ìRIO atualizar o script** com a mesma corre√ß√£o antes da pr√≥xima execu√ß√£o
- ‚úÖ **PROCESSO OBRIGAT√ìRIO quando script falha:**
  1. **Documentar erro imediatamente:**
     - Qual script falhou?
     - Qual foi o erro exato?
     - Em que etapa falhou?
  2. **Aplicar corre√ß√£o no servidor** (se necess√°rio para resolver problema imediato)
  3. **PARAR e atualizar script OBRIGATORIAMENTE:**
     - Abrir script que falhou
     - Aplicar exatamente a mesma corre√ß√£o que funcionou no servidor
     - Adicionar coment√°rios explicando a corre√ß√£o
     - Atualizar vers√£o do script
  4. **Validar script corrigido:**
     - Testar script corrigido antes de pr√≥xima execu√ß√£o
     - Verificar que funciona corretamente
  5. **Documentar corre√ß√£o:**
     - Registrar em `CORRECOES_SCRIPTS_DEPLOY.md`
     - Incluir: Data, Script, Erro, Corre√ß√£o aplicada, Vers√£o antes/depois
     - Commitar script corrigido no Git
- ‚ùå **NUNCA:** Corrigir no servidor sem atualizar script
- ‚ùå **NUNCA:** Usar script novamente sem validar corre√ß√£o
- ‚úÖ **SEMPRE:** Atualizar script imediatamente ap√≥s corre√ß√£o no servidor
- ‚úÖ **SEMPRE:** Testar script corrigido antes de pr√≥xima execu√ß√£o
- ‚úÖ **SEMPRE:** Registrar corre√ß√£o em `CORRECOES_SCRIPTS_DEPLOY.md`
- ‚úÖ **SEMPRE:** Commitar script corrigido no Git
- üìÅ **Documenta√ß√£o:** `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/PROCESSO_CORRECAO_SCRIPTS_DEPLOY.md`
- üìÅ **Registro de Corre√ß√µes:** `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/CORRECOES_SCRIPTS_DEPLOY.md`

---

## üí¨ DIRETIVAS DE COMUNICA√á√ÉO

### Clareza e Objetividade
- Seja direto e objetivo nas respostas
- Evite verbosidade desnecess√°ria
- V√° direto ao ponto quando poss√≠vel

### Implementa√ß√£o vs Sugest√£o
- ‚úÖ **Implementar** mudan√ßas quando solicitado explicitamente, n√£o apenas sugerir
- ‚úÖ Usar as ferramentas dispon√≠veis para fazer as altera√ß√µes
- ‚ö†Ô∏è **CR√çTICO - DISTIN√á√ÉO OBRIGAT√ìRIA:** Distinguir entre comandos de investiga√ß√£o e comandos de implementa√ß√£o:
  - **Comandos de investiga√ß√£o** ("verifique", "analise", "investigue", "explique", "como funciona"): **APENAS investigar e documentar - NUNCA modificar c√≥digo**
  - **Comandos de implementa√ß√£o** ("corrija", "implemente", "fa√ßa", "execute", "adicione", "modifique"): Investigar + implementar
- ‚ö†Ô∏è **REGRA ABSOLUTA:** Se n√£o tiver certeza se deve implementar ou apenas investigar, **SEMPRE perguntar antes de implementar**
- üö® **CHECKLIST OBRIGAT√ìRIO ANTES DE MODIFICAR C√ìDIGO:**
  1. O usu√°rio pediu explicitamente para modificar/implementar/corrigir?
  2. Se o comando foi "verifique", "analise", "investigue" ‚Üí **PARAR** - apenas investigar
  3. Se o comando foi "corrija", "implemente", "fa√ßa" ‚Üí **CONTINUAR** - implementar
  4. Se houver d√∫vida ‚Üí **PERGUNTAR** antes de modificar

### Investiga√ß√£o Proativa
- ‚úÖ Consultar documenta√ß√£o e arquivos relevantes antes de responder
- ‚úÖ Buscar informa√ß√µes no c√≥digo antes de perguntar ao usu√°rio
- ‚úÖ Tentar resolver problemas sozinho quando poss√≠vel
- ‚ö†Ô∏è Se n√£o encontrar informa√ß√£o, informar claramente
- üö® **ESPECIALMENTE para erros de ambiente:** Sempre consultar documenta√ß√£o oficial e do projeto ANTES de tentar corrigir
- üö® **PROIBI√á√ÉO ABSOLUTA - "Erro Silencioso":**
  - ‚ùå **NUNCA citar "erro silencioso"** como causa poss√≠vel de problemas
  - ‚ùå **NUNCA usar** termos como "erro sendo capturado silenciosamente", "erro silenciado", "exce√ß√£o silenciosa", ou similares
  - ‚úÖ **SEMPRE investigar** causas concretas e verific√°veis (c√≥digo n√£o deployado, vari√°veis n√£o configuradas, condi√ß√µes l√≥gicas, etc.)
  - ‚úÖ **SEMPRE buscar** evid√™ncias reais antes de sugerir causas
  - ‚úÖ **Se n√£o encontrar causa concreta:** Informar claramente que n√£o foi poss√≠vel identificar a causa, mas N√ÉO sugerir "erro silencioso"
- üö® **COMPROMISSO OBRIGAT√ìRIO - An√°lises Baseadas em Evid√™ncias (CR√çTICO):**
  - üö® **REGRA CR√çTICA:** **NUNCA fazer an√°lises baseadas em especula√ß√µes ou suposi√ß√µes sem evid√™ncias concretas**
  - ‚úÖ **PROCESSO OBRIGAT√ìRIO ao analisar problemas:**
    1. **FASE 1: Testar Primeiro (OBRIGAT√ìRIA)**
       - ‚úÖ **SEMPRE testar** APIs, endpoints, ou funcionalidades antes de analisar
       - ‚úÖ **SEMPRE verificar** status real (200, 502, timeout, etc.) antes de concluir
       - ‚úÖ **SEMPRE executar** comandos de teste antes de especular sobre causas
       - ‚ùå **NUNCA assumir** que algo est√° funcionando ou n√£o funcionando sem testar
    2. **FASE 2: Coletar Evid√™ncias Concretas (OBRIGAT√ìRIA)**
       - ‚úÖ **SEMPRE buscar** evid√™ncias reais (logs, respostas HTTP, erros concretos)
       - ‚úÖ **SEMPRE verificar** hist√≥rico e documenta√ß√£o antes de assumir mudan√ßas
       - ‚úÖ **SEMPRE confirmar** fatos antes de apresentar como causa
       - ‚ùå **NUNCA especular** sobre mudan√ßas hist√≥ricas sem evid√™ncias
       - ‚ùå **NUNCA assumir** que algo mudou sem verificar primeiro
    3. **FASE 3: Analisar Baseado em Evid√™ncias (OBRIGAT√ìRIA)**
       - ‚úÖ **SEMPRE basear** an√°lises em evid√™ncias coletadas
       - ‚úÖ **SEMPRE distinguir** entre fatos confirmados e hip√≥teses
       - ‚úÖ **SEMPRE indicar** quando algo √© hip√≥tese vs fato confirmado
       - ‚ùå **NUNCA apresentar** especula√ß√µes como fatos
       - ‚ùå **NUNCA assumir** causas sem evid√™ncias que as suportem
    4. **FASE 4: Reconhecer Limita√ß√µes (OBRIGAT√ìRIA)**
       - ‚úÖ **SEMPRE reconhecer** quando n√£o tenho certeza
       - ‚úÖ **SEMPRE indicar** quando an√°lise √© baseada em hip√≥teses
       - ‚úÖ **SEMPRE sugerir** testes adicionais quando necess√°rio
       - ‚ùå **NUNCA apresentar** conclus√µes definitivas sem evid√™ncias suficientes
  - ‚úÖ **Checklist Obrigat√≥rio ANTES de Apresentar An√°lise:**
    - [ ] Testei a funcionalidade/API/endpoint antes de analisar?
    - [ ] Tenho evid√™ncias concretas (logs, respostas HTTP, erros) para minhas conclus√µes?
    - [ ] Verifiquei hist√≥rico/documenta√ß√£o antes de assumir mudan√ßas?
    - [ ] Distingui entre fatos confirmados e hip√≥teses?
    - [ ] Indiquei quando algo √© hip√≥tese vs fato?
    - [ ] Reconheci limita√ß√µes da an√°lise?
  - ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
    - ‚ùå **NUNCA especular** sobre mudan√ßas hist√≥ricas sem verificar
    - ‚ùå **NUNCA assumir** que algo mudou sem evid√™ncias
    - ‚ùå **NUNCA apresentar** especula√ß√µes como fatos
    - ‚ùå **NUNCA fazer** an√°lises sem testar primeiro
    - ‚ùå **NUNCA concluir** sem evid√™ncias concretas
  - ‚úÖ **OBRIGA√á√ïES:**
    - ‚úÖ **SEMPRE testar** antes de analisar
    - ‚úÖ **SEMPRE buscar** evid√™ncias concretas
    - ‚úÖ **SEMPRE distinguir** fatos de hip√≥teses
    - ‚úÖ **SEMPRE reconhecer** limita√ß√µes
    - ‚úÖ **SEMPRE indicar** quando n√£o tenho certeza
  - üö® **SE N√ÉO TENHO EVID√äNCIAS SUFICIENTES:**
    - ‚úÖ Informar claramente que n√£o tenho evid√™ncias suficientes
    - ‚úÖ Sugerir testes espec√≠ficos para coletar evid√™ncias
    - ‚úÖ Apresentar hip√≥teses como hip√≥teses (n√£o como fatos)
    - ‚úÖ Aguardar evid√™ncias antes de concluir
  - üìã **Exemplo de An√°lise Correta:**
    - ‚ùå **ERRADO:** "O dom√≠nio mudou de X para Y, por isso n√£o funciona"
    - ‚úÖ **CORRETO:** "Testei a API e ela retorna 502. Isso indica que a API est√° fora do ar, n√£o um problema de CORS ou dom√≠nio."
  - üìã **Exemplo de Processo Correto:**
    1. Usu√°rio reporta erro
    2. **TESTAR primeiro:** Executar teste direto na API/endpoint
    3. **COLETAR evid√™ncias:** Verificar status HTTP, headers, logs
    4. **ANALISAR baseado em evid√™ncias:** Conclus√µes baseadas nos testes
    5. **RECONHECER limita√ß√µes:** Indicar o que foi testado e o que n√£o foi
- üö® **COMPROMISSO OBRIGAT√ìRIO - An√°lises Baseadas em Evid√™ncias (CR√çTICO):**
  - üö® **REGRA CR√çTICA:** **NUNCA fazer an√°lises baseadas em especula√ß√µes ou suposi√ß√µes sem evid√™ncias concretas**
  - ‚úÖ **PROCESSO OBRIGAT√ìRIO ao analisar problemas:**
    1. **FASE 1: Testar Primeiro (OBRIGAT√ìRIA)**
       - ‚úÖ **SEMPRE testar** APIs, endpoints, ou funcionalidades antes de analisar
       - ‚úÖ **SEMPRE verificar** status real (200, 502, timeout, etc.) antes de concluir
       - ‚úÖ **SEMPRE executar** comandos de teste antes de especular sobre causas
       - ‚ùå **NUNCA assumir** que algo est√° funcionando ou n√£o funcionando sem testar
    2. **FASE 2: Coletar Evid√™ncias Concretas (OBRIGAT√ìRIA)**
       - ‚úÖ **SEMPRE buscar** evid√™ncias reais (logs, respostas HTTP, erros concretos)
       - ‚úÖ **SEMPRE verificar** hist√≥rico e documenta√ß√£o antes de assumir mudan√ßas
       - ‚úÖ **SEMPRE confirmar** fatos antes de apresentar como causa
       - ‚ùå **NUNCA especular** sobre mudan√ßas hist√≥ricas sem evid√™ncias
       - ‚ùå **NUNCA assumir** que algo mudou sem verificar primeiro
    3. **FASE 3: Analisar Baseado em Evid√™ncias (OBRIGAT√ìRIA)**
       - ‚úÖ **SEMPRE basear** an√°lises em evid√™ncias coletadas
       - ‚úÖ **SEMPRE distinguir** entre fatos confirmados e hip√≥teses
       - ‚úÖ **SEMPRE indicar** quando algo √© hip√≥tese vs fato confirmado
       - ‚ùå **NUNCA apresentar** especula√ß√µes como fatos
       - ‚ùå **NUNCA assumir** causas sem evid√™ncias que as suportem
    4. **FASE 4: Reconhecer Limita√ß√µes (OBRIGAT√ìRIA)**
       - ‚úÖ **SEMPRE reconhecer** quando n√£o tenho certeza
       - ‚úÖ **SEMPRE indicar** quando an√°lise √© baseada em hip√≥teses
       - ‚úÖ **SEMPRE sugerir** testes adicionais quando necess√°rio
       - ‚ùå **NUNCA apresentar** conclus√µes definitivas sem evid√™ncias suficientes
  - ‚úÖ **Checklist Obrigat√≥rio ANTES de Apresentar An√°lise:**
    - [ ] Testei a funcionalidade/API/endpoint antes de analisar?
    - [ ] Tenho evid√™ncias concretas (logs, respostas HTTP, erros) para minhas conclus√µes?
    - [ ] Verifiquei hist√≥rico/documenta√ß√£o antes de assumir mudan√ßas?
    - [ ] Distingui entre fatos confirmados e hip√≥teses?
    - [ ] Indiquei quando algo √© hip√≥tese vs fato?
    - [ ] Reconheci limita√ß√µes da an√°lise?
  - ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
    - ‚ùå **NUNCA especular** sobre mudan√ßas hist√≥ricas sem verificar
    - ‚ùå **NUNCA assumir** que algo mudou sem evid√™ncias
    - ‚ùå **NUNCA apresentar** especula√ß√µes como fatos
    - ‚ùå **NUNCA fazer** an√°lises sem testar primeiro
    - ‚ùå **NUNCA concluir** sem evid√™ncias concretas
  - ‚úÖ **OBRIGA√á√ïES:**
    - ‚úÖ **SEMPRE testar** antes de analisar
    - ‚úÖ **SEMPRE buscar** evid√™ncias concretas
    - ‚úÖ **SEMPRE distinguir** fatos de hip√≥teses
    - ‚úÖ **SEMPRE reconhecer** limita√ß√µes
    - ‚úÖ **SEMPRE indicar** quando n√£o tenho certeza
  - üö® **SE N√ÉO TENHO EVID√äNCIAS SUFICIENTES:**
    - ‚úÖ Informar claramente que n√£o tenho evid√™ncias suficientes
    - ‚úÖ Sugerir testes espec√≠ficos para coletar evid√™ncias
    - ‚úÖ Apresentar hip√≥teses como hip√≥teses (n√£o como fatos)
    - ‚úÖ Aguardar evid√™ncias antes de concluir
  - üìã **Exemplo de An√°lise Correta:**
    - ‚ùå **ERRADO:** "O dom√≠nio mudou de X para Y, por isso n√£o funciona"
    - ‚úÖ **CORRETO:** "Testei a API e ela retorna 502. Isso indica que a API est√° fora do ar, n√£o um problema de CORS ou dom√≠nio."
  - üìã **Exemplo de Processo Correto:**
    1. Usu√°rio reporta erro
    2. **TESTAR primeiro:** Executar teste direto na API/endpoint
    3. **COLETAR evid√™ncias:** Verificar status HTTP, headers, logs
    4. **ANALISAR baseado em evid√™ncias:** Conclus√µes baseadas nos testes
    5. **RECONHECER limita√ß√µes:** Indicar o que foi testado e o que n√£o foi

### Interpreta√ß√£o de Comandos: Investigar vs Implementar
- üö® **CR√çTICO:** Esta √© uma das diretivas mais importantes - violar resulta em modifica√ß√µes n√£o autorizadas

- ‚úÖ **COMANDOS DE INVESTIGA√á√ÉO (NUNCA MODIFICAR C√ìDIGO):**
  - **Palavras-chave:** "verifique", "analise", "investigue", "explique", "como funciona", "por que", "identifique", "descubra"
  - **A√á√ÉO PERMITIDA:** Apenas investigar, analisar e documentar o problema
  - **A√á√ÉO PROIBIDA:** ‚ùå Corrigir c√≥digo ‚ùå Adicionar logs ‚ùå Modificar arquivos ‚ùå Implementar solu√ß√µes
  - **PROCESSO OBRIGAT√ìRIO:**
    1. Investigar o c√≥digo e identificar a causa raiz
    2. Criar documento de an√°lise explicando o problema em `05-DOCUMENTATION/`
    3. Apresentar an√°lise ao usu√°rio
    4. **AGUARDAR autoriza√ß√£o expl√≠cita** antes de qualquer modifica√ß√£o
    5. **NUNCA modificar c√≥digo** sem autoriza√ß√£o expl√≠cita ap√≥s investiga√ß√£o
  - **EXEMPLOS:**
    - ‚ùå "Analise porque X n√£o funciona" ‚Üí APENAS analisar, N√ÉO corrigir
    - ‚ùå "Verifique como funciona Y" ‚Üí APENAS verificar, N√ÉO modificar
    - ‚ùå "Investigue o problema Z" ‚Üí APENAS investigar, N√ÉO implementar

- ‚úÖ **COMANDOS DE IMPLEMENTA√á√ÉO (PODE MODIFICAR C√ìDIGO):**
  - **Palavras-chave:** "corrija", "implemente", "fa√ßa", "execute", "adicione", "modifique", "crie", "atualize"
  - **A√á√ÉO PERMITIDA:** Investigar + implementar solu√ß√£o
  - **PROCESSO OBRIGAT√ìRIO:**
    1. Investigar se necess√°rio para entender o problema
    2. Criar backup do arquivo original
    3. Implementar corre√ß√£o
    4. Fazer deploy (se aplic√°vel)
    5. Realizar auditoria p√≥s-implementa√ß√£o e documentar formalmente
  - **EXEMPLOS:**
    - ‚úÖ "Corrija o problema X" ‚Üí Investigar + corrigir
    - ‚úÖ "Implemente a funcionalidade Y" ‚Üí Investigar + implementar
    - ‚úÖ "Adicione logs de diagn√≥stico" ‚Üí Implementar logs
  - ‚ö†Ô∏è **EXCE√á√ÉO ESPECIAL - "Fa√ßa um projeto" ou "Crie um projeto":**
    - üö® **N√ÉO significa executar imediatamente**
    - ‚úÖ **Significa:** Criar documento do projeto ‚Üí Apresentar ‚Üí Perguntar autoriza√ß√£o ‚Üí Executar
    - üö® **Ver se√ß√£o "1. Autoriza√ß√£o Pr√©via para Modifica√ß√µes" para processo completo**

- ‚ö†Ô∏è **REGRA ABSOLUTA - SEM EXCE√á√ïES:**
  - **Quando houver d√∫vida entre investigar ou implementar:**
    - **SEMPRE preferir apenas investigar primeiro**
    - **SEMPRE aguardar autoriza√ß√£o expl√≠cita** antes de implementar
    - **SEMPRE perguntar:** "Deseja que eu corrija/implemente isso agora?" ap√≥s apresentar an√°lise
  - **ANTES DE MODIFICAR QUALQUER ARQUIVO:**
    - ‚úÖ Verificar se comando cont√©m palavra de implementa√ß√£o expl√≠cita
    - ‚úÖ Se comando cont√©m apenas palavras de investiga√ß√£o ‚Üí **PARAR** e apenas investigar
    - ‚úÖ Se houver d√∫vida ‚Üí **PERGUNTAR** antes de modificar

### Documenta√ß√£o
- ‚úÖ Documentar decis√µes importantes quando solicitado
- ‚úÖ Criar documentos de especifica√ß√£o quando necess√°rio
- ‚úÖ Manter hist√≥rico das decis√µes t√©cnicas

### Backups Locais
- ‚úÖ **SEMPRE incluir** backups locais dos arquivos em diret√≥rio espec√≠fico definido no projeto
- ‚úÖ Criar estrutura de backup antes de modificar arquivos importantes
- ‚úÖ Manter hist√≥rico de vers√µes dos arquivos modificados
- üìÅ Diret√≥rio padr√£o: `backups/` ou conforme definido no projeto espec√≠fico

### Registro de Conversas
- ‚úÖ **SEMPRE guardar** todas as conversas em arquivos individuais
- ‚úÖ Criar arquivo de conversa com nome descritivo e timestamp
- ‚úÖ Registrar no arquivo hist√≥rico de conversas:
  - Refer√™ncia √† conversa
  - Nome do arquivo criado
  - Timestamp da conversa
- üìÅ Formato sugerido: `CONVERSA_YYYYMMDD_HHMMSS.md` ou `CONVERSA_[TEMA]_YYYYMMDD.md`
- üìÅ Arquivo hist√≥rico: `HISTORICO_CONVERSAS.md` na raiz do projeto

---

## üîß DIRETIVAS T√âCNICAS ESPEC√çFICAS

### Elabora√ß√£o Incremental de Scripts (OBRIGAT√ìRIA) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **SEMPRE elaborar scripts de forma incremental**, testando sintaxe a cada etapa
- ‚úÖ **PROCESSO OBRIGAT√ìRIO ao criar/modificar scripts:**
  1. **ETAPA 1: Estrutura B√°sica**
     - ‚úÖ Criar estrutura b√°sica (par√¢metros, vari√°veis, fun√ß√µes b√°sicas)
     - ‚úÖ Validar sintaxe PowerShell antes de continuar
     - ‚úÖ **N√ÉO prosseguir** se houver erros de sintaxe
  2. **ETAPA 2: Fun√ß√µes Auxiliares**
     - ‚úÖ Adicionar fun√ß√µes auxiliares uma por uma
     - ‚úÖ Validar sintaxe ap√≥s cada fun√ß√£o adicionada
     - ‚úÖ **N√ÉO adicionar pr√≥xima fun√ß√£o** se houver erros de sintaxe
  3. **ETAPA 3: L√≥gica Principal**
     - ‚úÖ Adicionar l√≥gica principal incrementalmente
     - ‚úÖ Validar sintaxe ap√≥s cada bloco de l√≥gica
     - ‚úÖ **N√ÉO adicionar pr√≥ximo bloco** se houver erros de sintaxe
  4. **ETAPA 4: Tratamento de Erros**
     - ‚úÖ Adicionar tratamento de erros e rollback
     - ‚úÖ Validar sintaxe ap√≥s adicionar tratamento
     - ‚úÖ **N√ÉO considerar script completo** se houver erros de sintaxe
  5. **ETAPA 5: Valida√ß√£o Final**
     - ‚úÖ Validar sintaxe completa do script
     - ‚úÖ Testar em modo DryRun (se aplic√°vel)
     - ‚úÖ **SOMENTE ap√≥s valida√ß√£o completa** considerar script pronto
- ‚úÖ **Valida√ß√£o de Sintaxe Obrigat√≥ria:**
  - ‚úÖ Usar `[System.Management.Automation.PSParser]::Tokenize` para validar sintaxe
  - ‚úÖ Validar ap√≥s cada fun√ß√£o adicionada
  - ‚úÖ Validar ap√≥s cada bloco de l√≥gica adicionado
  - ‚úÖ Validar antes de considerar script completo
- ‚úÖ **Benef√≠cios da Elabora√ß√£o Incremental:**
  - Detec√ß√£o precoce de erros de sintaxe
  - Facilita identifica√ß√£o de problemas
  - Reduz tempo de corre√ß√£o
  - Garante qualidade do c√≥digo
  - Evita retrabalho
- ‚ùå **NUNCA criar script completo de uma vez** sem validar sintaxe
- ‚ùå **NUNCA adicionar m√∫ltiplas fun√ß√µes** sem validar entre elas
- ‚ùå **NUNCA considerar script pronto** sem valida√ß√£o final
- ‚úÖ **SEMPRE validar sintaxe** ap√≥s cada etapa incremental
- ‚úÖ **SEMPRE testar em DryRun** antes de usar em produ√ß√£o
- üìÅ **Scripts devem estar em:** `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/scripts/`
- üìã **Documenta√ß√£o de valida√ß√£o:** Registrar resultados em log ou documento de valida√ß√£o

### Valida√ß√£o de Scripts PowerShell (OBRIGAT√ìRIA) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **SEMPRE usar extens√£o PowerShell do VS Code** para validar scripts antes de executar
- ‚úÖ **PROCESSO OBRIGAT√ìRIO ao criar/modificar scripts PowerShell:**
  1. **Abrir script no VS Code** com extens√£o PowerShell instalada
  2. **Verificar erros de sintaxe** mostrados em tempo real pela extens√£o
  3. **Corrigir TODOS os erros** antes de considerar script pronto
  4. **Validar sintaxe** usando PSScriptAnalyzer se dispon√≠vel: `Invoke-ScriptAnalyzer -Path .\script.ps1`
  5. **SOMENTE ap√≥s valida√ß√£o completa** considerar script pronto para uso
- ‚úÖ **Extens√£o Recomendada:** "PowerShell" (Microsoft) no VS Code
- ‚úÖ **Benef√≠cios:**
  - Valida√ß√£o de sintaxe em tempo real
  - Detec√ß√£o de erros antes de executar
  - IntelliSense e autocomplete
  - Formata√ß√£o autom√°tica
  - Execu√ß√£o e depura√ß√£o integradas
- ‚ùå **NUNCA executar script PowerShell** sem validar sintaxe primeiro
- ‚ùå **NUNCA modificar script PowerShell** sem verificar erros ap√≥s modifica√ß√£o
- ‚úÖ **SEMPRE validar** antes de considerar script completo
- üìÅ **Scripts devem estar em:** `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/scripts/`
- üìã **Documenta√ß√£o de valida√ß√£o:** Registrar resultados em log ou documento de valida√ß√£o

### Resolu√ß√£o de Problemas de Ambiente (OBRIGAT√ìRIA)
- üö® **ANTES de qualquer corre√ß√£o de erro de ambiente, servidor, Linux, Nginx, PHP, MySQL/MariaDB, SQL:**
  1. ‚úÖ **CONSULTAR documenta√ß√£o do projeto** em `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/`
  2. ‚úÖ **CONSULTAR documenta√ß√£o oficial** do componente (Nginx, PHP, MySQL/MariaDB)
  3. ‚úÖ **CONSULTAR blogs e tutoriais** relevantes sobre o erro espec√≠fico
  4. ‚úÖ **IDENTIFICAR causa raiz** baseado na documenta√ß√£o
  5. ‚úÖ **PROPOR solu√ß√£o** fundamentada antes de implementar
- ‚ùå **NUNCA usar tentativa-e-erro** para problemas de ambiente
- ‚úÖ **SEMPRE documentar** quais documenta√ß√µes foram consultadas
- üìÅ **Documenta√ß√£o do projeto:** `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/`
- üîç **Fontes externas:** Documenta√ß√£o oficial, blogs, tutoriais relevantes

### Configura√ß√£o e Vari√°veis
- **PHP:** Usar `$_ENV['VARIAVEL']` para acessar vari√°veis de ambiente do Docker
- **JavaScript:** Usar vari√°veis globais simples expostas via `config_env.js.php` (se necess√°rio)
- **N√ÉO criar:** Objetos de configura√ß√£o complexos, sistemas centralizados de config

### Credenciais e Seguran√ßa
- ‚úÖ Credenciais devem estar em vari√°veis de ambiente do Docker
- ‚úÖ N√ÉO hardcodar credenciais em arquivos JavaScript ou PHP
- ‚úÖ Usar vari√°veis de ambiente separadas para dev e prod quando necess√°rio

### Ambientes
- **DEV:** `https://dev.bssegurosimediato.com.br` (IP: 65.108.156.14) - **AMBIENTE PADR√ÉO**
- **PROD:** `https://prod.bssegurosimediato.com.br` (IP: 157.180.36.223) - **üö® PROCEDIMENTO N√ÉO DEFINIDO**
- ‚úÖ **PADR√ÉO:** Sempre trabalhar em DEV, salvo instru√ß√£o espec√≠fica do usu√°rio
- ‚úÖ Sempre verificar qual ambiente est√° sendo usado antes de fazer altera√ß√µes
- üö® **PRODU√á√ÉO - ALERTAS OBRIGAT√ìRIOS:**
  - ‚ö†Ô∏è **EMITIR ALERTA** ao detectar qualquer refer√™ncia ao servidor de produ√ß√£o
  - ‚ö†Ô∏è **EMITIR ALERTA** ao detectar IP `157.180.36.223` em comandos ou scripts
  - ‚ö†Ô∏è **EMITIR ALERTA** ao detectar dom√≠nio `prod.bssegurosimediato.com.br` em comandos ou scripts
  - ‚ö†Ô∏è **EMITIR ALERTA** ao detectar caminho `/var/www/html/prod/root/` em comandos ou scripts
  - ‚ö†Ô∏è **EMITIR ALERTA** ao detectar tentativa de SSH para servidor de produ√ß√£o
  - [ERRO] **BLOQUEAR** qualquer acao em producao ate que procedimento seja oficialmente definido
  - [INFO] **STATUS:** Procedimento para producao sera definido posteriormente
12. **[AVISO] EMOJIS EM CODIGO - PROIBIDO:** NUNCA usar emojis em scripts, codigo ou logs. Use texto simples: `[OK]`, `[ERRO]`, `[AVISO]`, `[INFO]`, `[SUCESSO]`, etc.
13. **[AVISO] ELABORACAO INCREMENTAL - OBRIGATORIA:** SEMPRE elaborar scripts de forma incremental, validando sintaxe apos cada etapa. NUNCA criar script completo de uma vez sem validar.

---

## ‚ö†Ô∏è AVISOS IMPORTANTES

1. **NUNCA modificar nada diretamente no servidor** - Sempre modificar primeiro no Windows com backup
2. **Backup √© OBRIGAT√ìRIO** - Sempre criar backup antes de qualquer modifica√ß√£o
3. **Nginx e PHP:** N√£o modificar quando est√£o funcionando, a menos que explicitamente autorizado
4. **JavaScript no Servidor:** NUNCA modificar diretamente, sempre modificar localmente primeiro
5. **PHP no Servidor:** NUNCA modificar diretamente, sempre modificar localmente primeiro com backup
6. **Arquivos de Configura√ß√£o:** NUNCA criar diretamente no servidor - SEMPRE criar localmente em `06-SERVER-CONFIG/` e copiar via SCP
7. **Sistemas Complexos:** Evitar criar sistemas de configura√ß√£o complexos, preferir solu√ß√µes simples
8. **Vari√°veis de Ambiente:** Sempre usar vari√°veis do Docker, n√£o criar sistemas alternativos
9. **Heredoc no SSH:** NUNCA usar heredoc complexo via SSH - SEMPRE criar arquivo local e copiar
10. **[AVISO] CACHE CLOUDFLARE - OBRIGATORIO (APENAS HETZNER):** Apos atualizar arquivos `.js` ou `.php` no servidor Hetzner (nao Google Cloud), **SEMPRE avisar** ao usuario sobre a necessidade de limpar o cache do Cloudflare. O Cloudflare pode manter versoes antigas em cache, causando erros como uso de credenciais antigas, codigo desatualizado, etc. Avisar explicitamente: "[AVISO] IMPORTANTE: Apos atualizar arquivos no servidor Hetzner, e necessario limpar o cache do Cloudflare para que as alteracoes sejam refletidas imediatamente."
11. **[INFO] GOOGLE CLOUD RUN/STORAGE:** Servicos no Google Cloud Run ou arquivos no Google Cloud Storage nao requerem limpeza de cache do Cloudflare - as alteracoes sao refletidas imediatamente apos deploy. Cloudflare e um CDN/proxy que pode estar na frente de sites estaticos ou servicos que passam por ele, mas nao se aplica diretamente a servicos Cloud Run.
12. **[AVISO] PRODUCAO - PROCEDIMENTO NAO DEFINIDO:**
    - [AVISO] **EMITIR ALERTA** ao detectar qualquer tentativa de acesso ou modificacao no servidor de producao
    - [AVISO] **EMITIR ALERTA** ao detectar IP `157.180.36.223` ou dominio `prod.bssegurosimediato.com.br`
    - [AVISO] **EMITIR ALERTA** ao detectar caminho `/var/www/html/prod/root/`
    - [ERRO] **BLOQUEAR** qualquer acao em producao ate que procedimento seja oficialmente definido
    - [INFO] Procedimento para producao sera definido posteriormente
12. **[AVISO] EMOJIS EM CODIGO - PROIBIDO:** NUNCA usar emojis em scripts, codigo ou logs. Use texto simples: `[OK]`, `[ERRO]`, `[AVISO]`, `[INFO]`, `[SUCESSO]`, etc.
13. **[AVISO] ELABORACAO INCREMENTAL - OBRIGATORIA:** SEMPRE elaborar scripts de forma incremental, validando sintaxe apos cada etapa. NUNCA criar script completo de uma vez sem validar.

---

## üìù NOTAS

- Estas diretivas foram coletadas do hist√≥rico de conversas e decis√µes do projeto
- Quando houver conflito entre diretivas, priorizar as regras cr√≠ticas (se√ß√£o 1)
- Em caso de d√∫vida, perguntar ao usu√°rio antes de prosseguir
- As diretivas de autoriza√ß√£o pr√©via e backups s√£o **obrigat√≥rias** e devem ser seguidas sempre

---

## üìã EXEMPLO DE FLUXO CORRETO

### Antes de Iniciar um Projeto:
1. ‚úÖ **CRIAR documento do projeto** em `05-DOCUMENTATION/` (se ainda n√£o existir)
2. ‚úÖ **APRESENTAR projeto ao usu√°rio** (resumo das fases, objetivos, arquivos envolvidos)
3. ‚úÖ **PERGUNTAR:** "Posso iniciar o projeto X agora?"
4. ‚úÖ **AGUARDAR autoriza√ß√£o expl√≠cita** do usu√°rio
5. ‚úÖ **SOMENTE ent√£o** iniciar execu√ß√£o do projeto
6. ‚úÖ Dentro do projeto autorizado: Modificar arquivos sem pedir autoriza√ß√£o individual
7. ‚úÖ **OBRIGAT√ìRIO:** Criar backups locais dos arquivos que ser√£o modificados ANTES de qualquer altera√ß√£o
8. ‚úÖ Criar arquivos localmente (n√£o no servidor)
9. ‚úÖ Copiar para servidor apenas ap√≥s cria√ß√£o local e verifica√ß√£o
10. ‚úÖ Registrar conversa e atualizar hist√≥rico
11. ‚úÖ **OBRIGAT√ìRIO:** Realizar auditoria p√≥s-implementa√ß√£o e documentar formalmente

### Para Modifica√ß√µes Isoladas (fora de projeto):
1. ‚úÖ Perguntar: "Posso modificar o arquivo X agora?"
2. ‚úÖ Aguardar autoriza√ß√£o expl√≠cita
3. ‚úÖ **OBRIGAT√ìRIO:** Criar backup local do arquivo original ANTES de modificar
4. ‚úÖ Modificar arquivo localmente (nunca no servidor)
5. üö® **ALERTA:** Se detectar refer√™ncia a produ√ß√£o, emitir alerta e bloquear a√ß√£o

### Para Comandos de Investiga√ß√£o ("verifique porque", "analise", "investigue", "explique", "como funciona"):
1. ‚úÖ **APENAS investigar** o problema (n√£o corrigir automaticamente)
2. ‚úÖ Identificar causa raiz do problema
3. ‚úÖ Criar documento de an√°lise em `05-DOCUMENTATION/`
4. ‚úÖ Apresentar an√°lise ao usu√°rio
5. ‚úÖ **AGUARDAR autoriza√ß√£o expl√≠cita** antes de corrigir
6. üö® **PROIBI√á√ÉO ABSOLUTA:** ‚ùå **N√ÉO corrigir** ‚ùå **N√ÉO adicionar logs** ‚ùå **N√ÉO modificar arquivos** ‚ùå **N√ÉO implementar solu√ß√µes** sem autoriza√ß√£o expl√≠cita ap√≥s investiga√ß√£o
7. ‚ö†Ô∏è **CHECKLIST ANTES DE QUALQUER MODIFICA√á√ÉO:**
   - [ ] O usu√°rio pediu explicitamente para modificar/implementar/corrigir?
   - [ ] O comando cont√©m palavra de implementa√ß√£o ("corrija", "implemente", "adicione")?
   - [ ] Se N√ÉO ‚Üí **PARAR** e apenas apresentar an√°lise
   - [ ] Se SIM ‚Üí Continuar com implementa√ß√£o

### Para Tentativas de Acesso a Produ√ß√£o:
1. üö® **EMITIR ALERTA IMEDIATO:** "‚ö†Ô∏è ALERTA: Detectada tentativa de acesso ao servidor de produ√ß√£o"
2. üö® **INFORMAR:** "O procedimento para produ√ß√£o ser√° definido posteriormente"
3. üö® **BLOQUEAR:** N√£o executar comando ou a√ß√£o at√© procedimento oficial
4. ‚úÖ **SUGERIR:** Trabalhar apenas no ambiente DEV (`dev.bssegurosimediato.com.br`)

### Ap√≥s Modifica√ß√£o:
1. ‚úÖ Salvar conversa em arquivo individual
2. ‚úÖ Atualizar `HISTORICO_CONVERSAS.md` com refer√™ncia e timestamp
3. ‚úÖ Manter backup do arquivo original
4. ‚úÖ **OBRIGAT√ìRIO:** Realizar auditoria p√≥s-implementa√ß√£o (ver se√ß√£o "Auditoria P√≥s-Implementa√ß√£o")
5. ‚úÖ **OBRIGAT√ìRIO:** Seguir metodologia definida em `WEBFLOW-SEGUROSIMEDIATO/05-DOCUMENTATION/AUDITORIA_PROJETOS_BOAS_PRATICAS.md`
6. ‚úÖ **OBRIGAT√ìRIO:** Criar documento formal de auditoria em `05-DOCUMENTATION/` (ex: `AUDITORIA_PROJETO_X.md`)
7. ‚úÖ **OBRIGAT√ìRIO:** Documentar todos os arquivos auditados, problemas encontrados, e confirma√ß√£o de que nenhuma funcionalidade foi prejudicada
8. ‚úÖ **OBRIGAT√ìRIO:** Verificar especifica√ß√µes do usu√°rio conforme se√ß√£o 2.3 do documento de auditoria
9. ‚úÖ **OBRIGAT√ìRIO:** Atualizar documento de tracking de altera√ß√µes (`ALTERACOES_DESDE_ULTIMA_REPLICACAO_PROD_YYYYMMDD.md`) se altera√ß√µes foram feitas em DEV (ver se√ß√£o "Tracking de Altera√ß√µes para Replica√ß√£o em Produ√ß√£o")

### Processo de Elabora√ß√£o Incremental de Scripts (OBRIGAT√ìRIO) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **SEMPRE elaborar scripts de forma incremental**, validando sintaxe ap√≥s cada etapa
- ‚úÖ **PROCESSO OBRIGAT√ìRIO - 5 ETAPAS INCREMENTAIS:**

  **ETAPA 1: Estrutura B√°sica (OBRIGAT√ìRIA)**
  - ‚úÖ Criar estrutura b√°sica (par√¢metros, vari√°veis globais, configura√ß√µes)
  - ‚úÖ Adicionar fun√ß√µes b√°sicas de log (se necess√°rio)
  - ‚úÖ Validar sintaxe PowerShell usando `[System.Management.Automation.PSParser]::Tokenize`
  - ‚úÖ Verificar se script carrega sem erros (sem executar)
  - ‚ùå **BLOQUEAR pr√≥xima etapa** se houver erros de sintaxe
  - ‚úÖ **SOMENTE ap√≥s valida√ß√£o bem-sucedida** prosseguir para ETAPA 2

  **ETAPA 2: Fun√ß√µes Auxiliares (OBRIGAT√ìRIA)**
  - ‚úÖ Adicionar fun√ß√µes auxiliares uma por uma (valida√ß√£o, hash, backup, etc.)
  - ‚úÖ Validar sintaxe ap√≥s cada fun√ß√£o adicionada
  - ‚úÖ Verificar se todas as fun√ß√µes est√£o definidas corretamente
  - ‚úÖ Verificar se vari√°veis est√£o definidas corretamente
  - ‚ùå **BLOQUEAR pr√≥xima etapa** se houver erros de sintaxe
  - ‚úÖ **SOMENTE ap√≥s valida√ß√£o bem-sucedida** prosseguir para ETAPA 3

  **ETAPA 3: L√≥gica Principal (OBRIGAT√ìRIA)**
  - ‚úÖ Adicionar l√≥gica principal incrementalmente (por fases/blocos)
  - ‚úÖ Validar sintaxe ap√≥s cada bloco de l√≥gica adicionado
  - ‚úÖ Verificar se fluxo de execu√ß√£o est√° correto
  - ‚úÖ Verificar se depend√™ncias entre fun√ß√µes est√£o corretas
  - ‚ùå **BLOQUEAR pr√≥xima etapa** se houver erros de sintaxe
  - ‚úÖ **SOMENTE ap√≥s valida√ß√£o bem-sucedida** prosseguir para ETAPA 4

  **ETAPA 4: Tratamento de Erros e Rollback (OBRIGAT√ìRIA)**
  - ‚úÖ Adicionar tratamento de erros (`try/catch`)
  - ‚úÖ Adicionar l√≥gica de rollback (se aplic√°vel)
  - ‚úÖ Validar sintaxe ap√≥s adicionar tratamento
  - ‚úÖ Verificar se vari√°veis de escopo est√£o corretas (usar `$script:` quando necess√°rio)
  - ‚ùå **BLOQUEAR pr√≥xima etapa** se houver erros de sintaxe
  - ‚úÖ **SOMENTE ap√≥s valida√ß√£o bem-sucedida** prosseguir para ETAPA 5

  **ETAPA 5: Valida√ß√£o Final (OBRIGAT√ìRIA)**
  - ‚úÖ Validar sintaxe completa do script
  - ‚úÖ Verificar se todas as fun√ß√µes est√£o sendo chamadas corretamente
  - ‚úÖ Testar em modo DryRun (se aplic√°vel)
  - ‚úÖ Verificar se n√£o h√° emojis no c√≥digo (substituir por texto simples)
  - ‚úÖ Verificar se encoding est√° correto (UTF-8 sem BOM)
  - ‚ùå **BLOQUEAR uso em produ√ß√£o** se houver erros de sintaxe
  - ‚úÖ **SOMENTE ap√≥s valida√ß√£o completa bem-sucedida** considerar script pronto

- ‚úÖ **Checklist Obrigat√≥rio ANTES de Considerar Script Completo:**
  - [ ] **ETAPA 1:** Estrutura b√°sica criada e sintaxe validada?
  - [ ] **ETAPA 2:** Fun√ß√µes auxiliares adicionadas e sintaxe validada ap√≥s cada uma?
  - [ ] **ETAPA 3:** L√≥gica principal adicionada incrementalmente e sintaxe validada?
  - [ ] **ETAPA 4:** Tratamento de erros e rollback adicionados e sintaxe validada?
  - [ ] **ETAPA 5:** Valida√ß√£o final completa bem-sucedida?
  - [ ] **ETAPA 5:** Teste em DryRun executado com sucesso?
  - [ ] **ETAPA 5:** Nenhum emoji encontrado no c√≥digo?
  - [ ] **ETAPA 5:** Encoding UTF-8 sem BOM verificado?

- ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
  - ‚ùå **NUNCA criar script completo de uma vez** sem validar sintaxe
  - ‚ùå **NUNCA adicionar m√∫ltiplas fun√ß√µes** sem validar entre elas
  - ‚ùå **NUNCA pular etapas** de valida√ß√£o
  - ‚ùå **NUNCA considerar script pronto** sem valida√ß√£o final
  - ‚ùå **NUNCA usar emojis** em scripts (usar texto simples)

- ‚úÖ **OBRIGA√á√ïES:**
  - ‚úÖ **SEMPRE elaborar incrementalmente** (estrutura ‚Üí fun√ß√µes ‚Üí l√≥gica ‚Üí erros ‚Üí valida√ß√£o)
  - ‚úÖ **SEMPRE validar sintaxe** ap√≥s cada etapa
  - ‚úÖ **SEMPRE testar em DryRun** antes de usar em produ√ß√£o
  - ‚úÖ **SEMPRE usar texto simples** em vez de emojis

- üö® **SE VALIDA√á√ÉO FALHAR EM QUALQUER ETAPA:**
  - ‚úÖ Corrigir erros identificados
  - ‚úÖ Repetir valida√ß√£o da etapa atual
  - ‚úÖ **SOMENTE ap√≥s valida√ß√£o bem-sucedida** prosseguir para pr√≥xima etapa

- üìÅ **Localiza√ß√£o de Scripts:** `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/scripts/`
- üìã **Documenta√ß√£o:** Registrar resultados de valida√ß√£o em log ou documento espec√≠fico

### Processo de Valida√ß√£o de Scripts PowerShell (OBRIGAT√ìRIO) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **SEMPRE validar scripts PowerShell antes de executar no servidor**
- ‚úÖ **PROCESSO OBRIGAT√ìRIO - 5 FASES DE VALIDA√á√ÉO:**

  **FASE 1: Valida√ß√£o de Sintaxe PowerShell (OBRIGAT√ìRIA)**
  - ‚úÖ Validar sintaxe usando `[System.Management.Automation.PSParser]::Tokenize`
  - ‚úÖ Verificar se script carrega sem erros (sem executar)
  - ‚úÖ Verificar se todas as fun√ß√µes est√£o definidas
  - ‚úÖ Verificar se vari√°veis est√£o definidas corretamente
  - ‚ùå **BLOQUEAR execu√ß√£o** se houver erros de sintaxe

  **FASE 2: Execu√ß√£o em Modo DryRun (OBRIGAT√ìRIA)**
  - ‚úÖ Executar script com par√¢metro `-DryRun` primeiro
  - ‚úÖ Verificar se script suporta modo DryRun
  - ‚úÖ Validar que script n√£o executa a√ß√µes reais em DryRun
  - ‚úÖ Verificar logs gerados em DryRun
  - ‚úÖ Validar que comandos SSH que seriam executados est√£o corretos
  - ‚ùå **BLOQUEAR execu√ß√£o** se DryRun falhar ou mostrar problemas

  **FASE 3: Valida√ß√£o do Script Bash Gerado (se aplic√°vel)**
  - ‚úÖ Se script gera script bash para executar no servidor:
    - ‚úÖ Validar sintaxe bash do script gerado (antes de enviar)
    - ‚úÖ Verificar se comandos bash est√£o corretos
    - ‚úÖ Verificar se vari√°veis est√£o sendo interpoladas corretamente
    - ‚úÖ Verificar se caracteres especiais est√£o escapados corretamente
    - ‚úÖ Validar que script bash n√£o cont√©m erros de sintaxe
  - ‚ùå **BLOQUEAR envio** se houver erros de sintaxe no script bash

  **FASE 4: Valida√ß√£o de Comandos SSH (OBRIGAT√ìRIA)**
  - ‚úÖ Verificar se comandos SSH est√£o corretos
  - ‚úÖ Verificar se caminhos de arquivos est√£o corretos
  - ‚úÖ Verificar se vari√°veis de servidor est√£o corretas (DEV vs PROD)
  - ‚úÖ Verificar se permiss√µes necess√°rias est√£o corretas
  - ‚ùå **BLOQUEAR execu√ß√£o** se comandos SSH estiverem incorretos

  **FASE 5: Valida√ß√£o de Integridade (OBRIGAT√ìRIA)**
  - ‚úÖ Verificar se fun√ß√µes cr√≠ticas est√£o presentes (`Write-Log`, `Invoke-SafeSSHScript`, etc.)
  - ‚úÖ Verificar se tratamento de erros est√° implementado (`try/catch`)
  - ‚úÖ Verificar se valida√ß√µes de hash est√£o implementadas
  - ‚úÖ Verificar se valida√ß√µes de sintaxe est√£o implementadas
  - ‚ùå **BLOQUEAR execu√ß√£o** se valida√ß√µes cr√≠ticas estiverem faltando

- ‚úÖ **Checklist Obrigat√≥rio ANTES de Executar Script no Servidor:**
  - [ ] **FASE 1:** Sintaxe PowerShell validada sem erros?
  - [ ] **FASE 2:** Script executado em modo DryRun com sucesso?
  - [ ] **FASE 3:** Script bash gerado validado (se aplic√°vel)?
  - [ ] **FASE 4:** Comandos SSH verificados e corretos?
  - [ ] **FASE 5:** Fun√ß√µes cr√≠ticas presentes e funcionando?
  - [ ] **FASE 5:** Tratamento de erros implementado?
  - [ ] **FASE 5:** Valida√ß√µes de integridade implementadas?
  - [ ] Logs de execu√ß√£o ser√£o gerados?

- ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
  - ‚ùå **NUNCA executar script no servidor** sem completar TODAS as 5 fases de valida√ß√£o
  - ‚ùå **NUNCA executar script** se valida√ß√£o falhar em qualquer fase
  - ‚ùå **NUNCA pular** fase de valida√ß√£o
  - ‚ùå **NUNCA executar** sem executar DryRun primeiro

- ‚úÖ **OBRIGA√á√ïES:**
  - ‚úÖ **SEMPRE executar em DryRun primeiro** antes de execu√ß√£o real
  - ‚úÖ **SEMPRE validar script bash gerado** antes de enviar para servidor
  - ‚úÖ **SEMPRE documentar** resultados das valida√ß√µes antes de executar
  - ‚úÖ **SEMPRE validar sintaxe** antes de criar ou modificar script

- üö® **SE VALIDA√á√ÉO FALHAR:**
  - ‚úÖ Corrigir script
  - ‚úÖ Repetir valida√ß√£o completa (todas as 5 fases)
  - ‚úÖ **SOMENTE ap√≥s valida√ß√£o completa bem-sucedida** executar no servidor

- üìÅ **Localiza√ß√£o de Scripts:** `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/scripts/`
- üìã **Documenta√ß√£o:** Registrar resultados de valida√ß√£o em log ou documento espec√≠fico

### Processo de C√≥pia para Servidor (OBRIGAT√ìRIO):
1. ‚úÖ **SEMPRE usar caminho completo do workspace** ao copiar arquivos
   - ‚úÖ Usar caminho absoluto completo do workspace
   - ‚úÖ Ou usar `cd` para o diret√≥rio do workspace antes de copiar
   - ‚ùå N√ÉO usar caminhos relativos que podem falhar (ex: `WEBFLOW-SEGUROSIMEDIATO/02-DEVELOPMENT/arquivo.js`)
   - ‚úÖ Exemplo correto: `cd "C:\Users\Luciano\OneDrive - Imediato Solu√ß√µes em Seguros\Imediato\imediatoseguros-rpa-playwright" && scp "WEBFLOW-SEGUROSIMEDIATO\02-DEVELOPMENT\arquivo.js" root@servidor:/destino/`
2. ‚úÖ **SEMPRE criar backup no servidor** antes de copiar arquivo novo
   - ‚úÖ Criar backup com timestamp: `arquivo.js.backup_YYYYMMDD_HHMMSS`
3. ‚úÖ **SEMPRE comparar hash ap√≥s c√≥pia** para garantir integridade:
   - ‚úÖ Calcular hash do arquivo local (SHA256 recomendado)
   - ‚úÖ Calcular hash do arquivo no servidor ap√≥s c√≥pia
   - ‚úÖ Comparar hashes **ignorando diferen√ßas de mai√∫sculas/min√∫sculas** (case-insensitive)
   - ‚úÖ Se hashes n√£o coincidirem, tentar copiar novamente
   - ‚úÖ Documentar hash comparado no log da opera√ß√£o
   - ‚úÖ **NUNCA considerar deploy conclu√≠do** sem verifica√ß√£o de hash bem-sucedida

### Registro de Deploys e Backups (OBRIGAT√ìRIO) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **SEMPRE registrar informa√ß√µes de deploy e backups** durante execu√ß√£o de deploys
- ‚úÖ **PROCESSO OBRIGAT√ìRIO durante deploys:**
  1. **Registrar Vers√£o do Deploy:**
     - ‚úÖ Identificar vers√£o do deploy (data, projeto, ambiente)
     - ‚úÖ Registrar timestamp do in√≠cio do deploy
     - ‚úÖ Manter registro em documento de deploy ou log
  2. **Registrar Cada Backup Criado:**
     - ‚úÖ **OBRIGAT√ìRIO:** Registrar nome completo de cada arquivo de backup criado
     - ‚úÖ **OBRIGAT√ìRIO:** Registrar timestamp exato do backup (YYYYMMDD_HHMMSS)
     - ‚úÖ **OBRIGAT√ìRIO:** Registrar caminho completo do backup no servidor
     - ‚úÖ **OBRIGAT√ìRIO:** Registrar arquivo original que foi feito backup
     - ‚úÖ **OBRIGAT√ìRIO:** Registrar ambiente (DEV/UAT/PROD)
  3. **Formato de Registro:**
     - ‚úÖ Criar se√ß√£o no documento de deploy ou log com lista de backups
     - ‚úÖ Formato: `[TIMESTAMP] [AMBIENTE] [ARQUIVO_ORIGINAL] ‚Üí [NOME_BACKUP_COMPLETO]`
     - ‚úÖ Exemplo: `[20251202_175500] [UAT] [/var/www/html/uat/root/config.php] ‚Üí [config.php.backup_20251202_175500]`
  4. **Quando Registrar:**
     - ‚úÖ **IMEDIATAMENTE ap√≥s criar cada backup** (n√£o esperar final do deploy)
     - ‚úÖ Registrar no documento de deploy em execu√ß√£o
     - ‚úÖ Registrar em log de deploy (se existir)
     - ‚úÖ **NUNCA pular** registro de backup
  5. **Informa√ß√µes Obrigat√≥rias a Registrar:**
     - ‚úÖ Timestamp do backup (YYYYMMDD_HHMMSS)
     - ‚úÖ Nome completo do arquivo de backup (incluindo caminho)
     - ‚úÖ Arquivo original que foi feito backup
     - ‚úÖ Ambiente (DEV/UAT/PROD)
     - ‚úÖ Vers√£o do deploy (se aplic√°vel)
     - ‚úÖ Hash SHA256 do arquivo original (antes do backup)
- ‚úÖ **Checklist Obrigat√≥rio DURANTE Deploy:**
  - [ ] Vers√£o do deploy registrada?
  - [ ] Timestamp do in√≠cio do deploy registrado?
  - [ ] Cada backup criado foi registrado com nome completo?
  - [ ] Timestamp de cada backup foi registrado?
  - [ ] Caminho completo de cada backup foi registrado?
  - [ ] Arquivo original de cada backup foi registrado?
  - [ ] Ambiente de cada backup foi registrado?
- ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
  - ‚ùå **NUNCA criar backup** sem registrar nome completo imediatamente
  - ‚ùå **NUNCA executar deploy** sem registrar vers√£o do deploy
  - ‚ùå **NUNCA pular** registro de backup durante deploy
  - ‚ùå **NUNCA assumir** que backup ser√° registrado depois (registrar imediatamente)
- ‚úÖ **OBRIGA√á√ïES:**
  - ‚úÖ **SEMPRE registrar** vers√£o do deploy antes de iniciar
  - ‚úÖ **SEMPRE registrar** cada backup imediatamente ap√≥s cria√ß√£o
  - ‚úÖ **SEMPRE registrar** nome completo do backup (n√£o apenas parte do nome)
  - ‚úÖ **SEMPRE registrar** timestamp exato do backup
  - ‚úÖ **SEMPRE manter** registro atualizado durante todo o deploy
- üìã **Exemplo de Registro:**
  ```
  ## DEPLOY: Corre√ß√£o CORS UAT - 02/12/2025
  **Vers√£o:** 1.0.0
  **Timestamp In√≠cio:** 20251202_175500
  **Ambiente:** UAT
  
  ### Backups Criados:
  1. [20251202_175500] [UAT] [/var/www/html/uat/root/config.php] ‚Üí [config.php.backup_20251202_175500]
  2. [20251202_175530] [UAT] [/var/www/html/uat/root/MODAL_WHATSAPP_DEFINITIVO.js] ‚Üí [MODAL_WHATSAPP_DEFINITIVO.js.backup_20251202_175530]
  ```
- üìÅ **Documenta√ß√£o:** Registrar em documento de deploy ou log espec√≠fico do deploy
4. ‚úÖ **Exemplo de verifica√ß√£o de hash (case-insensitive):**
   ```powershell
   # Local (Windows PowerShell)
   $hashLocal = (Get-FileHash -Path "arquivo.js" -Algorithm SHA256).Hash.ToUpper()
   
   # Servidor (via SSH) - converter para mai√∫sculas para compara√ß√£o
   $hashServidor = (ssh root@servidor "sha256sum /var/www/html/dev/root/arquivo.js | cut -d' ' -f1").ToUpper()
   
   # Comparar ignorando mai√∫sculas/min√∫sculas (ambos convertidos para mai√∫sculas)
   if ($hashLocal -eq $hashServidor) {
       Write-Host "‚úÖ Hash coincide - arquivo copiado corretamente"
   } else {
       Write-Host "‚ùå Hash n√£o coincide - tentar copiar novamente"
       Write-Host "Local:    $hashLocal"
       Write-Host "Servidor: $hashServidor"
   }
   ```
   - ‚ö†Ô∏è **IMPORTANTE:** Sempre converter ambos os hashes para o mesmo case (mai√∫sculas ou min√∫sculas) antes de comparar
   - ‚úÖ **Recomendado:** Converter ambos para mai√∫sculas usando `.ToUpper()` para compara√ß√£o consistente
5. ‚úÖ **Checklist obrigat√≥rio antes de considerar deploy conclu√≠do:**
   - [ ] Backup criado no servidor?
   - [ ] Arquivo copiado para servidor?
   - [ ] Hash local calculado?
   - [ ] Hash do servidor calculado?
   - [ ] Hashes coincidem?
   - [ ] Se n√£o coincidem, tentar copiar novamente
   - [ ] Deploy s√≥ conclu√≠do ap√≥s hash confirmado

### Metodologia de Deploy Incremental (OBRIGAT√ìRIA) üö® **CR√çTICO**
- üö® **REGRA CR√çTICA:** **SEMPRE usar metodologia incremental** para deploys de m√∫ltiplos arquivos
- ‚úÖ **PROCESSO OBRIGAT√ìRIO para deploys:**
  1. **FASE 1: Preparar Comando para Primeiro Arquivo**
     - ‚úÖ Criar comando de backup para o primeiro arquivo
     - ‚úÖ Validar sintaxe do comando cuidadosamente
     - ‚úÖ Testar comando no primeiro arquivo
     - ‚úÖ Aguardar confirma√ß√£o do usu√°rio antes de prosseguir
  2. **FASE 2: Replicar Comando para Demais Arquivos**
     - ‚úÖ **OBRIGAT√ìRIO:** Usar exatamente a mesma sintaxe do comando testado
     - ‚úÖ Apenas substituir nome do arquivo e caminhos
     - ‚úÖ Manter estrutura, formata√ß√£o e escape de caracteres id√™nticos
     - ‚úÖ **NUNCA modificar sintaxe** ao replicar para outros arquivos
  3. **FASE 3: Executar Sequencialmente**
     - ‚úÖ Executar comandos um por vez (ou em lotes pequenos)
     - ‚úÖ Verificar resultado de cada comando antes de prosseguir
     - ‚úÖ Se um comando falhar, parar e corrigir antes de continuar
- ‚úÖ **Benef√≠cios da Metodologia Incremental:**
  - Detec√ß√£o precoce de erros de sintaxe
  - Valida√ß√£o do comando antes de replicar
  - Facilita identifica√ß√£o de problemas
  - Reduz retrabalho
  - Garante consist√™ncia entre todos os arquivos
- ‚ùå **PROIBI√á√ïES ABSOLUTAS:**
  - ‚ùå **NUNCA criar comandos para m√∫ltiplos arquivos** sem testar primeiro em um arquivo
  - ‚ùå **NUNCA modificar sintaxe** ao replicar comando para outros arquivos
  - ‚ùå **NUNCA executar todos os comandos de uma vez** sem validar primeiro
  - ‚ùå **NUNCA assumir** que comando funcionar√° para todos sem testar
- ‚úÖ **OBRIGA√á√ïES:**
  - ‚úÖ **SEMPRE testar comando** no primeiro arquivo antes de replicar
  - ‚úÖ **SEMPRE usar mesma sintaxe** ao replicar para outros arquivos
  - ‚úÖ **SEMPRE validar resultado** de cada comando antes de prosseguir
  - ‚úÖ **SEMPRE aguardar confirma√ß√£o** do usu√°rio ap√≥s testar primeiro comando
- üìã **Exemplo de Processo Correto:**
  1. **Backup do primeiro arquivo:**
     ```powershell
     ssh root@157.180.36.223 "cp /var/www/html/prod/root/MODAL_WHATSAPP_DEFINITIVO.js /var/www/html/prod/root/MODAL_WHATSAPP_DEFINITIVO.js.backup_20251213_160850 && echo '[OK] Backup criado: MODAL_WHATSAPP_DEFINITIVO.js.backup_20251213_160850'"
     ```
  2. **Testar e validar** resultado do primeiro comando
  3. **Replicar para segundo arquivo** (apenas substituir nome do arquivo):
     ```powershell
     ssh root@157.180.36.223 "cp /var/www/html/prod/root/firebase_backup_leads.js /var/www/html/prod/root/firebase_backup_leads.js.backup_20251213_160850 && echo '[OK] Backup criado: firebase_backup_leads.js.backup_20251213_160850'"
     ```
  4. **Continuar replicando** para todos os demais arquivos usando mesma sintaxe
- üìã **Aplic√°vel a:**
  - Comandos de backup no servidor
  - Comandos de c√≥pia (SCP) para servidor
  - Comandos de verifica√ß√£o de hash
  - Qualquer opera√ß√£o repetitiva em m√∫ltiplos arquivos
- üö® **SE COMANDO FALHAR:**
  - ‚úÖ Parar imediatamente
  - ‚úÖ Corrigir sintaxe do comando
  - ‚úÖ Testar novamente no primeiro arquivo
  - ‚úÖ **SOMENTE ap√≥s sucesso** replicar para outros arquivos

