===============================================================================
                    DIAGRAMA DE EXECUÃ‡ÃƒO - TELA 15
                    RPA TÃ´ Segurado - Playwright
===============================================================================

INÃCIO DA FUNÃ‡ÃƒO navegar_tela_15_playwright()
â”œâ”€â”€ ParÃ¢metros: page, email_login, senha_login, parametros_tempo, parametros
â”œâ”€â”€ InicializaÃ§Ã£o: navegar_tela_15_playwright._ultimo_retorno = None
â””â”€â”€ Try/Catch principal

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                           FASE 1: TIMER REGRESSIVO                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â”€ [AGUARDANDO] Modal com timer (5s timeout)
    â”‚   â””â”€â”€ Busca: "Por favor, aguarde. Estamos buscando o corretor ideal..."
    â”‚       â”œâ”€â”€ âœ… ENCONTRADO â†’ Continua
    â”‚       â””â”€â”€ âŒ NÃƒO ENCONTRADO â†’ Continua mesmo assim
    â”‚
    â”œâ”€â”€ [AGUARDANDO] Timer regressivo (163 segundos = 2:43 min)
    â”‚   â””â”€â”€ Loop verificando: "Tempo estimado em"
    â”‚       â”œâ”€â”€ Timer ativo â†’ Continua aguardando
    â”‚       â””â”€â”€ Timer desaparece â†’ Quebra loop
    â”‚
    â””â”€â”€ [OK] FASE 1 CONCLUÃDA!

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                        FASE 2: TELA DE RESULTADOS                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â”€ [BUSCAR] ETAPA 1: Tela final com resultados (REGRA)
    â”‚   â””â”€â”€ Busca: "ParabÃ©ns, chegamos ao resultado final da cotaÃ§Ã£o!"
    â”‚       â””â”€â”€ TIMEOUT: 180000ms (3 minutos)
    â”‚           â”‚
    â”‚           â”œâ”€â”€ âœ… ENCONTRADO â†’ FLUXO DE SUCESSO
    â”‚           â”‚   â”‚
    â”‚           â”‚   â”œâ”€â”€ [AGUARDANDO] Modal de login
    â”‚           â”‚   â”‚   â””â”€â”€ Busca: "Acesse sua conta para visualizar o resultado final"
    â”‚           â”‚   â”‚       â”œâ”€â”€ âœ… ENCONTRADO â†’ Processa login
    â”‚           â”‚   â”‚       â”‚   â”œâ”€â”€ Preenche email: #emailTelaLogin
    â”‚           â”‚   â”‚       â”‚   â”œâ”€â”€ Preenche senha: #senhaTelaLogin
    â”‚           â”‚   â”‚       â”‚   â”œâ”€â”€ Clica: #gtm-telaLoginBotaoAcessar
    â”‚           â”‚   â”‚       â”‚   â””â”€â”€ Trata modal CPF divergente se aparecer
    â”‚           â”‚   â”‚       â””â”€â”€ âŒ NÃƒO ENCONTRADO â†’ Continua sem login
    â”‚           â”‚   â”‚
    â”‚           â”‚   â”œâ”€â”€ [DADOS] Captura dados dos planos
    â”‚           â”‚   â”‚   â””â”€â”€ Chama: capturar_dados_planos_seguro()
    â”‚           â”‚   â”‚       â”œâ”€â”€ âœ… SUCESSO â†’ Retorna dados estruturados
    â”‚           â”‚   â”‚       â””â”€â”€ âŒ FALHA â†’ Retorna dados vazios
    â”‚           â”‚   â”‚
    â”‚           â”‚   â””â”€â”€ [OK] TELA 15 FINALIZADA COM SUCESSO!
    â”‚           â”‚       â””â”€â”€ return True
    â”‚           â”‚
    â”‚           â””â”€â”€ âŒ NÃƒO ENCONTRADO â†’ FLUXO DE EXCEÃ‡ÃƒO
    â”‚               â”‚
    â”‚               â”œâ”€â”€ [BUSCAR] ETAPA 3: Verificar cotaÃ§Ã£o manual
    â”‚               â”‚   â””â”€â”€ Busca: 'p.text-center.text-base' (10s timeout)
    â”‚               â”‚       â”‚
    â”‚               â”‚       â”œâ”€â”€ âœ… ENCONTRADO â†’ Verifica texto
    â”‚               â”‚       â”‚   â””â”€â”€ Texto: "Ops, ainda nÃ£o encontramos resultados para vocÃª"
    â”‚               â”‚       â”‚       â”‚
    â”‚               â”‚       â”‚       â”œâ”€â”€ âœ… Ã‰ COTAÃ‡ÃƒO MANUAL â†’ ğŸš¨ PROBLEMA IDENTIFICADO!
    â”‚               â”‚       â”‚       â”‚   â”‚
    â”‚               â”‚       â”‚       â”‚   â”œâ”€â”€ Chama: processar_cotacao_manual()
    â”‚               â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ Captura dados do usuÃ¡rio
    â”‚               â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ Salva em arquivo JSON
    â”‚               â”‚       â”‚       â”‚   â”‚   â””â”€â”€ return True
    â”‚               â”‚       â”‚       â”‚   â”‚
    â”‚               â”‚       â”‚       â”‚   â”œâ”€â”€ âŒ ERRO: "[OK] COTAÃ‡ÃƒO MANUAL PROCESSADA COM SUCESSO!"
    â”‚               â”‚       â”‚       â”‚   â””â”€â”€ âŒ ERRO: return True (deveria ser erro!)
    â”‚               â”‚       â”‚       â”‚
    â”‚               â”‚       â”‚       â””â”€â”€ âŒ NÃƒO Ã‰ COTAÃ‡ÃƒO MANUAL â†’ Continua
    â”‚               â”‚       â”‚
    â”‚               â”‚       â””â”€â”€ âŒ NÃƒO ENCONTRADO â†’ Continua
    â”‚               â”‚
    â”‚               â””â”€â”€ [ERRO] ETAPA 4: Nenhuma tela esperada encontrada
    â”‚                   â””â”€â”€ Chama: criar_retorno_erro_tela_final_nao_detectada()
    â”‚                       â”œâ”€â”€ CÃ³digo: 9004
    â”‚                       â”œâ”€â”€ Mensagem: "Infelizmente nÃ£o foi possÃ­vel..."
    â”‚                       â””â”€â”€ return retorno_erro

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                        TRATAMENTO DE ERROS                              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â””â”€â”€ [ERRO] ERRO na Tela 15
        â””â”€â”€ return False

===============================================================================
                            PROBLEMAS IDENTIFICADOS
===============================================================================

ğŸš¨ PROBLEMA 1: Linha 4021
   Mensagem: "[OK] COTAÃ‡ÃƒO MANUAL PROCESSADA COM SUCESSO!"
   Status: INCORRETO
   CorreÃ§Ã£o: Deveria ser "[ERRO] COTAÃ‡ÃƒO MANUAL NECESSÃRIA!"

ğŸš¨ PROBLEMA 2: Linha 4022
   Retorno: return True
   Status: INCORRETO
   CorreÃ§Ã£o: Deveria retornar erro especÃ­fico (cÃ³digo 9003)

ğŸš¨ PROBLEMA 3: LÃ³gica conceitual
   CotaÃ§Ã£o manual = ERRO do sistema automatizado
   Status: INCORRETO
   CorreÃ§Ã£o: Tratar como falha, nÃ£o sucesso

===============================================================================
                            FLUXOS POSSÃVEIS
===============================================================================

FLUXO 1: SUCESSO COMPLETO
Tela Final â†’ Login â†’ Captura Dados â†’ return True

FLUXO 2: SUCESSO SEM LOGIN
Tela Final â†’ Sem Login â†’ Captura Dados â†’ return True

FLUXO 3: COTAÃ‡ÃƒO MANUAL (ATUAL - INCORRETO)
Timeout Tela Final â†’ CotaÃ§Ã£o Manual â†’ return True âŒ

FLUXO 4: ERRO GERAL
Timeout Tela Final â†’ Sem CotaÃ§Ã£o Manual â†’ return erro 9004

FLUXO 5: ERRO DE EXCEÃ‡ÃƒO
Erro geral â†’ return False

===============================================================================
                            FUNÃ‡Ã•ES AUXILIARES
===============================================================================

processar_cotacao_manual()
â”œâ”€â”€ Captura dados do usuÃ¡rio
â”œâ”€â”€ Salva em arquivo JSON
â””â”€â”€ return True (INCORRETO - deveria ser erro)

capturar_dados_planos_seguro()
â”œâ”€â”€ Busca containers dos planos
â”œâ”€â”€ Extrai dados estruturados
â”œâ”€â”€ Salva em arquivo JSON
â””â”€â”€ return dados_planos ou erro

criar_retorno_erro_tela_final_nao_detectada()
â”œâ”€â”€ CÃ³digo: 9004
â”œâ”€â”€ Status: erro
â””â”€â”€ return retorno_erro

===============================================================================
