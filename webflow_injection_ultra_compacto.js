(function(){"use strict";class SpinnerTimer{constructor(){this.initialDuration=180;this.extendedDuration=120;this.totalDuration=this.initialDuration;this.remainingSeconds=this.initialDuration;this.isRunning=false;this.isExtended=false;this.interval=null;this.elements={spinnerCenter:null,timerMessage:null}}init(){this.elements.spinnerCenter=document.getElementById("spinnerCenter");this.elements.timerMessage=document.getElementById("timerMessage");if(!this.elements.spinnerCenter){return}this.start()}start(){this.isRunning=true;this.isExtended=false;this.totalDuration=this.initialDuration;this.remainingSeconds=this.initialDuration;this.interval=setInterval(()=>{this.tick()},100)}tick(){this.remainingSeconds-=.1;if(this.remainingSeconds<=0){if(!this.isExtended){this.extendTimer();return}else{this.finish();return}}this.updateDisplay()}extendTimer(){this.isExtended=true;this.totalDuration+=this.extendedDuration;this.remainingSeconds=this.extendedDuration;if(this.elements.timerMessage){this.elements.timerMessage.style.display="block"}}finish(){this.isRunning=false;this.remainingSeconds=0;this.updateDisplay();clearInterval(this.interval)}updateDisplay(){const minutes=Math.floor(this.remainingSeconds/60);const seconds=Math.floor(this.remainingSeconds%60);const centiseconds=Math.floor(this.remainingSeconds%1*10);const timerText=`${minutes.toString().padStart(2,"0")}:${seconds.toString().padStart(2,"0")}.${centiseconds}`;if(this.elements.spinnerCenter){this.elements.spinnerCenter.textContent=timerText}}stop(){this.isRunning=false;clearInterval(this.interval)}reset(){this.stop();this.isExtended=false;this.totalDuration=this.initialDuration;this.remainingSeconds=this.initialDuration;if(this.elements.timerMessage){this.elements.timerMessage.style.display="none"}this.updateDisplay()}}class ProgressModalRPA{constructor(sessionId){this.apiBaseUrl="https://rpaimediatoseguros.com.br";this.sessionId=sessionId;this.progressInterval=null;this.isProcessing=true;this.spinnerTimer=null;this.setSessionId(sessionId);this.spinnerTimerInitialized=false;this.initialEstimateUpdated=false;this.phaseMessages={1:"üîÑ Iniciando sistema...",2:"üîê Fazendo login no sistema",3:"üåê Acessando p√°gina de cota√ß√£o",4:"üìù Validando dados pessoais",5:"üöó Validando informa√ß√µes do ve√≠culo",6:"üìç Validando Endere√ßo",7:"üÖøÔ∏è Identificando perfil de endere√ßo",8:"üìä Analisando perfil de risco",9:"üîç Buscando melhores seguradoras",10:"üìã Coletando cota√ß√µes dispon√≠veis",11:"‚öñÔ∏è Comparando propostas",12:"üéØ Selecionando melhor op√ß√£o",13:"üìÑ Gerando proposta final",14:"‚úÖ Validando dados finais",15:"‚öôÔ∏è Finalizando processamento...",16:"üéâ Multi-c√°lculo completo"};this.phaseSubMessages={1:"Preparando ambiente de c√°lculo",2:"Conectando com sistema seguro",3:"Carregando formul√°rio de cota√ß√£o",4:"Verificando informa√ß√µes pessoais",5:"Validando dados do ve√≠culo",6:"Confirmando endere√ßo de risco",7:"Analisando localiza√ß√£o",8:"Calculando perfil de risco",9:"Consultando seguradoras",10:"Coletando cota√ß√µes",11:"Comparando propostas",12:"Selecionando melhor op√ß√£o",13:"Gerando proposta",14:"Validando dados",15:"",16:"Seu seguro foi calculado com sucesso!"};this.phasePercentages={0:0,1:6.25,2:12.5,3:18.75,4:25,5:31.25,6:37.5,7:43.75,8:50,9:56.25,10:62.5,11:68.75,12:75,13:81.25,14:87.5,15:93.75,16:100}}setSessionId(sessionId){this.sessionId=sessionId;if(!this.spinnerTimerInitialized){this.initSpinnerTimer();this.spinnerTimerInitialized=true}}initSpinnerTimer(){if(!this.spinnerTimer){this.spinnerTimer=new SpinnerTimer;this.spinnerTimer.init();this.spinnerTimer.start()}}stopSpinnerTimer(){try{if(this.spinnerTimer){this.spinnerTimer.finish();this.spinnerTimer=null}const spinnerContainer=document.getElementById("spinnerTimerContainer");if(spinnerContainer){spinnerContainer.style.display="none"}}catch(error){const container=document.getElementById("spinnerTimerContainer");if(container){container.style.display="none"}}}startProgressPolling(){if(!this.sessionId){return}this.pollCount=0;this.maxPolls=300;this.progressInterval=setInterval(()=>{this.pollCount++;if(this.pollCount>this.maxPolls){this.stopProgressPolling();this.stopSpinnerTimer();this.showErrorAlert("O processamento est√° demorando mais que o esperado (10 minutos). Tente novamente ou entre em contato conosco.");return}this.updateProgress()},2e3)}stopProgressPolling(){if(this.progressInterval){clearInterval(this.progressInterval);this.progressInterval=null}}async updateProgress(){if(!this.sessionId)return;try{const response=await fetch(`${this.apiBaseUrl}/api/rpa/progress/${this.sessionId}`);const data=await response.json();if(data.success){const progressData=data.progress;const currentStatus=progressData.status||"processing";const mensagem=progressData.mensagem||"";this.lastProgressData=progressData;const errorCode=progressData.error_code||progressData.status_code||progressData.dados_extra?.error_code||progressData.dados_extra?.status_code;if(this.isErrorStatus(currentStatus,mensagem,errorCode)){this.handleRPAError(mensagem||`Status: ${currentStatus}`,errorCode);return}let currentPhase=progressData.fase_atual||progressData.etapa_atual||1;if(currentStatus==="success"){currentPhase=16}let percentual=this.phasePercentages[currentPhase]||0;const totalEtapas=16;this.updateProgressElements(percentual,currentPhase,currentStatus,progressData,totalEtapas);if(progressData.estimativas?.dados||progressData.dados_extra?.estimativas_tela_5){this.updateInitialEstimate(progressData)}if(progressData.dados_extra||currentStatus==="success"){this.updateResults(progressData);this.updateSuccessHeader();if(currentStatus==="success"){this.stopProgressPolling();this.isProcessing=false;this.stopSpinnerTimer()}}}}catch(error){}}isErrorStatus(status,mensagem,errorCode=null){const statusLower=status.toLowerCase();const mensagemLower=mensagem.toLowerCase();const errorStatuses=["error","failed","failure","exception","timeout","denied","invalid","blocked","cancelled","aborted"];const errorKeywords=["falhou","erro","failed","error","exception","timeout","denied","invalid","blocked","cancelled"];const errorCodes=["400","401","403","404","405","408","409","410","422","429","500","501","502","503","504","9003","9004"];if(errorCode){const codeStr=String(errorCode);for(const code of errorCodes){if(codeStr.includes(code)){return true}}}for(const errorStatus of errorStatuses){if(statusLower.includes(errorStatus)){return true}}for(const keyword of errorKeywords){if(mensagemLower.includes(keyword)){return true}}for(const code of errorCodes){if(mensagemLower.includes(`erro ${code}`)||mensagemLower.includes(`error ${code}`)||mensagemLower.includes(`code ${code}`)||mensagemLower.includes(`${code} error`)){return true}}return false}handleRPAError(mensagem,errorCode=null){this.stopProgressPolling();this.isProcessing=false;this.stopSpinnerTimer();const modal=document.getElementById("rpaModal");if(modal){modal.remove()}if(typeof Swal!=="undefined"){Swal.fire({title:"üìû Cota√ß√£o Manual Necess√°ria",text:"N√£o foi poss√≠vel efetuar o c√°lculo nesse momento. Um especialista da Imediato Seguros far√° o c√°lculo manualmente e entrar√° em contato para envia-lo √† voc√™ em seguida.",icon:"info",confirmButtonText:"Entendi",confirmButtonColor:"#3085d6"})}}showErrorAlert(mensagem,acao=null,errorCode=null){if(typeof Swal!=="undefined"){Swal.fire({title:"üìû Cota√ß√£o Manual Necess√°ria",text:"N√£o foi poss√≠vel efetuar o c√°lculo nesse momento. Um especialista da Imediato Seguros far√° o c√°lculo manualmente e entrar√° em contato para envia-lo √† voc√™ em seguida.",icon:"info",confirmButtonText:"Entendi",confirmButtonColor:"#3085d6"})}else{alert("üìû Cota√ß√£o Manual Necess√°ria\n\nN√£o foi poss√≠vel efetuar o c√°lculo nesse momento. Um especialista da Imediato Seguros far√° o c√°lculo manualmente e entrar√° em contato para envia-lo √† voc√™ em seguida.")}}updateProgressElements(percentual,currentPhase,currentStatus,progressData,totalEtapas=16){const progressText=document.querySelector("#rpaModal .progress-text");const currentPhaseElement=document.querySelector("#rpaModal .current-phase");const subPhaseElement=document.querySelector("#rpaModal .sub-phase");const stageInfo=document.querySelector("#rpaModal .stage-info");const progressFill=document.querySelector("#rpaModal .progress-bar-fill");if(progressText){progressText.textContent=`${Math.round(percentual)}%`}if(currentPhaseElement){const message=this.getPhaseMessage(currentPhase);currentPhaseElement.textContent=message}if(subPhaseElement){const subMessage=this.getPhaseSubMessage(currentPhase);subPhaseElement.textContent=subMessage}if(stageInfo){stageInfo.textContent=`Fase ${currentPhase} de ${totalEtapas}`}if(progressFill){progressFill.style.width=`${percentual}%`}}getPhaseMessage(phaseNumber){return this.phaseMessages[phaseNumber]||`Fase ${phaseNumber}`}getPhaseSubMessage(phaseNumber){return this.phaseSubMessages[phaseNumber]||""}updateInitialEstimate(data){if(this.initialEstimateUpdated)return;const estimativas=data.estimativas?.dados||data.dados_extra?.estimativas_tela_5||data.historico?.estimativas||data.progress?.estimativas;if(estimativas){let valorInicial=null;if(estimativas.coberturas_detalhadas?.valor_total){valorInicial=estimativas.coberturas_detalhadas.valor_total}else if(estimativas.valor_total){valorInicial=estimativas.valor_total}else if(estimativas.valor){valorInicial=estimativas.valor}else if(typeof estimativas==="number"){valorInicial=estimativas}if(valorInicial){const valorFormatado=this.formatCurrency(valorInicial);const initialEstimateElement=document.getElementById("initialEstimate");if(initialEstimateElement){initialEstimateElement.textContent=valorFormatado;this.highlightInitialEstimate()}this.initialEstimateUpdated=true}}}highlightInitialEstimate(){const estimateCard=document.querySelector("#rpaModal .result-card.recommended");if(estimateCard){estimateCard.style.animation="pulse 2s infinite"}}updateResults(data){let resultados=null;let planoRecomendado=null;let planoAlternativo=null;if(data.resultados_finais?.dados?.dados_finais){resultados=data.resultados_finais.dados.dados_finais;planoRecomendado=resultados.plano_recomendado;planoAlternativo=resultados.plano_alternativo}if(!planoRecomendado&&data.timeline){const finalEntry=data.timeline.find(entry=>entry.etapa==="final");if(finalEntry?.dados_extra){planoRecomendado=finalEntry.dados_extra.plano_recomendado;planoAlternativo=finalEntry.dados_extra.plano_alternativo}}if(!planoRecomendado&&data.dados_extra){planoRecomendado=data.dados_extra.plano_recomendado;planoAlternativo=data.dados_extra.plano_alternativo}if(planoRecomendado&&planoAlternativo){this.updateCardValue("recommendedValue",planoRecomendado.valor);this.updateCardValue("alternativeValue",planoAlternativo.valor);this.updateCardDetails("recommended",planoRecomendado);this.updateCardDetails("alternative",planoAlternativo)}}updateCardValue(elementId,valor){if(valor){const element=document.querySelector(`#rpaModal #${elementId}`);if(element){const valorFormatado=this.formatCurrency(valor);element.textContent=valorFormatado}}}updateCardDetails(prefix,plano){if(!plano)return;const formatCheck=value=>value?'<i class="fas fa-check text-success"></i>':'<i class="fas fa-times text-danger"></i>';const formatMoney=value=>{if(!value||value==="-")return"-";if(typeof value==="string"&&value.includes("R$")){return value}if(typeof value==="number"){return this.formatCurrency(value)}const numValue=parseFloat(value.toString().replace(/[^\d,.-]/g,"").replace(",","."));if(!isNaN(numValue)){return this.formatCurrency(numValue)}return`R$ ${value}`};this.updateField(`${prefix}FormaPagamento`,plano.forma_pagamento||"-");this.updateField(`${prefix}Parcelamento`,plano.parcelamento||"-");this.updateField(`${prefix}ValorMercado`,plano.valor_mercado||"-");this.updateField(`${prefix}ValorFranquia`,formatMoney(plano.valor_franquia||"-"));this.updateField(`${prefix}TipoFranquia`,plano.tipo_franquia||"-");this.updateField(`${prefix}Assistencia`,formatCheck(plano.assistencia));this.updateField(`${prefix}Vidros`,formatCheck(plano.vidros));this.updateField(`${prefix}CarroReserva`,formatCheck(plano.carro_reserva));this.updateField(`${prefix}DanosMateriais`,formatMoney(plano.danos_materiais||"-"));this.updateField(`${prefix}DanosCorporais`,formatMoney(plano.danos_corporais||"-"));this.updateField(`${prefix}DanosMorais`,formatMoney(plano.danos_morais||"-"));this.updateField(`${prefix}MorteInvalidez`,formatMoney(plano.morte_invalidez||"-"))}updateField(elementId,value){const element=document.querySelector(`#rpaModal #${elementId}`);if(element){element.innerHTML=value}}updateSuccessHeader(){const progressHeader=document.querySelector("#rpaModal .progress-header");if(progressHeader){const contactMessage=document.createElement("p");contactMessage.className="contact-message";contactMessage.innerHTML='<i class="fas fa-phone"></i> Um especialista da Imediato Seguros entrar√° em contato em instantes para passar os detalhes!';progressHeader.appendChild(contactMessage)}}formatCurrency(value){if(!value)return"R$ 0,00";if(typeof value==="string"&&value.includes("R$")){return value}let numericValue;if(typeof value==="string"){const cleanValue=value.replace(/[R$\s]/g,"").replace(",",".");numericValue=parseFloat(cleanValue)}else{numericValue=parseFloat(value)}if(isNaN(numericValue)){return"R$ 0,00"}const formatted=numericValue.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});return formatted}}class MainPage{constructor(){this.sessionId=null;this.modalProgress=null;this.fixedData={telefone:"11999999999",email:"cliente@exemplo.com",profissao:"Empres√°rio",renda_mensal:"10000",modelo:"Civic",ano:"2020",cor:"Prata",combustivel:"Flex",zero_km:"false",uso:"Particular",garagem:"true",tipo_seguro:"Comprehensive",franquia:"500",cobertura_terceiros:"true",cobertura_vidros:"true",cobertura_carro_reserva:"true",cobertura_assistencia:"true"};this.init()}init(){this.setupEventListeners()}setupEventListeners(){if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",()=>{this.setupFormSubmission()})}else{this.setupFormSubmission()}}setupFormSubmission(){const forms=document.querySelectorAll("form");const submitButton=document.getElementById("submit_button_auto");if(submitButton){submitButton.addEventListener("click",e=>{e.preventDefault();e.stopPropagation();const form=submitButton.closest("form");if(form){this.handleFormSubmit(form)}})}forms.forEach((form,index)=>{form.addEventListener("submit",e=>{e.preventDefault();this.handleFormSubmit(form)})})}collectFormData(form){const formData=new FormData(form);const data={};for(let[key,value]of formData.entries()){data[key]=value}const gclidField=document.getElementById("GCLID_FLD");if(gclidField){data.GCLID_FLD=gclidField.value||"TesteRPA123"}else{data.GCLID_FLD="TesteRPA123"}this.applyFieldConversions(data);const cleanedData=this.removeDuplicateFields(data);const completeData={...this.fixedData,...cleanedData};return completeData}removeDuplicateFields(data){const cleanedData={...data};const fieldsToRemove=["DATA-DE-NASCIMENTO","SEXO","ESTADO-CIVIL","DDD-CELULAR","CELULAR","PLACA","MARCA","ANO","TIPO-DE-VEICULO","CEP","CPF"];fieldsToRemove.forEach(field=>{if(cleanedData[field]){delete cleanedData[field]}});return cleanedData}applyFieldConversions(data){if(data["ESTADO-CIVIL"]){data.estado_civil=this.convertEstadoCivil(data["ESTADO-CIVIL"])}if(data.SEXO){data.sexo=this.convertSexo(data.SEXO)}if(data["TIPO-DE-VEICULO"]){data.tipo_veiculo=this.convertTipoVeiculo(data["TIPO-DE-VEICULO"])}if(data["DDD-CELULAR"]&&data.CELULAR&&!data.telefone){data.telefone=data["DDD-CELULAR"]+data.CELULAR}const fieldMapping={CPF:"cpf",PLACA:"placa",MARCA:"marca",CEP:"cep","DATA-DE-NASCIMENTO":"data_nascimento"};Object.keys(fieldMapping).forEach(webflowField=>{if(data[webflowField]){data[fieldMapping[webflowField]]=data[webflowField]}});if(data["TIPO-DE-VEICULO"]){data.tipo_veiculo=this.convertTipoVeiculo(data["TIPO-DE-VEICULO"])}}convertEstadoCivil(webflowValue){if(!webflowValue)return"";const normalized=webflowValue.toLowerCase().trim().replace(/[√†√°√¢√£√§√•]/g,"a").replace(/[√®√©√™√´]/g,"e").replace(/[√¨√≠√Æ√Ø]/g,"i").replace(/[√≤√≥√¥√µ√∂]/g,"o").replace(/[√π√∫√ª√º]/g,"u").replace(/[√ß]/g,"c").replace(/[√±]/g,"n").replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ");const estadoCivilMapping={solteiro:"Solteiro",sol:"Solteiro",single:"Solteiro",solteira:"Solteiro",casado:"Casado",cas:"Casado",married:"Casado",casada:"Casado","casado ou uniao estavel":"Casado ou Uniao Estavel","casado ou uniao":"Casado ou Uniao Estavel","casado uniao estavel":"Casado ou Uniao Estavel","casado uniao":"Casado ou Uniao Estavel","uniao estavel":"Casado ou Uniao Estavel",uniao:"Casado ou Uniao Estavel","casado ou uni√£o est√°vel":"Casado ou Uniao Estavel","casado ou uni√£o":"Casado ou Uniao Estavel","casado uni√£o est√°vel":"Casado ou Uniao Estavel","casado uni√£o":"Casado ou Uniao Estavel","uni√£o est√°vel":"Casado ou Uniao Estavel","uni√£o":"Casado ou Uniao Estavel",divorciado:"Divorciado",div:"Divorciado",divorced:"Divorciado",divorciada:"Divorciado",separado:"Separado",sep:"Separado",separated:"Separado",separada:"Separado",viuvo:"Viuvo",viuva:"Viuvo",widowed:"Viuvo","vi√∫vo":"Viuvo","vi√∫va":"Viuvo"};if(estadoCivilMapping[normalized]){return estadoCivilMapping[normalized]}for(const[key,value]of Object.entries(estadoCivilMapping)){if(normalized.includes(key)||key.includes(normalized)){return value}}return webflowValue.charAt(0).toUpperCase()+webflowValue.slice(1).toLowerCase()}convertSexo(webflowValue){if(!webflowValue)return"";const normalized=webflowValue.toLowerCase().trim();const sexoMapping={m:"Masculino",masculino:"Masculino",male:"Masculino",masculina:"Masculino",masculino:"Masculino",mas:"Masculino",mascul:"Masculino",f:"Feminino",feminino:"Feminino",female:"Feminino",feminina:"Feminino",feminino:"Feminino",fem:"Feminino",femin:"Feminino"};if(sexoMapping[normalized]){return sexoMapping[normalized]}for(const[key,value]of Object.entries(sexoMapping)){if(normalized.includes(key)||key.includes(normalized)){return value}}return webflowValue.charAt(0).toUpperCase()+webflowValue.slice(1).toLowerCase()}convertTipoVeiculo(webflowValue){if(!webflowValue)return"carro";const tipo=webflowValue.toLowerCase().trim();const tiposCarro=["sedan","hatch","hatchback","suv","pickup","crossover","wagon","coupe","convertible","carro","automovel"];const tiposMoto=["moto","motocicleta","scooter","bike","motoneta"];for(const tipoCarro of tiposCarro){if(tipo.includes(tipoCarro)||tipoCarro.includes(tipo)){return"carro"}}for(const tipoMoto of tiposMoto){if(tipo.includes(tipoMoto)||tipoMoto.includes(tipo)){return"moto"}}return"carro"}async handleFormSubmit(form){try{this.updateButtonLoading(true);const formData=this.collectFormData(form);const validationResult=await this.validateFormData(formData);if(!validationResult.isValid){await this.showValidationAlert(validationResult.errors);this.updateButtonLoading(false);return}window.rpaData={telefone:formData.telefone};this.openProgressModal();const response=await fetch("https://rpaimediatoseguros.com.br/api/rpa/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(formData)});const result=await response.json();if(result.success&&result.session_id){this.sessionId=result.session_id;this.initializeProgressModal()}else{this.updateButtonLoading(false);this.showError("Erro ao iniciar o c√°lculo. Tente novamente.")}}catch(error){this.updateButtonLoading(false);this.showError("Erro de conex√£o. Verifique sua internet e tente novamente.")}}initializeProgressModal(){setTimeout(()=>{if(window.ProgressModalRPA){this.modalProgress=new window.ProgressModalRPA(this.sessionId);window.progressModal=this.modalProgress;this.modalProgress.startProgressPolling()}},200)}async validateFormData(formData){const validator=new FormValidator;const telefoneCompleto=formData.telefone||"";const ddd=telefoneCompleto.substring(0,2);const celular=telefoneCompleto.substring(2);const[cpfResult,cepResult,placaResult,celularResult,emailResult]=await Promise.all([validator.validateCPF(formData.cpf),validator.validateCEP(formData.cep),validator.validatePlaca(formData.placa),validator.validateCelular(ddd,celular),validator.validateEmail(formData.email)]);const isValid=cpfResult.ok&&cepResult.ok&&placaResult.ok&&celularResult.ok&&emailResult.ok;if(placaResult.ok&&placaResult.parsed){this.setFieldValue("MARCA",placaResult.parsed.marcaTxt);this.setFieldValue("ANO",placaResult.parsed.anoModelo);this.setFieldValue("TIPO-DE-VEICULO",placaResult.parsed.tipoVeiculo)}return{isValid:isValid,errors:{cpf:cpfResult,cep:cepResult,placa:placaResult,celular:celularResult,email:emailResult}}}async showValidationAlert(errors){let errorLines="";if(!errors.cpf.ok){errorLines+="‚Ä¢ CPF inv√°lido\n"}if(!errors.cep.ok){errorLines+="‚Ä¢ CEP inv√°lido\n"}if(!errors.placa.ok){errorLines+="‚Ä¢ Placa inv√°lida\n"}if(!errors.celular.ok){errorLines+="‚Ä¢ Celular inv√°lido\n"}if(!errors.email.ok){errorLines+="‚Ä¢ E-mail inv√°lido\n"}const result=await Swal.fire({icon:"info",title:"Aten√ß√£o!",html:"‚ö†Ô∏è Os campos CPF, CEP, PLACA, CELULAR e E-MAIL corretamente preenchidos s√£o necess√°rios para efetuar o c√°lculo do seguro.\n\n"+"Campos com problema:\n\n"+errorLines+"\n"+"Caso decida prosseguir assim mesmo, um especialista entrar√° em contato para coletar esses dados.",showCancelButton:true,confirmButtonText:"Prosseguir assim mesmo",cancelButtonText:"Corrigir",reverseButtons:true,allowOutsideClick:false,allowEscapeKey:true});if(result.isConfirmed){window.location.href="https://www.segurosimediato.com.br/sucesso"}else{this.focusFirstErrorField(errors)}}focusFirstErrorField(errors){if(!errors.cpf.ok){const cpfField=document.getElementById("CPF")||document.querySelector('[name="CPF"]');if(cpfField){cpfField.focus();return}}if(!errors.cep.ok){const cepField=document.getElementById("CEP")||document.querySelector('[name="CEP"]');if(cepField){cepField.focus();return}}if(!errors.placa.ok){const placaField=document.getElementById("PLACA")||document.querySelector('[name="PLACA"]');if(placaField){placaField.focus();return}}if(!errors.celular.ok){const celularField=document.getElementById("CELULAR")||document.querySelector('[name="CELULAR"]');if(celularField){celularField.focus();return}}if(!errors.email.ok){const emailField=document.getElementById("email")||document.querySelector('[name="email"]');if(emailField){emailField.focus();return}}}setFieldValue(id,val){const field=document.getElementById(id)||document.querySelector(`[name="${id}"]`);if(field){field.value=val;field.dispatchEvent(new Event("input",{bubbles:true}));field.dispatchEvent(new Event("change",{bubbles:true}))}}showError(message){const existingModal=document.getElementById("rpaModal");if(existingModal){existingModal.remove()}alert(message);this.updateButtonLoading(false)}updateButtonLoading(isLoading){const submitButton=document.getElementById("submit_button_auto");if(submitButton){if(isLoading){submitButton.textContent="Aguarde...";submitButton.disabled=true}else{submitButton.textContent="CALCULE AGORA!";submitButton.disabled=false}}}ensureFontAwesomeLoaded(){return new Promise(resolve=>{const existingFA=document.querySelector('link[href*="font-awesome"]')||document.querySelector('link[href*="fontawesome"]')||document.querySelector('link[href*="font-awesome"]');if(existingFA){setTimeout(()=>{resolve()},100);return}const fontAwesome=document.createElement("link");fontAwesome.rel="stylesheet";fontAwesome.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css";fontAwesome.crossOrigin="anonymous";fontAwesome.onload=()=>{setTimeout(()=>{resolve()},200)};fontAwesome.onerror=()=>{resolve()};document.head.appendChild(fontAwesome)})}openProgressModal(){this.ensureFontAwesomeLoaded();const existingModal=document.getElementById("rpaModal");if(existingModal){existingModal.remove()}const modalHTML=`<div id="rpaModal" class="show"><button class="modal-close-btn" onclick="document.getElementById('rpaModal').remove()"><i class="fas fa-times"></i></button><div class="modal-progress-bar"><div class="progress-header"><div class="logo-container"><img src="https://cdn.prod.website-files.com/59eb807f9d16950001e202af/5f845624fe08f9f0d0573fee_logotipo-imediato-seguros.svg" alt="Imediato Seguros" class="company-logo"></div><h1><i class="fas fa-calculator"></i> Calculadora de Seguro da Imediato Seguros</h1><div class="progress-info"><span class="progress-text" id="progressText">0%</span><span class="current-phase" id="currentPhase">Iniciando Multi-C√°lculo...</span><span class="sub-phase" id="subPhase"></span></div><div class="progress-stages"><span class="stage-info" id="stageInfo">Fase 0 de 16</span></div></div><div class="progress-bar-wrapper"><div class="progress-bar-container"><div class="progress-bar-fill" id="progressBarFill" style="width: 0%"></div></div></div></div><div class="modal-content"><div class="results-container"><div class="result-card recommended"><div class="card-header"><div class="card-icon"><i class="fas fa-star"></i></div><div class="card-title"><h3>Recomendado</h3></div><div class="card-value-inline"><div class="value" id="recommendedValue">R$ 0,00</div></div></div><ul class="card-features"><li>Forma de Pagamento: <span class="feature-value" id="recommendedFormaPagamento">-</span></li><li>Parcelamento: <span class="feature-value" id="recommendedParcelamento">-</span></li><li>Valor de Mercado: <span class="feature-value" id="recommendedValorMercado">-</span></li><li>Valor da Franquia: <span class="feature-value" id="recommendedValorFranquia">-</span></li><li>Tipo de Franquia: <span class="feature-value" id="recommendedTipoFranquia">-</span></li><li>Cobertura de Assist√™ncia: <span class="feature-value" id="recommendedAssistencia">-</span></li><li>Cobertura de Vidros: <span class="feature-value" id="recommendedVidros">-</span></li><li>Cobertura de Carro Reserva: <span class="feature-value" id="recommendedCarroReserva">-</span></li><li>Cobertura de Danos Materiais: <span class="feature-value" id="recommendedDanosMateriais">-</span></li><li>Cobertura de Danos Corporais: <span class="feature-value" id="recommendedDanosCorporais">-</span></li><li>Cobertura de Danos Morais: <span class="feature-value" id="recommendedDanosMorais">-</span></li><li>Cobertura de Morte e Invalidez Permanente: <span class="feature-value" id="recommendedMorteInvalidez">-</span></li></ul></div><div class="result-card alternative"><div class="card-header"><div class="card-icon"><i class="fas fa-shield-alt"></i></div><div class="card-title"><h3>Alternativo</h3></div><div class="card-value-inline"><div class="value" id="alternativeValue">R$ 0,00</div></div></div><ul class="card-features"><li>Forma de Pagamento: <span class="feature-value" id="alternativeFormaPagamento">-</span></li><li>Parcelamento: <span class="feature-value" id="alternativeParcelamento">-</span></li><li>Valor de Mercado: <span class="feature-value" id="alternativeValorMercado">-</span></li><li>Valor da Franquia: <span class="feature-value" id="alternativeValorFranquia">-</span></li><li>Tipo de Franquia: <span class="feature-value" id="alternativeTipoFranquia">-</span></li><li>Cobertura de Assist√™ncia: <span class="feature-value" id="alternativeAssistencia">-</span></li><li>Cobertura de Vidros: <span class="feature-value" id="alternativeVidros">-</span></li><li>Cobertura de Carro Reserva: <span class="feature-value" id="alternativeCarroReserva">-</span></li><li>Cobertura de Danos Materiais: <span class="feature-value" id="alternativeDanosMateriais">-</span></li><li>Cobertura de Danos Corporais: <span class="feature-value" id="alternativeDanosCorporais">-</span></li><li>Cobertura de Danos Morais: <span class="feature-value" id="alternativeDanosMorais">-</span></li><li>Cobertura de Morte e Invalidez Permanente: <span class="feature-value" id="alternativeMorteInvalidez">-</span></li></ul></div></div><div class="spinner-timer-container" id="spinnerTimerContainer" style="display: none;"><div class="spinner-container"><div class="sk-circle" id="skCircle"><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div><div class="sk-child"></div></div><div class="spinner-center" id="spinnerCenter">03:00</div></div><div class="timer-message" id="timerMessage" style="display: none;">‚è∞ Est√° demorando mais que o normal. Aguardando mais 2 minutos...</div></div></div></div>`;document.body.insertAdjacentHTML("beforeend",modalHTML);setTimeout(()=>{const spinnerContainer=document.getElementById("spinnerTimerContainer");if(spinnerContainer){spinnerContainer.style.display="flex"}},2e3)}window.SpinnerTimer=SpinnerTimer;window.ProgressModalRPA=ProgressModalRPA;window.MainPage=MainPage;if(!document.querySelector('link[href*="font-awesome"]')&&!document.querySelector('link[href*="fontawesome"]')){const fontAwesome=document.createElement("link");fontAwesome.rel="stylesheet";fontAwesome.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css";fontAwesome.crossOrigin="anonymous";document.head.appendChild(fontAwesome)}if(!document.querySelector('script[src*="sweetalert2"]')){const sweetAlertScript=document.createElement("script");sweetAlertScript.src="https://cdn.jsdelivr.net/npm/sweetalert2@11.14.0/dist/sweetalert2.all.min.js";sweetAlertScript.defer=true;document.head.appendChild(sweetAlertScript);const sweetAlertCSS=document.createElement("link");sweetAlertCSS.rel="stylesheet";sweetAlertCSS.href="https://cdn.jsdelivr.net/npm/sweetalert2@11.14.0/dist/sweetalert2.min.css";document.head.appendChild(sweetAlertCSS)}const mainPage=new MainPage})();

